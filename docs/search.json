[
  {
    "objectID": "about.html#memo",
    "href": "about.html#memo",
    "title": "About",
    "section": "Memo",
    "text": "Memo\nやってみたいことなどなど、メモ・雑記。\n\n統計学\n\n『データ解析のための数理統計入門』の問題を解く→ゆっくり進行中（タイピングが追いつかないので、気になったのだけ書くことに。）\n関連した『現代数理統計学の基礎』の問題も解きたい\n\n\n\nPython\n\nWebサイト上で、tikzのように図を可視化する方法を探索→tikzのやり方はわからなかった😭\n面白そうなデータセットを見つけて、Pythonで分析！→spotifyをやってみてる。\n\n\n\nその他\n\nこのサイトの見た目を揃える→進行中\nこのサイトのページ構成を決める→about seminar postの３つにまとめた。"
  },
  {
    "objectID": "seminar/seminar2024_0618/index.html",
    "href": "seminar/seminar2024_0618/index.html",
    "title": "6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布",
    "section": "",
    "text": "まれな現象が起こる回数を\\(X\\)とするとき、確率関数が以下の関数である分布をという。\\(Po(\\lambda)\\) で表す。 \\[p(k) = P(X=k) = \\frac{\\lambda^k}{k!}e^{-\\lambda}, k = 0,1,2,3, \\ldots\\]\n\\(\\lambda\\)は生起率（強度）と呼ばれるパラメーターであり、単位時間あたりに起こる回数である。 \\(e\\) は自然対数の底である。"
  },
  {
    "objectID": "seminar/seminar2024_0618/index.html#ポアソン分布とは",
    "href": "seminar/seminar2024_0618/index.html#ポアソン分布とは",
    "title": "6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布",
    "section": "",
    "text": "まれな現象が起こる回数を\\(X\\)とするとき、確率関数が以下の関数である分布をという。\\(Po(\\lambda)\\) で表す。 \\[p(k) = P(X=k) = \\frac{\\lambda^k}{k!}e^{-\\lambda}, k = 0,1,2,3, \\ldots\\]\n\\(\\lambda\\)は生起率（強度）と呼ばれるパラメーターであり、単位時間あたりに起こる回数である。 \\(e\\) は自然対数の底である。"
  },
  {
    "objectID": "seminar/seminar2024_0618/index.html#ポアソン分布のグラフ",
    "href": "seminar/seminar2024_0618/index.html#ポアソン分布のグラフ",
    "title": "6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布",
    "section": "ポアソン分布のグラフ",
    "text": "ポアソン分布のグラフ\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import poisson\nimport japanize_matplotlib\n\n# 複数のλ値を定義\nlambdas = [1, 1.3, 3, 5, 5.6, 7, 9]\n\n# x の範囲を定義\nx = np.arange(0, 20)\n\n# グラフのプロット\nplt.figure(figsize=(10, 6))\n\nfor lambda_ in lambdas:\n    pmf = poisson.pmf(x, lambda_)\n    plt.plot(x, pmf, marker='o', linestyle='-', label=f'λ = {lambda_}')\n\n# x軸の目盛りを整数に設定\nplt.xticks(np.arange(0, 21, 1))\n\nplt.xlabel('x')\nplt.ylabel('確率')\nplt.title('λを変動させたポアソン分布')\nplt.legend()\nplt.grid(True)\nplt.savefig('1.png')\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\\(\\lambda\\) が正の整数のとき\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import poisson\nimport japanize_matplotlib\n\n# 複数のλ値を定義\nlambdas = [1, 3, 5, 7, 9]\n\n# x の範囲を定義\nx = np.arange(0, 20)\n\n# グラフのプロット\nplt.figure(figsize=(10, 6))\n\nfor lambda_ in lambdas:\n    pmf = poisson.pmf(x, lambda_)\n    plt.plot(x, pmf, marker='o', linestyle='-', label=f'λ = {lambda_}')\n\n# x軸の目盛りを整数に設定\nplt.xticks(np.arange(0, 21, 1))\n\nplt.xlabel('x')\nplt.ylabel('確率')\nplt.title('λを変動させたポアソン分布')\nplt.legend()\nplt.grid(True)\nplt.savefig('1.png')\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\\(\\lambda\\) が正の実数かつ整数ではない時\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import poisson\nimport japanize_matplotlib\n\n# 複数のλ値を定義\nlambdas = [1.3, 3.6, 5.9, 7.32, 9.333]\n\n# x の範囲を定義\nx = np.arange(0, 20)\n\n# グラフのプロット\nplt.figure(figsize=(10, 6))\n\nfor lambda_ in lambdas:\n    pmf = poisson.pmf(x, lambda_)\n    plt.plot(x, pmf, marker='o', linestyle='-', label=f'λ = {lambda_}')\n\n# x軸の目盛りを整数に設定\nplt.xticks(np.arange(0, 21, 1))\n\nplt.xlabel('x')\nplt.ylabel('確率')\nplt.title('λを変動させたポアソン分布')\nplt.legend()\nplt.grid(True)\nplt.savefig('1.png')\nplt.show()\n\n\n\n\n\n\n\n\n\n\nグラフからわかること\n\n\\(\\lambda\\) が正の整数のもとで,\\(P(\\lambda)=P(\\lambda-1)\\)であることがわかる。\n\n\\[\\begin{align*}\n    P(\\lambda) &= \\frac{\\lambda^\\lambda}{\\lambda!} e^{-\\lambda} \\\\\n    P(\\lambda-1) &= \\frac{\\lambda^{\\lambda-1}}{(\\lambda-1)!} e^{-\\lambda}\n\\end{align*}\\] \\(P(\\lambda-1)\\) の分母分子に\\(\\lambda\\) をかけると、\\(P(\\lambda)\\) と同じ式になるため,\\(P(\\lambda)=P(\\lambda-1)\\)\n\n\\(\\lambda\\) が正の整数のもとで,\\(P(\\lambda)=P(\\lambda-1)\\)が最頻値であることがわかる。\n\\(\\lambda\\) が正の実数かつ整数ではないときのもとで,\\(P([\\lambda])\\)が最頻値であることがわかる。\n\n2と3は演習問題に続く."
  },
  {
    "objectID": "seminar/seminar2024_0618/index.html#ポアソン分布の具体例",
    "href": "seminar/seminar2024_0618/index.html#ポアソン分布の具体例",
    "title": "6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布",
    "section": "ポアソン分布の具体例",
    "text": "ポアソン分布の具体例\n\nある都市の１日に起こる交通事故の数\nある都市で１年間のうちに肺がんで死ぬ数\n\n確率が極端に少なそうな事柄がポアソン分布を用いることが多い。"
  },
  {
    "objectID": "seminar/seminar2024_0618/index.html#ポアソン分布が確率関数である証明",
    "href": "seminar/seminar2024_0618/index.html#ポアソン分布が確率関数である証明",
    "title": "6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布",
    "section": "ポアソン分布が確率関数である証明",
    "text": "ポアソン分布が確率関数である証明\nテーラー展開\n\\[\\begin{align*}\n    e^\\lambda &= 1 + x + x^2/ 2! + x^3/ 3! \\ldots \\\\\n    &= \\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{align*}\\]\n\\[\\begin{align*}\n    \\sum_{k=0}^\\infty p(k) &= \\sum_{k=0}^\\infty \\frac{\\lambda^k}{k!} e^{-\\lambda} = e^{\\lambda}e^{-\\lambda} = 1\n\\end{align*}\\] \\(\\sum_{k=0}^\\infty p(k)\\)が1であるため、\\(\\frac{\\lambda^k}{k!} e^{-\\lambda}\\) が確率関数であることがわかる."
  },
  {
    "objectID": "seminar/seminar2024_0618/index.html#命題2.6",
    "href": "seminar/seminar2024_0618/index.html#命題2.6",
    "title": "6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布",
    "section": "命題2.6",
    "text": "命題2.6\n命題2.6 ポアソン分布\\(Po(\\lambda)\\)に従う確率変数をXとすると、Xの平均と分散はともに\\(\\lambda\\)である。\n\\(E[X]\\)について\n\\(\\sum^\\infty_{k=0}\\frac{\\lambda^k}{k!} = e^\\lambda\\)について両辺を微分します。\n\\[\\begin{equation*}\n    \\frac{d}{d\\lambda}(e^\\lambda)  = e^\\lambda\n\\end{equation*}\\] \\[\\begin{align*}\n    \\frac{d}{d\\lambda}(\\sum^\\infty_{k=0}\\frac{\\lambda^k}{k!}) &= \\sum^\\infty_{k=0}\\frac{k\\lambda^{k-1}}{k!}\n    = \\sum^\\infty_{k=1}\\frac{k\\lambda^{k-1}}{k!}\n\\end{align*}\\] 両辺に\\(\\lambda e^{-\\lambda}\\)をかけます。 \\[\\begin{equation*}\n    e^\\lambda \\lambda e^{-\\lambda} = \\lambda\n\\end{equation*}\\] \\[\\begin{equation*}\n    \\sum^\\infty_{k=1}\\frac{k\\lambda^{k-1}}{k!} \\lambda e^{-\\lambda} = \\sum^\\infty_{k=1}\\frac{k\\lambda^{k}}{k!} e^{-\\lambda} = E[X]\n\\end{equation*}\\]\n\\(Var[X]\\)について\n同様に求められた式を微分します。 \\[\\begin{equation*}\n    \\sum_{k=1}^{\\infty} k(k-1)\\frac{\\lambda^{k-2}}{k!} = e^\\lambda\n  \\end{equation*}\\]\n両辺に\\(\\lambda^2 e^{-\\lambda}\\) をかけます \\[\\begin{equation*}\n    \\sum_{k=1}^{\\infty} k(k-1)\\frac{\\lambda^{k}}{k!} e^{-\\lambda} = \\lambda^2\n  \\end{equation*}\\]\n\\[\\begin{equation*}\n    Var(X) = E[X(X-1)] + E[X]-(E[X])^2 = \\lambda^2 +\\lambda -\\lambda^2 = \\lambda\n  \\end{equation*}\\]"
  },
  {
    "objectID": "seminar/seminar2024_0618/index.html#命題2.7-二項分布のポアソン近似",
    "href": "seminar/seminar2024_0618/index.html#命題2.7-二項分布のポアソン近似",
    "title": "6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布",
    "section": "命題2.7 二項分布のポアソン近似",
    "text": "命題2.7 二項分布のポアソン近似\n\\(np=\\lambda\\) が一定のもとで、\\(p \\rightarrow 0\\),\\(n \\rightarrow \\infty\\)とすると、二項分布\\(Bin(n,p)\\) はポアソン分布\\(Po(\\lambda)\\) に収束する。\n\n命題2.7の証明\n\\[\\begin{align*}\n    \\lim_{n \\rightarrow \\infty} {}_n \\mathrm{C}_k p^k (1-p)^{n-k} &= \\lim_{n \\rightarrow \\infty} \\frac{n!}{(n-k)!k!} \\left(\\frac{\\lambda}{n}\\right)^k \\left(1-\\frac{\\lambda}{n}\\right)^{n-k} \\\\\n    &= \\lim_{n \\rightarrow \\infty} \\frac{\\lambda^k}{k!} \\frac{n!}{(n-k)!n^k} \\left(1-\\frac{\\lambda}{n}\\right)^n \\left(1-\\frac{\\lambda}{n}\\right)^{-k} \\\\\n    &= (\\frac{k!}{\\lambda^k}) e^{-\\lambda}\n\\end{align*}\\]\n\\(n\\rightarrow \\infty\\)のとき、\\(\\frac{n!}{(n-k)!n^k}\\rightarrow 1, (1-\\frac{\\lambda}{n})^n \\rightarrow e^{-\\lambda},(1-\\frac{\\lambda}{n})^{-k} \\rightarrow 1\\)より。"
  },
  {
    "objectID": "seminar/seminar2024_0709/index.html",
    "href": "seminar/seminar2024_0709/index.html",
    "title": "7月9日「データ解析のための数理統計入門」第3章 演習問題　７問目",
    "section": "",
    "text": "確率変数\\(X,Y,Z\\)の同時確率密度関数が\n\\[\nf(x,y,z)=\\frac{\\Gamma(a+b+c)}{\\Gamma(a)\\Gamma(b)\\Gamma(c)}x^{a-1}y^{b-1}z^{c-1}\n\\tag{1}\\]\nで与えられる分布をディリクレ分布といい、\\(Dir(a,b,c)\\)で表す。\nただし、\\(0 &lt; x,y,z &lt; 1\\)、 \\(x+y+z=1\\)であり、\\(a,b,c\\)は正の実数です。\n\n\n\n\n\\(V=X+Y\\)の分布を求めよ。\n\\(T=Y,W=X/(1-Y)\\)とおくとき、それぞれの周辺分布を与えよ。\\(T\\)と\\(W\\)は独立か？\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n手順\n\n\n\n\n\n\n\n式 1 より\\(x,y\\)の同時確率密度関数を求める。\n\\(V=X+Y,W=Y\\)とした時に、\\(V,W\\)の同時確率密度関数に変数変換する。\n同時確率密度関数から\\(V\\)の周辺確率密度関数がもとまり、これはX+Yの確率密度関数となるので分布がもとまる。\n\n\n\n\n\n\n\n\n\n\n\n簡略化のため、\\(C=\\frac{\\Gamma(a+b+c)}{\\Gamma(a)\\Gamma(b)\\Gamma(c)}\\)とする。\n\\(z=1-x-y\\) を 式 1 に代入する。\n\\[\nf(x,y)=C x^{a-1}y^{b-1}(1-x-y)^{c-1}\n\\tag{2}\\]\nこの代入した式は\\(x,y\\)の同時確率密度関数となる。\n\n\n\n\n\n\n\\(V=X+Y,W=Y\\)とする。（おそらくあとで\\(V\\)の周辺確率密度関数を求める時に\\(W=Y\\)やと微分しやすいから？）\n\\(x=v-w,y=w\\)となる。\nよってヤコビアンを求めると、\n\\[\nJ((v, w) \\rightarrow (x, y)) =\n\\begin{vmatrix}\n\\frac{\\partial x}{\\partial v} & \\frac{\\partial x}{\\partial w} \\\\\n\\frac{\\partial y}{\\partial v} & \\frac{\\partial y}{\\partial w}\n\\end{vmatrix}=\n\\begin{vmatrix}\n1 & -1 \\\\\n0 & 1\n\\end{vmatrix}=1\n\\]\nとなる。\n\n\n\n式 2 に\\(x=v-w,y=w\\) を代入しヤコビアンが1より、\\(V,W\\)の同時確率密度関数に変数変換する。\n\\[\nf_{V,W}(v,w)=C (v-w)^{a-1}w^{b-1}(1-v)^{c-1}, \\quad 0 &lt; w &lt; v\n\\tag{3}\\]\n\n\n\n\n\n\n式 3 の\\(V,W\\)の同時確率密度関数から、\\(V\\)の周辺確率密度関数がもとまる。\n\\[\\begin{align}\nf_V(v)&=\\int_0^v f_{V,W}(v,w)dw\\\\\n&= C (1-v)^{c-1} \\int_0^v (v-w)^{a-1}w^{b-1} dw\n\\end{align}\\]\nこの周辺確率密度関数から確率分布を求めていく。\n\n\n\nそこで、\\(vs=w,\\quad dw=vds\\) で変換します。\\(w\\)を消していく感じですかね。\n(おそらく、\\(\\int_0^v (v-w)^{a-1}w^{b-1} dw\\)がベータ関数に近くて変換できそうなので、\\(vs=w\\)にすることで積分範囲を\\([0,v]\\) から\\([0,1]\\) に変換している？)\n\\[\\begin{align}\nf_V(v)\n&= C (1-v)^{c-1} \\int_0^1 (v-vs)^{a-1}(vs)^{b-1} vds\\\\\n&= C (1-v)^{c-1} v^{a+b-1}\\int_0^1 (1-s)^{a-1}s^{b-1} ds\\\\\n&= CB(a,b)(1-v)^{c-1} v^{a+b-1}\\\\\n&= \\frac{\\Gamma(a+b+c)}{\\Gamma(a)\\Gamma(b)\\Gamma(c)} \\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}(1-v)^{c-1} v^{a+b-1} \\\\\n&= \\frac{\\Gamma(a+b+c)}{\\Gamma(c)\\Gamma(a+b)}(1-v)^{c-1} v^{a+b-1} \\\\\n&= \\frac{1}{B(a+b,c)}(1-v)^{c-1} v^{a+b-1} \\\\\n\n\n\\end{align}\\]\nこれはベータ分布の確率密度関数の式になるので、\\(X+Y \\sim Beta(a+b,c)\\)\n\n\n\n\n\\(T=Y,W=X/(1-Y)\\)とおくと、\\(Y=T,X=(1-T)W\\)となる。ヤコビアンは\n\\[\nJ((w, t) \\rightarrow (x, y))\n\\begin{vmatrix}\n\\frac{\\partial x}{\\partial w} & \\frac{\\partial x}{\\partial t} \\\\\n\\frac{\\partial y}{\\partial w} & \\frac{\\partial y}{\\partial t}\n\\end{vmatrix}=\n\\begin{vmatrix}\n1-t & -w \\\\\n0 & 1\n\\end{vmatrix}=1-t\n\\]\nとなる。\n式 2 より\n\\[\\begin{align}\nf_{T,W}(t,w)&=C((1-t)w)^{a-1} t^{b-1} (1-w(1-t)-t)^{c-1} (1-t) \\\\\n&= C w^{a-1} (1-t)^a t^{b-1} (1-w(1-t)-t)^{c-1} \\\\\n&= C w^{a-1} (1-t)^a t^{b-1} ((1-t)(1-w))^{c-1} \\\\\n&= C w^{a-1} (1-t)^{a+c-1} t^{b-1} (1-w)^{c-1} \\\\\n&= C w^{a-1} (1-w)^{c-1} t^{b-1}  (1-t)^{a+c-1} \\\\\n&= \\frac{\\Gamma(a+b+c)}{\\Gamma(a)\\Gamma(b)\\Gamma(c)} w^{a-1} (1-w)^{c-1} t^{b-1}  (1-t)^{a+c-1} \\\\\n&= \\frac{\\Gamma(a+c)}{\\Gamma(a)\\Gamma(c)} w^{a-1} (1-w)^{c-1}\\frac{\\Gamma(a+b+c)}{\\Gamma(b)\\Gamma(a+c)} t^{b-1}  (1-t)^{a+c-1}\n\\end{align}\\]\nそれぞれの周辺確率密度関数を求めます。\\(0&lt;t &lt;1, 0&lt;w&lt;1\\) であることに注意する。\n\\[\\begin{align}\nf_{T}(t)&= \\int_{-\\infty}^{\\infty} f_{T,W}(t,w)dw\\\\\n&=\\int_{0}^{1} \\frac{\\Gamma(a+c)}{\\Gamma(a)\\Gamma(c)} w^{a-1} (1-w)^{c-1}\\frac{\\Gamma(a+b+c)}{\\Gamma(b)\\Gamma(a+c)} t^{b-1}  (1-t)^{a+c-1} dw\\\\\n&=\\frac{\\Gamma(a+b+c)}{\\Gamma(b)\\Gamma(a+c)} t^{b-1}  (1-t)^{a+c-1} \\int_{0}^{1} \\frac{\\Gamma(a+c)}{\\Gamma(a)\\Gamma(c)} w^{a-1} (1-w)^{c-1} dw\\\\\n&= \\frac{\\Gamma(a+b+c)}{\\Gamma(b)\\Gamma(a+c)} t^{b-1}  (1-t)^{a+c-1}\n\\end{align}\\]\n同様に\n\\[\nf_{W}(w) = \\frac{\\Gamma(a+c)}{\\Gamma(a)\\Gamma(c)} w^{a-1} (1-w)^{c-1}\n\\]\nよって、\\(f_{T,W}(t,w)=f_{T}(t)f_{W}(w)\\)により\\(T,W\\)は独立で、\\(T \\sim Beta(a+c,b), W \\sim Beta(a,c)\\)に従う。"
  },
  {
    "objectID": "seminar/seminar2024_0709/index.html#問題",
    "href": "seminar/seminar2024_0709/index.html#問題",
    "title": "7月9日「データ解析のための数理統計入門」第3章 演習問題　７問目",
    "section": "",
    "text": "確率変数\\(X,Y,Z\\)の同時確率密度関数が\n\\[\nf(x,y,z)=\\frac{\\Gamma(a+b+c)}{\\Gamma(a)\\Gamma(b)\\Gamma(c)}x^{a-1}y^{b-1}z^{c-1}\n\\tag{1}\\]\nで与えられる分布をディリクレ分布といい、\\(Dir(a,b,c)\\)で表す。\nただし、\\(0 &lt; x,y,z &lt; 1\\)、 \\(x+y+z=1\\)であり、\\(a,b,c\\)は正の実数です。\n\n\n\n\n\\(V=X+Y\\)の分布を求めよ。\n\\(T=Y,W=X/(1-Y)\\)とおくとき、それぞれの周辺分布を与えよ。\\(T\\)と\\(W\\)は独立か？"
  },
  {
    "objectID": "seminar/seminar2024_0709/index.html#解答",
    "href": "seminar/seminar2024_0709/index.html#解答",
    "title": "7月9日「データ解析のための数理統計入門」第3章 演習問題　７問目",
    "section": "",
    "text": "手順\n\n\n\n\n\n\n\n式 1 より\\(x,y\\)の同時確率密度関数を求める。\n\\(V=X+Y,W=Y\\)とした時に、\\(V,W\\)の同時確率密度関数に変数変換する。\n同時確率密度関数から\\(V\\)の周辺確率密度関数がもとまり、これはX+Yの確率密度関数となるので分布がもとまる。\n\n\n\n\n\n\n\n\n\n\n\n簡略化のため、\\(C=\\frac{\\Gamma(a+b+c)}{\\Gamma(a)\\Gamma(b)\\Gamma(c)}\\)とする。\n\\(z=1-x-y\\) を 式 1 に代入する。\n\\[\nf(x,y)=C x^{a-1}y^{b-1}(1-x-y)^{c-1}\n\\tag{2}\\]\nこの代入した式は\\(x,y\\)の同時確率密度関数となる。\n\n\n\n\n\n\n\\(V=X+Y,W=Y\\)とする。（おそらくあとで\\(V\\)の周辺確率密度関数を求める時に\\(W=Y\\)やと微分しやすいから？）\n\\(x=v-w,y=w\\)となる。\nよってヤコビアンを求めると、\n\\[\nJ((v, w) \\rightarrow (x, y)) =\n\\begin{vmatrix}\n\\frac{\\partial x}{\\partial v} & \\frac{\\partial x}{\\partial w} \\\\\n\\frac{\\partial y}{\\partial v} & \\frac{\\partial y}{\\partial w}\n\\end{vmatrix}=\n\\begin{vmatrix}\n1 & -1 \\\\\n0 & 1\n\\end{vmatrix}=1\n\\]\nとなる。\n\n\n\n式 2 に\\(x=v-w,y=w\\) を代入しヤコビアンが1より、\\(V,W\\)の同時確率密度関数に変数変換する。\n\\[\nf_{V,W}(v,w)=C (v-w)^{a-1}w^{b-1}(1-v)^{c-1}, \\quad 0 &lt; w &lt; v\n\\tag{3}\\]\n\n\n\n\n\n\n式 3 の\\(V,W\\)の同時確率密度関数から、\\(V\\)の周辺確率密度関数がもとまる。\n\\[\\begin{align}\nf_V(v)&=\\int_0^v f_{V,W}(v,w)dw\\\\\n&= C (1-v)^{c-1} \\int_0^v (v-w)^{a-1}w^{b-1} dw\n\\end{align}\\]\nこの周辺確率密度関数から確率分布を求めていく。\n\n\n\nそこで、\\(vs=w,\\quad dw=vds\\) で変換します。\\(w\\)を消していく感じですかね。\n(おそらく、\\(\\int_0^v (v-w)^{a-1}w^{b-1} dw\\)がベータ関数に近くて変換できそうなので、\\(vs=w\\)にすることで積分範囲を\\([0,v]\\) から\\([0,1]\\) に変換している？)\n\\[\\begin{align}\nf_V(v)\n&= C (1-v)^{c-1} \\int_0^1 (v-vs)^{a-1}(vs)^{b-1} vds\\\\\n&= C (1-v)^{c-1} v^{a+b-1}\\int_0^1 (1-s)^{a-1}s^{b-1} ds\\\\\n&= CB(a,b)(1-v)^{c-1} v^{a+b-1}\\\\\n&= \\frac{\\Gamma(a+b+c)}{\\Gamma(a)\\Gamma(b)\\Gamma(c)} \\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}(1-v)^{c-1} v^{a+b-1} \\\\\n&= \\frac{\\Gamma(a+b+c)}{\\Gamma(c)\\Gamma(a+b)}(1-v)^{c-1} v^{a+b-1} \\\\\n&= \\frac{1}{B(a+b,c)}(1-v)^{c-1} v^{a+b-1} \\\\\n\n\n\\end{align}\\]\nこれはベータ分布の確率密度関数の式になるので、\\(X+Y \\sim Beta(a+b,c)\\)\n\n\n\n\n\\(T=Y,W=X/(1-Y)\\)とおくと、\\(Y=T,X=(1-T)W\\)となる。ヤコビアンは\n\\[\nJ((w, t) \\rightarrow (x, y))\n\\begin{vmatrix}\n\\frac{\\partial x}{\\partial w} & \\frac{\\partial x}{\\partial t} \\\\\n\\frac{\\partial y}{\\partial w} & \\frac{\\partial y}{\\partial t}\n\\end{vmatrix}=\n\\begin{vmatrix}\n1-t & -w \\\\\n0 & 1\n\\end{vmatrix}=1-t\n\\]\nとなる。\n式 2 より\n\\[\\begin{align}\nf_{T,W}(t,w)&=C((1-t)w)^{a-1} t^{b-1} (1-w(1-t)-t)^{c-1} (1-t) \\\\\n&= C w^{a-1} (1-t)^a t^{b-1} (1-w(1-t)-t)^{c-1} \\\\\n&= C w^{a-1} (1-t)^a t^{b-1} ((1-t)(1-w))^{c-1} \\\\\n&= C w^{a-1} (1-t)^{a+c-1} t^{b-1} (1-w)^{c-1} \\\\\n&= C w^{a-1} (1-w)^{c-1} t^{b-1}  (1-t)^{a+c-1} \\\\\n&= \\frac{\\Gamma(a+b+c)}{\\Gamma(a)\\Gamma(b)\\Gamma(c)} w^{a-1} (1-w)^{c-1} t^{b-1}  (1-t)^{a+c-1} \\\\\n&= \\frac{\\Gamma(a+c)}{\\Gamma(a)\\Gamma(c)} w^{a-1} (1-w)^{c-1}\\frac{\\Gamma(a+b+c)}{\\Gamma(b)\\Gamma(a+c)} t^{b-1}  (1-t)^{a+c-1}\n\\end{align}\\]\nそれぞれの周辺確率密度関数を求めます。\\(0&lt;t &lt;1, 0&lt;w&lt;1\\) であることに注意する。\n\\[\\begin{align}\nf_{T}(t)&= \\int_{-\\infty}^{\\infty} f_{T,W}(t,w)dw\\\\\n&=\\int_{0}^{1} \\frac{\\Gamma(a+c)}{\\Gamma(a)\\Gamma(c)} w^{a-1} (1-w)^{c-1}\\frac{\\Gamma(a+b+c)}{\\Gamma(b)\\Gamma(a+c)} t^{b-1}  (1-t)^{a+c-1} dw\\\\\n&=\\frac{\\Gamma(a+b+c)}{\\Gamma(b)\\Gamma(a+c)} t^{b-1}  (1-t)^{a+c-1} \\int_{0}^{1} \\frac{\\Gamma(a+c)}{\\Gamma(a)\\Gamma(c)} w^{a-1} (1-w)^{c-1} dw\\\\\n&= \\frac{\\Gamma(a+b+c)}{\\Gamma(b)\\Gamma(a+c)} t^{b-1}  (1-t)^{a+c-1}\n\\end{align}\\]\n同様に\n\\[\nf_{W}(w) = \\frac{\\Gamma(a+c)}{\\Gamma(a)\\Gamma(c)} w^{a-1} (1-w)^{c-1}\n\\]\nよって、\\(f_{T,W}(t,w)=f_{T}(t)f_{W}(w)\\)により\\(T,W\\)は独立で、\\(T \\sim Beta(a+c,b), W \\sim Beta(a,c)\\)に従う。"
  },
  {
    "objectID": "seminar/seminar2024_0723/index.html",
    "href": "seminar/seminar2024_0723/index.html",
    "title": "7月23日「データ解析のための数理統計入門」第4章 命題4.21",
    "section": "",
    "text": "命題 1 (命題4.21) 確率変数\\(X_1,\\ldots,X_m\\)が独立で、各\\(X_i\\)がポアソン分布\\(Po(\\lambda_i)\\)に従うとする。\\(X_1+\\cdots+X_m=n\\)という条件のもとで、\\(X_1,\\ldots,X_m\\) の条件付き分布は多項分布\\(Mult_m(n,p_1,\\ldots,p_m)\\) に従う。ただし、\\(p_i=\\lambda_i/(\\lambda_1+\\cdots+\\lambda_m)\\)である。\n\n\n\n証明. \\[\nY=X_1+\\cdots+X_m,\\quad \\theta = \\lambda_1+\\cdots+\\lambda_m\n\\]\nとおくと、ポアソン分布の再生性により\\(Y \\sim Po(\\theta)\\) となる。\n\n\n\n確率変数\\(X_1,\\ldots,X_m\\)が独立であるため、同時確率は積で表される。\n\\[\nP(X_1=x_1, \\ldots ,X_m=x_m)=\\prod_{i=1}^{m} \\frac{\\lambda_i^{x_i} e^{-\\lambda_i}}{x_i!}\n\\]\n\\[\nP(Y=n)=\\frac{\\theta^n}{n!} e^{-\\theta}\n\\]\n\n\n\n条件付き確率は以下のようになる。 \\[\nP(X_1 = x_1, \\ldots, X_m = x_m \\mid Y = n) =P(X_1 = x_1, \\ldots, X_m = x_m , Y = n)/ P(Y =n)\n\\]\n\\(P(X_1 = x_1, \\ldots, X_m = x_m , Y = n)\\) の同時確率は、\\(P(X_1=x_1, \\ldots ,X_m=x_m)\\)が\\(x_1 + \\cdots + x_m =n\\) となるときである。\n\\[\\begin{align}\nP(X_1 = x_1, \\ldots, X_m = x_m \\mid Y = n)&= \\frac{\\prod_{i=1}^{m} \\frac{\\lambda_i^{x_i} e^{-\\lambda_i}}{x_i!}}{\\frac{\\theta^n e^{-\\theta}}{n!}}  \\\\\n&= \\frac{n!}{x_1!x_2! \\cdots x_m!} \\frac{e^{-\\lambda_1}e^{-\\lambda_2} \\cdots e^{-\\lambda_m}}{e^{-\\theta}} \\frac{\\prod_{i=1}^{m}\\lambda_i^{x_i}}{\\theta^n} \\\\\n&= \\frac{n!}{x_1!x_2! \\cdots x_m!} \\frac{e^{-(\\lambda_1 + \\cdots + \\lambda_m)}}{e^{-(\\lambda_1 + \\cdots + \\lambda_m)}} \\frac{\\prod_{i=1}^{m}(p_i \\theta)^{x_i}}{\\theta^n} \\\\\n&= \\frac{n!}{x_1!x_2! \\cdots x_m!}  \\frac{\\theta^{x_1}\\theta^{x_2} \\cdots \\theta^{x_m}}{\\theta^n}p^{x_1}p^{x_2} \\cdots p^{x_m}\\\\\n&= \\frac{n!}{x_1!x_2! \\cdots x_m!}  p^{x_1}p^{x_2} \\cdots p^{x_m}\n\\end{align}\\]\nよって条件付き分布は多項分布\\(Mult_m(n,p_1,\\ldots,p_m)\\)に従う。"
  },
  {
    "objectID": "seminar/seminar2024_1008/index.html",
    "href": "seminar/seminar2024_1008/index.html",
    "title": "10月8日「データ解析のための数理統計入門」第5章",
    "section": "",
    "text": "【例5.9】(ガンマ・ポアソン分布)\n\n確率変数(\\(X,Y\\))の階層モデルとして\n\\[\nX|Y \\sim Po(Y), Y \\sim Ga(\\alpha,\\beta)\n\\]\nを考える。\n\\(Y=y\\) を与えた時の\\(X\\) の条件付き確率関数を \\(f_{X|Y}(x|y)\\)とし、\\(Y\\) の確率密度関数を\\(f_Y(y)\\) とすると\n\\[\nf_{X|Y}(x|y) = \\frac{y^x}{x!} e^{-y}\n\\]\n\\[\nf_Y(y) = \\frac{y^{\\alpha-1}}{\\Gamma(\\alpha) \\beta^{\\alpha}} e^{-y/\\beta}\n\\]\n(\\(X,Y\\))の同時確率関数は\n\\[\nf(x,y)=f_{X|Y}(x|y) f_Y(y)= \\frac{y^x}{x!} e^{-y} \\frac{y^{\\alpha-1}}{\\Gamma(\\alpha) \\beta^{\\alpha}} e^{-y/\\beta}\n= \\frac{1}{\\Gamma(\\alpha) x!  \\beta^{\\alpha}} y^{x+\\alpha-1} e^{-(1+1/\\beta)y}\n\\]\nと書ける。\n\\(X\\) の周辺確率分布をガンマ・ポアソン分布と呼び\n\\[\nf_X(x) = \\int_{0}^{\\infty} f(x,y) dy =  \\frac{\\Gamma(x+\\alpha)}{\\Gamma(\\alpha) x!} \\frac{\\beta^x}{(1+\\beta)^{x+\\alpha}}\n\\]\nで与えられる。\n\n\nガンマ・ポアソン分布の細かい計算\n\n\\[\\begin{align}\n  f_X(x) &= \\int_{0}^{\\infty} f(x,y) dy \\\\\n  &= \\int_{0}^{\\infty}  \\frac{1}{\\Gamma(\\alpha) x!  \\beta^{\\alpha}} y^{x+\\alpha-1} e^{-(1+1/\\beta)y} dy \\\\\n  &= \\int_{0}^{\\infty}  \\frac{1}{\\Gamma(\\alpha) x!  \\beta^{\\alpha} (1+\\frac{1}{\\beta})^{x+\\alpha-1}} \\{(1+\\frac{1}{\\beta})y\\}^{x+\\alpha-1} e^{-(1+1/\\beta)y} dy \\\\\n  &=\\frac{1}{\\Gamma(\\alpha) x!  \\beta^{\\alpha} (1+\\frac{1}{\\beta})^{x+\\alpha-1}} \\int_{0}^{\\infty}  u^{x+\\alpha-1} e^{u} \\frac{du}{(1+\\frac{1}{\\beta})} \\\\\n  &=\\frac{\\Gamma(x+\\alpha)}{\\Gamma(\\alpha) x!  \\beta^{\\alpha} (1+\\frac{1}{\\beta})^{x+\\alpha}} \\\\\n  &=\\frac{\\Gamma(x+\\alpha) \\beta^{x+\\alpha}}{\\Gamma(\\alpha) x!  \\beta^{\\alpha} (1+\\beta)^{x+\\alpha}} \\\\\n  &=\\frac{\\Gamma(x+\\alpha) \\beta^{x}}{\\Gamma(\\alpha) x!(1+\\beta)^{x+\\alpha}} \\\\\n\\end{align}\\]\n\n\n\n\n\\(\\alpha\\) が自然数の時、ガンマ・ポアソン分布は負の二項分布 \\(NBin(\\alpha, 1/1+\\beta)\\) に従う。\n\n\n負の二項分布とガンマ・ポアソン分布\n\n\\(X \\sim NBin(r,p)\\) として、\\(X=k\\) となる確率は\n\\(p(k)=\\begin{pmatrix}\n   r+k-1 \\\\\n   k\n   \\end{pmatrix} p^r q^k\\)\n\\(\\alpha\\) が自然数の時、\\(X\\) の周辺確率関数は\n\\[f_X(x)= \\frac{\\Gamma(x+\\alpha)}{\\Gamma(\\alpha) x!} \\frac{\\beta^x}{(1+\\beta)^{x+\\alpha}}\n  = \\frac{(x+\\alpha-1)!}{(\\alpha-1)! x!} \\frac{\\beta^x}{(1+\\beta)^{x+\\alpha}}\n    =\\begin{pmatrix}\n   \\alpha+x-1 \\\\\n   x\n   \\end{pmatrix} \\{\\frac{1}{(1+\\beta)}\\}^\\alpha \\{\\frac{\\beta}{(1+\\beta)}\\}^x\n  \\]\n\n\n\n\nポアソン分布は平均と分散が等しいが（\\(Z \\sim Po(\\lambda)\\) の \\(E[Z]=\\lambda\\),\\(V[Z]=\\lambda\\)）、現実には死亡数などのデータを分析してみると平均より分散の方が大きくなることがあり、ポアソン分布を当てはめることができない。これを過分散の問題と呼び、ガンマ・ポアソン分布はこの問題を解決するモデルとして紹介されている。\n\n\n\n\nガンマ・ポアソン分布の平均と分散\n\n\\(E[X],Var[X]\\) を求める。\n\n\n\n積率母関数から求める方法もあるが（演習問題5）、条件付き確率における条件付き期待値・条件付き分散の性質を用いると簡単に求めることができる。\n\n\n\n\\(X|Y \\sim Po(Y)\\) より、\\(E[X|Y]=Var(X|Y)=Y\\)\n\\(Y \\sim Ga(\\alpha, \\beta)\\) より、\\(E[Y] = \\alpha \\beta\\), \\(Var(Y)= \\alpha \\beta^2\\)\n\n\n\n命題4.10を用いると、\n\\(E[X]=E[E[X|Y]]=E[Y]=\\alpha \\beta\\)\n\\(Var(X)= E[Y]+Var[Y]=\\alpha \\beta (1+\\beta)\\)\nとなり、\\(\\alpha, \\beta\\) は正のパラメーターのため、分散が平均より大きくなることがわかる。\nこれによって、ポアソン分布では当てはまりが悪いものでも、ガンマ・ポアソン分布を使えばうまくいく場合があるのだと思う。\n\n\n\n\n【例5.10】(ベータ・2項分布)\n\n確率変数(\\(X,Y\\))の階層モデルとして\n\\[\nX|Y \\sim Bin(n,Y), Y \\sim Beta(\\alpha,\\beta)\n\\]\nを考えると、(\\(X,Y\\))の同時確率関数は\n\\[\nf(x,y) =    \n\\begin{pmatrix}\n   n \\\\\n   x\n\\end{pmatrix} \\frac{1}{B(\\alpha,\\beta)} y^{x+\\alpha-1} (1-y)^{n-x+\\beta-1}\n\\]\nと書ける。\n\\(X\\) の周辺確率関数は次のように書ける。\n\\[\nf_X(x)=\n\\begin{pmatrix}\n   n \\\\\n   x\n\\end{pmatrix} \\frac{B(x+\\alpha,n-x+\\beta)}{B(\\alpha,\\beta)},x=0, \\ldots,n\n\\]\n\n\n計算\n\n\\[\n  f_X(x)= \\int^{1}_{0}\n  \\begin{pmatrix}\n   n \\\\\n   x\n\\end{pmatrix} \\frac{1}{B(\\alpha,\\beta)} y^{x+\\alpha-1} (1-y)^{n-x+\\beta-1} dy=\n\\begin{pmatrix}\n   n \\\\\n   x\n\\end{pmatrix} \\frac{B(x+\\alpha,n-x+\\beta)}{B(\\alpha,\\beta)}\n  \\]\n\nこれをベータ・二項分布と呼ぶ。平均・分散を直接計算することは困難である。\n\n\n\n\\(E[X|Y]=nY,Var(X|Y)=nY(1-Y)\\)\n\\(X\\) の平均と分散は、命題4.10を用いて\\(E[X]=E[nY]=n\\alpha/(\\alpha+\\beta)\\), \\(Var(X)=E[nY(1-Y)]+Var(nY)=n(n-1)Var(Y)+nE[Y](1-E[Y])\\) より\n\\[\nVar(X)= n(n-1) \\frac{\\alpha \\beta}{(\\alpha+\\beta)^2 (\\alpha+\\beta+1)} + n\\frac{\\alpha \\beta}{(\\alpha+\\beta)^2}\n\\]\nと書ける。\n\n\n分散の計算\n\n\\[\\begin{align}\n  Var(X)&=E[Var(X|Y)]+Var(E[X|Y]) \\\\\n  &=E[nY(1-Y)] + Var(nY) \\\\\n  &=nE[Y]-nE[Y^2]+ n^2Var(Y)\\\\\n  &=nE[Y]-n(Var(Y)+(E[Y])^2)+ n^2Var(Y)\\\\\n  &=nE[Y](1-E[Y])+nVar(Y)(n-1)\\\\\n  &=n\\frac{\\alpha}{\\alpha+\\beta}(1-\\frac{\\alpha}{\\alpha+\\beta})+n(n-1)\\frac{\\alpha\\beta}{(\\alpha+\\beta)^2 (\\alpha+\\beta+1)}\\\\\n    &=n\\frac{\\alpha \\beta}{(\\alpha+\\beta)^2}+n(n-1)\\frac{\\alpha\\beta}{(\\alpha+\\beta)^2 (\\alpha+\\beta+1)}\\\\\n  \\end{align}\\]"
  },
  {
    "objectID": "seminar/seminar2024_1029/index.html",
    "href": "seminar/seminar2024_1029/index.html",
    "title": "10月29日　不偏分散がカイ二乗分布に従う話",
    "section": "",
    "text": "\\(G\\) の具体例の一つとして、Helmert行列と呼ばれるものがある。\n\\[\nG=\n\\begin{bmatrix}\n  \\frac{1}{\\sqrt{n}} & \\frac{1}{\\sqrt{n}} &\\frac{1}{\\sqrt{n}} &\\dots &\\frac{1}{\\sqrt{n}}\\\\\n   \\frac{1}{\\sqrt{1 \\cdot 2}} & \\frac{-1}{\\sqrt{1 \\cdot 2}}& 0 & \\dots & 0\\\\\n\\frac{1}{\\sqrt{2 \\cdot 3}} & \\frac{1}{\\sqrt{2 \\cdot 3}}& \\frac{-2}{\\sqrt{2 \\cdot 3}}& \\dots & 0\\\\\n\\dots &\\dots&\\dots& \\ddots &\\dots\\\\\n\\frac{1}{\\sqrt{(n-1) \\cdot n}}& \\frac{1}{\\sqrt{(n-1) \\cdot n}}&\n\\frac{1}{\\sqrt{(n-1) \\cdot n}}& \\dots & \\frac{1-n}{\\sqrt{(n-1) \\cdot n}}& \\\\\n\\end{bmatrix}\n\\]\nこれを使って不偏分散(標本分散)がどのような分布に従うかを考える。\n標本分散は\\(s^2 = \\frac{1}{n}\\sum_{i=1}^n (X_i-\\bar{X})^2\\) 、不偏分散は\\(V^2 =\\frac{1}{n-1}\\sum_{i=1}^n (X_i-\\bar{X})^2\\)である。\n不偏分散の式変形について考えると、\n\\[\n\\sum_{i=1}^n (X_i-\\bar{X})^2 = \\sum_{i=1}^n X_i^2-n\\bar{X}^2=\\sum_{i=1}^n Y_i^2-Y_1^2=\\sum_{i=2}^n Y_i^2\n\\]\n\\(Y\\)が標準多変量正規分布に従い、\\(Y_i\\) はそれぞれ独立に標準正規分布に従う。標準正規分布の二乗和はカイ二乗分布に従うことを知っているので、\\(\\sum_{i=1}^n (X_i-\\bar{X})^2\\)　は自由度\\(n-1\\)のカイ二乗分布に従う。このことから、\\(ns^2,(n-1)V^2\\)は自由度\\(n-1\\) のカイ二乗分布に従う。"
  },
  {
    "objectID": "seminar/seminar2024_1029/index.html#概要",
    "href": "seminar/seminar2024_1029/index.html#概要",
    "title": "10月29日　不偏分散がカイ二乗分布に従う話",
    "section": "",
    "text": "\\(G\\) の具体例の一つとして、Helmert行列と呼ばれるものがある。\n\\[\nG=\n\\begin{bmatrix}\n  \\frac{1}{\\sqrt{n}} & \\frac{1}{\\sqrt{n}} &\\frac{1}{\\sqrt{n}} &\\dots &\\frac{1}{\\sqrt{n}}\\\\\n   \\frac{1}{\\sqrt{1 \\cdot 2}} & \\frac{-1}{\\sqrt{1 \\cdot 2}}& 0 & \\dots & 0\\\\\n\\frac{1}{\\sqrt{2 \\cdot 3}} & \\frac{1}{\\sqrt{2 \\cdot 3}}& \\frac{-2}{\\sqrt{2 \\cdot 3}}& \\dots & 0\\\\\n\\dots &\\dots&\\dots& \\ddots &\\dots\\\\\n\\frac{1}{\\sqrt{(n-1) \\cdot n}}& \\frac{1}{\\sqrt{(n-1) \\cdot n}}&\n\\frac{1}{\\sqrt{(n-1) \\cdot n}}& \\dots & \\frac{1-n}{\\sqrt{(n-1) \\cdot n}}& \\\\\n\\end{bmatrix}\n\\]\nこれを使って不偏分散(標本分散)がどのような分布に従うかを考える。\n標本分散は\\(s^2 = \\frac{1}{n}\\sum_{i=1}^n (X_i-\\bar{X})^2\\) 、不偏分散は\\(V^2 =\\frac{1}{n-1}\\sum_{i=1}^n (X_i-\\bar{X})^2\\)である。\n不偏分散の式変形について考えると、\n\\[\n\\sum_{i=1}^n (X_i-\\bar{X})^2 = \\sum_{i=1}^n X_i^2-n\\bar{X}^2=\\sum_{i=1}^n Y_i^2-Y_1^2=\\sum_{i=2}^n Y_i^2\n\\]\n\\(Y\\)が標準多変量正規分布に従い、\\(Y_i\\) はそれぞれ独立に標準正規分布に従う。標準正規分布の二乗和はカイ二乗分布に従うことを知っているので、\\(\\sum_{i=1}^n (X_i-\\bar{X})^2\\)　は自由度\\(n-1\\)のカイ二乗分布に従う。このことから、\\(ns^2,(n-1)V^2\\)は自由度\\(n-1\\) のカイ二乗分布に従う。"
  },
  {
    "objectID": "seminar/seminar2024_1029/index.html#細かい説明",
    "href": "seminar/seminar2024_1029/index.html#細かい説明",
    "title": "10月29日　不偏分散がカイ二乗分布に従う話",
    "section": "細かい説明",
    "text": "細かい説明\n\\(G\\) として１行目の要素が全て等しく、\\((\\frac{1}{\\sqrt{n}}, \\dots,\\frac{1}{\\sqrt{n}})\\) となっているものを考える。\n\\(g_1\\) に対して、\\(g_1, \\dots,g_n\\) が、\\(R^n\\) の正規直交底をなすように、\\(g_2, \\dots,g_n\\) を適当に選び、\\(G\\) の各行とすれば良い。\n\\(G\\) の一つの具体的な取り方として、\\(G\\) の２行目を\\(\\frac{(1,-1,0, \\dots,0)}{\\sqrt{2}}\\) とし、３行目を\\(\\frac{(1,1,-2,0, \\dots,0)}{\\sqrt{6}}\\) とする。以下同様に第\\(k\\)行を\n\\[\n\\frac{\\left( \\overbrace{1, \\dots, 1}^{k-1 \\text{個}}, -k + 1, 0, \\dots, 0 \\right)}{\\sqrt{k(k-1)}}\n\\]\nとおく。このとき\\(G\\) の各行は正規直交ベクトル系をなし、\\(G\\) は直交行列となる。このとき\\(G\\) を用いた変換はHelmert変換と呼ばれる。\n\n\n\n\\(G\\) は直交行列であるから、\n\\[\n\\sum_{i=1}^n X_i^2 = X^{\\top}X=(GX)^{\\top}GX = Y^{\\top} Y = \\sum_{i=1}^n Y_i^2\n\\]\n\n1つ目の等式の補足\n\\(X = (X_1, \\dots,X_n)^{\\top}\\) より、\\(X^{\\top}X = (X_1, \\dots,X_n)(X_1, \\dots,X_n)^{\\top}=\\sum_{i=1}^n X_i^2\\)\n\n\n2つ目の等式の補足\n\\(X^{\\top}X=(GX)^{\\top}GX\\)は\\(G\\)が直交行列なので\\(GG^{\\top}=I_n\\) である。\\(Y\\) に変換できるような形に変えている。\n\n\n\n\nまた\\(G\\)の第１行の選び方により、\\(Y_1=\\sqrt{n}\\bar{X}\\) である。（第１行が\\((\\frac{1}{\\sqrt{n}}, \\dots,\\frac{1}{\\sqrt{n}})\\) より）\n\\[\n\\sum_{i=1}^n (X_i - \\bar{X})^2= \\sum_{i=1}^n X_i^2 - n \\bar{X}^2 = \\sum_{i=1}^n Y_i^2 - Y_1^2 = \\sum_{i=2}^n Y_i^2\n\\]\n\n1つ目の等式の補足\n\\(\\sum_{i=1}^n (X_i - \\bar{X})^2= \\sum_{i=1}^n X_i^2 - n \\bar{X}^2\\) はどっかで出てきたと思うけど、展開したら計算できるはず。\n\n\n2つ目の等式の補足\n\\(Y_1=\\sqrt{n}\\bar{X}\\) より。これがおそらくHelmert行列を使った理由。 \\(GX=G(X_1,X_2,\\dots, X_n)^{\\top} = \\begin{bmatrix}\n\\frac{1}{\\sqrt{n}} & \\frac{1}{\\sqrt{n}} &\\frac{1}{\\sqrt{n}} &\\dots &\\frac{1}{\\sqrt{n}}\\\\\n\\frac{1}{\\sqrt{1 \\cdot 2}} & \\frac{-1}{\\sqrt{1 \\cdot 2}}& 0 & \\dots & 0\\\\\n\\frac{1}{\\sqrt{2 \\cdot 3}} & \\frac{1}{\\sqrt{2 \\cdot 3}}& \\frac{-2}{\\sqrt{2 \\cdot 3}}& \\dots & 0\\\\\n\\dots &\\dots&\\dots& \\ddots &\\dots\\\\\n\\frac{1}{\\sqrt{(n-1) \\cdot n}}& \\frac{1}{\\sqrt{(n-1) \\cdot n}}&\n\\frac{1}{\\sqrt{(n-1) \\cdot n}}& \\dots & \\frac{1-n}{\\sqrt{(n-1) \\cdot n}}& \\\\\n\\end{bmatrix}(X_1,X_2,\\dots, X_n)^{\\top}\\)\n\n\n\n\nしたがって\\(ns^2=\\sum_{i=1}^n (X_i - \\bar{X})^2= \\sum_{i=2}^n Y_i^2\\) は自由度\\(n-1\\)のカイ二乗分布に従う。(Yが標準多変量正規分布に従ってて、それぞれは独立に標準正規分布に従うから。正規分布の二乗和はカイ二乗分布に従うという性質から。自由度が\\(n-1\\)なのは\\(Y_i\\) が\\(n-1\\)個だから)\nまた、\\(Y_1, Y_2 , \\dots, Y_n\\) は互いに独立に標準正規分布に従うため、\\(Y_2, \\dots, Y_n\\) は\\(Y_1=\\sqrt{n}\\bar{X}\\) と互いに独立である。\\(ns^2= \\sum_{i=2}^n Y_i^2\\) も\\(\\bar{X}\\) と独立である。以上で\\(\\bar{X}\\)と\\(s^2\\) が互いに独立であり、\\(\\sigma^2 \\ne 1\\) の場合を含めて考えれば、\\(\\frac{ns^2}{\\sigma^2}=\\frac{\\sum_{i=1}^n (X_i - \\bar{X})^2}{\\sigma^2}\\) が自由度\\(n-1\\)のカイ二乗分布に従うことが示された。\nついでに、\\(Y_1=\\sqrt{n}\\bar{X}\\) であることと、\\(Y_1\\) が標準正規分布に従うことを用いると、標本平均\\(\\bar{X}\\)の分布もわかる。\n\\(\\bar{X} \\sim N(0,\\frac{1}{n})\\) になるため、\\(\\mu = 0, \\sigma^2 = 1\\) ではない場合も含めると、\\(\\bar{X} \\sim N(\\mu,\\frac{\\sigma^2}{n})\\)　になることもわかる。\n\n\\(\\sigma^2 \\ne 1\\) の場合を含めて考えるの意味\n これまで証明してきた\\(X_1,X_2, \\dots, X_n\\) は \\(\\mu = 0, \\sigma^2 = 1\\)　の時である。\n \\(\\frac{\\sum_{i=1}^n (X_i - \\bar{X})^2}{\\sigma^2}=\\sum_{i=1}^n (\\frac{X_i - \\bar{X}}{\\sigma})^2= \\sum_{i=1}^n (\\frac{X_i-\\mu}{\\sigma}-\\frac{\\mu-\\bar{X}}{\\sigma})^2 = \\sum_{i=1}^n (Z_i-\\bar{Z})^2\\)\n よって、\\(\\sigma^2\\) で割っている。"
  },
  {
    "objectID": "seminar/seminar2024_0716/index.html",
    "href": "seminar/seminar2024_0716/index.html",
    "title": "7月16日「データ解析のための数理統計入門」第4章 4の例18から",
    "section": "",
    "text": "\\(Ga(\\alpha, \\beta)\\) について積率母関数を求める。\n\n\n\\(M_X(t)\\) 積率母関数を求める。\n\\[\\begin{align}\nM_X(t)=E[e^{tX}]&=\\int^{\\infty}_{-\\infty} e^{tx} f(x) dx \\\\\n&=\\int^{\\infty}_0 e^{tx} \\frac{x^{\\alpha-1} e^{-x/\\beta}}{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} (1-\\beta t)^{\\alpha}} dx \\\\\n&=(1-\\beta t)^{-\\alpha} \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} } dx\n\\end{align}\\]\n\\((1-\\beta t)&gt;0\\)のとき、積分は，ガンマ分布\\(shape=\\alpha, scale=\\beta/(1-\\beta t)\\)の確率密度関数の標本空間\\((0,\\infty)\\)での積分と見なせるので 1 になる。\nよって積率母関数は \\((1-\\beta t)^{-\\alpha}\\) である。\n\n\n\n\\[\nM^{\\prime}_X(t)= (-\\alpha)(-\\beta)  (1-\\beta t)^{-\\alpha-1}=\\alpha \\beta  (1-\\beta t)^{-\\alpha-1}\n\\]\n\\[\nM^{\\prime \\prime}_X(t)= (-\\alpha-1)(-\\beta) \\alpha \\beta  (1-\\beta t)^{-\\alpha-2}=\\alpha (\\alpha+1)\\beta^2 (1-\\beta t)^{-\\alpha-2}\n\\]\n\n\n\n\\[\nE[X]= M^{\\prime}_X(0)=\\alpha \\beta\n\\]\n\\[\nE[X^2]=M^{\\prime \\prime}_X(0)= \\alpha (\\alpha+1)\\beta^2\n\\]\n\\[\nVar[X]=E[X^2]-E[X]^2= \\alpha (\\alpha+1)\\beta^2 - \\alpha^2 \\beta^2= \\alpha\\beta^2\n\\]"
  },
  {
    "objectID": "seminar/seminar2024_0716/index.html#ガンマ分布の積率母関数",
    "href": "seminar/seminar2024_0716/index.html#ガンマ分布の積率母関数",
    "title": "7月16日「データ解析のための数理統計入門」第4章 4の例18から",
    "section": "",
    "text": "\\(M_X(t)\\) 積率母関数を求める。\n\\[\\begin{align}\nM_X(t)=E[e^{tX}]&=\\int^{\\infty}_{-\\infty} e^{tx} f(x) dx \\\\\n&=\\int^{\\infty}_0 e^{tx} \\frac{x^{\\alpha-1} e^{-x/\\beta}}{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} (1-\\beta t)^{\\alpha}} dx \\\\\n&=(1-\\beta t)^{-\\alpha} \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} } dx\n\\end{align}\\]\n\\((1-\\beta t)&gt;0\\)のとき、積分は，ガンマ分布\\(shape=\\alpha, scale=\\beta/(1-\\beta t)\\)の確率密度関数の標本空間\\((0,\\infty)\\)での積分と見なせるので 1 になる。\nよって積率母関数は \\((1-\\beta t)^{-\\alpha}\\) である。\n\n\n\n\\[\nM^{\\prime}_X(t)= (-\\alpha)(-\\beta)  (1-\\beta t)^{-\\alpha-1}=\\alpha \\beta  (1-\\beta t)^{-\\alpha-1}\n\\]\n\\[\nM^{\\prime \\prime}_X(t)= (-\\alpha-1)(-\\beta) \\alpha \\beta  (1-\\beta t)^{-\\alpha-2}=\\alpha (\\alpha+1)\\beta^2 (1-\\beta t)^{-\\alpha-2}\n\\]\n\n\n\n\\[\nE[X]= M^{\\prime}_X(0)=\\alpha \\beta\n\\]\n\\[\nE[X^2]=M^{\\prime \\prime}_X(0)= \\alpha (\\alpha+1)\\beta^2\n\\]\n\\[\nVar[X]=E[X^2]-E[X]^2= \\alpha (\\alpha+1)\\beta^2 - \\alpha^2 \\beta^2= \\alpha\\beta^2\n\\]"
  },
  {
    "objectID": "post.html",
    "href": "post.html",
    "title": "Post",
    "section": "",
    "text": "やってみたいこと\n\n各確率分布の期待値・分散の求め方を確認\n各確率分布の積率母関数・確率母関数の求め方を確認\nWEB上で図を表現する方法を探索\n面白そうなデータセットを探索\nPythonでデータ可視化の方法を探索\n教科書の問題を解く\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSpotifyをPythonで分析\n\n\n\n\n\n\n\n\n\n2024/11/03\n\n\n\n\n\n\n\n\n\n\n\n\n「データ解析のための数理統計入門」第1章 演習問題 解答\n\n\n\n\n\n\n\n\n\n2024/11/03\n\n\n\n\n\n\n\n\n\n\n\n\n各確率分布の期待値・分散の求め方(制作途中)\n\n\n\n\n\n\n\n\n\n2024/11/02\n\n\n\n\n\n\n\n\n一致なし"
  },
  {
    "objectID": "empty/data_math1_chap3_me/index.html",
    "href": "empty/data_math1_chap3_me/index.html",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.3初等的な確率計算",
    "section": "",
    "text": "標本空間が有限個の下からなる場合を考えて、\\(\\Omega=\\{\\omega_1,\\ldots ,\\omega_N\\}\\)と表される。\n個々の元に対して\\(P({\\omega_i})=p_i\\)となるような確率が与えられることになり、\\(p1+\\cdots + p_N=1\\)を満たす。\n\n\n\\(A,B\\)はそれぞれ赤箱と白箱があり、それぞれの箱に入っているくじのあたりの数とハズレの数が下の表のようになっている。\n\n\\[\\begin{array}{|c|cc|cc|cc|}\n& A && B && A+B \\\\\n& 赤箱 & 白箱& 赤箱 & 白箱 & 赤箱 & 白箱\\\\ \\hline\n当たり& 6 & 4& 11 & 14 & 17 & 18 \\\\\nハズレ& 7 & 5& 3 & 5 & 10 & 10 \\\\ \\hline\n当たりの確率& 6/13 & 4/9& 11/14 & 14/19 & 17/27 & 18/28 \\\\\n\\end{array}\\]\n\n\\(A\\)の箱も\\(B\\)の箱もどちらも赤箱の方が当たりの確率が高い。\nしかし、\\(A\\)と\\(B\\)の箱を足し合わせると白箱の方が確率が高くなります。\nこのように、個々には確率が低くても合算すると確率が高くなる現象のことをシンプソンのパラドクスと言います。\n\n全体で考えるべきか、個々で考えるべきかは人によっても場合によっても違うようで、どちらにしろこのようなことが起こりうることに注意する必要があるそうです。\n\n\n\n復元抽出：引くたびにカードを戻す。\n\n\n非復元抽出：カードを戻さない。\n\n\n順列：カードの組み合わせが同じでも順番が異なれば別のものとして扱うこと\n組み合わせ：順番は関係なく組み合わせが同じなら同じものととしてみなすもの\n\n\n\n(1,3,4)と(1,4,3)は順列なら２通り、組み合わせなら１通りである。"
  },
  {
    "objectID": "empty/data_math1_chap3_me/index.html#シンプソンのパラドクス",
    "href": "empty/data_math1_chap3_me/index.html#シンプソンのパラドクス",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.3初等的な確率計算",
    "section": "",
    "text": "\\(A,B\\)はそれぞれ赤箱と白箱があり、それぞれの箱に入っているくじのあたりの数とハズレの数が下の表のようになっている。\n\n\\[\\begin{array}{|c|cc|cc|cc|}\n& A && B && A+B \\\\\n& 赤箱 & 白箱& 赤箱 & 白箱 & 赤箱 & 白箱\\\\ \\hline\n当たり& 6 & 4& 11 & 14 & 17 & 18 \\\\\nハズレ& 7 & 5& 3 & 5 & 10 & 10 \\\\ \\hline\n当たりの確率& 6/13 & 4/9& 11/14 & 14/19 & 17/27 & 18/28 \\\\\n\\end{array}\\]\n\n\\(A\\)の箱も\\(B\\)の箱もどちらも赤箱の方が当たりの確率が高い。\nしかし、\\(A\\)と\\(B\\)の箱を足し合わせると白箱の方が確率が高くなります。\nこのように、個々には確率が低くても合算すると確率が高くなる現象のことをシンプソンのパラドクスと言います。\n\n全体で考えるべきか、個々で考えるべきかは人によっても場合によっても違うようで、どちらにしろこのようなことが起こりうることに注意する必要があるそうです。\n\n\n\n復元抽出：引くたびにカードを戻す。\n\n\n非復元抽出：カードを戻さない。\n\n\n順列：カードの組み合わせが同じでも順番が異なれば別のものとして扱うこと\n組み合わせ：順番は関係なく組み合わせが同じなら同じものととしてみなすもの\n\n\n\n(1,3,4)と(1,4,3)は順列なら２通り、組み合わせなら１通りである。"
  },
  {
    "objectID": "empty/data_math1_chap3_me/index.html#復元抽出と非復元抽出",
    "href": "empty/data_math1_chap3_me/index.html#復元抽出と非復元抽出",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.3初等的な確率計算",
    "section": "",
    "text": "復元抽出：引くたびにカードを戻す。\n\n\n非復元抽出：カードを戻さない。\n\n\n順列：カードの組み合わせが同じでも順番が異なれば別のものとして扱うこと\n組み合わせ：順番は関係なく組み合わせが同じなら同じものととしてみなすもの\n\n\n\n(1,3,4)と(1,4,3)は順列なら２通り、組み合わせなら１通りである。"
  },
  {
    "objectID": "empty/data_math3_quest/index.html",
    "href": "empty/data_math3_quest/index.html",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "",
    "text": "正四面体の面に1,2,3,4の番号が書かれていて、転がした時、各面は等確率で現れるとする。\n正四面体は２回転がして、出た目の和を\\(X\\),差を\\(Y\\)で表すと、\\(X\\)は2から8の値を取り、\\(Y\\)は０から3の値を取る\n\n\\(X,Y\\)の同時確率関数\\(f(x,y)\\)について、\\(f(4,0),f(5,3)\\)を求めよ。\n\\(X\\)と\\(Y\\)の周辺確率関数について、\\(f_X(6),f_Y(2)\\)を求めよ。\n条件付き確率関数について、\\(f_{Y|X}(2|4),f_{X|Y}(5|1)\\)を求めよ\n\n\n\n\n\n\n\n\n\n表 1\n\n\n\n\n\\[\\begin{array}{c|cccc|c}\n1回目/2回目  & 1 & 2 & 3 & 4 \\\\ \\hline\n1 & 2 & 3 & 4 & 5  \\\\\n2 & 3 & 4 & 5 & 6 \\\\\n3 & 4 & 5 & 6 & 7 \\\\\n4 & 5 & 6 & 7 & 8 \\\\ \\hline\n\\end{array}\\]\n\n\n\\[\\begin{array}{c|cccc|c}\n1回目/2回目  & 1 & 2 & 3 & 4 \\\\ \\hline\n1 & 0 & 1 & 2 & 3  \\\\\n2 & 1 & 0 & 1 & 2 \\\\\n3 & 2 & 1 & 0 & 1 \\\\\n4 & 3 & 2 & 1 & 0 \\\\ \\hline\n\\end{array}\\]\n\n\n\n\n\n\n\n\n\\(X,Y\\)の同時分布について考える。\n\\[\\begin{array}{c|cccc|c}\n1回目/2回目  & 1 & 2 & 3 & 4 \\\\ \\hline\n1 & (2,0) & (3,1) & (4,2) & (5,3)  \\\\\n2 & (3,1) & (4,0) & (5,1) & (6,2)  \\\\\n3 & (4,2) & (5,1) & (6,0) & (7,1)  \\\\\n4 & (5,3) & (6,2) & (7,1) & (8,0)  \\\\ \\hline\n\\end{array}\\]\n度数で考える。\n\\[\\begin{array}{c|ccccccc|c}\nY/X  & 2 & 3 & 4 & 5  & 6 & 7 & 8 & 合計\\\\ \\hline\n0 & 1 & 0 & 1& 0&1  & 0&1 & 4 \\\\\n1 & 0 & 2 & 0& 2&0  & 2&0 & 6 \\\\\n2 & 0 & 0 & 2& 0&2  & 0&0 & 4\\\\\n3 & 0 & 0 & 0& 2&0  & 0&0 & 2\\\\ \\hline\n合計 & 1 & 2 & 3& 4&3  & 2&1 & 16\n\\end{array}\\]\n\\(f(4,0),f(5,3)\\)を求める。\n\\[\nf(4,0)=1/16,f(5,3)=2/16=1/8\n\\]\n\n\n\n\\(f_X(6),f_Y(2)\\)を求めよ。 \\[\nf_X(6)=3/16,f_Y(2)=4/16=1/4\n\\]\n\n\n\n\\(f_{Y|X}(2|4),f_{X|Y}(5|1)\\)を求めよ\n\\[\nf_{Y|X}(2|4)=\\frac{f(4,2)}{f_X(4)}=\\frac{2/16}{3/16}=\\frac{2}{3}\n\\]\n\\[\nf_{X|Y}(5|1)=\\frac{f(5,1)}{f_Y(1)}=\\frac{2/16}{6/16}=\\frac{1}{3}\n\\]"
  },
  {
    "objectID": "empty/data_math3_quest/index.html#問題",
    "href": "empty/data_math3_quest/index.html#問題",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "",
    "text": "正四面体の面に1,2,3,4の番号が書かれていて、転がした時、各面は等確率で現れるとする。\n正四面体は２回転がして、出た目の和を\\(X\\),差を\\(Y\\)で表すと、\\(X\\)は2から8の値を取り、\\(Y\\)は０から3の値を取る\n\n\\(X,Y\\)の同時確率関数\\(f(x,y)\\)について、\\(f(4,0),f(5,3)\\)を求めよ。\n\\(X\\)と\\(Y\\)の周辺確率関数について、\\(f_X(6),f_Y(2)\\)を求めよ。\n条件付き確率関数について、\\(f_{Y|X}(2|4),f_{X|Y}(5|1)\\)を求めよ"
  },
  {
    "objectID": "empty/data_math3_quest/index.html#解答",
    "href": "empty/data_math3_quest/index.html#解答",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "",
    "text": "表 1\n\n\n\n\n\\[\\begin{array}{c|cccc|c}\n1回目/2回目  & 1 & 2 & 3 & 4 \\\\ \\hline\n1 & 2 & 3 & 4 & 5  \\\\\n2 & 3 & 4 & 5 & 6 \\\\\n3 & 4 & 5 & 6 & 7 \\\\\n4 & 5 & 6 & 7 & 8 \\\\ \\hline\n\\end{array}\\]\n\n\n\\[\\begin{array}{c|cccc|c}\n1回目/2回目  & 1 & 2 & 3 & 4 \\\\ \\hline\n1 & 0 & 1 & 2 & 3  \\\\\n2 & 1 & 0 & 1 & 2 \\\\\n3 & 2 & 1 & 0 & 1 \\\\\n4 & 3 & 2 & 1 & 0 \\\\ \\hline\n\\end{array}\\]\n\n\n\n\n\n\n\n\n\\(X,Y\\)の同時分布について考える。\n\\[\\begin{array}{c|cccc|c}\n1回目/2回目  & 1 & 2 & 3 & 4 \\\\ \\hline\n1 & (2,0) & (3,1) & (4,2) & (5,3)  \\\\\n2 & (3,1) & (4,0) & (5,1) & (6,2)  \\\\\n3 & (4,2) & (5,1) & (6,0) & (7,1)  \\\\\n4 & (5,3) & (6,2) & (7,1) & (8,0)  \\\\ \\hline\n\\end{array}\\]\n度数で考える。\n\\[\\begin{array}{c|ccccccc|c}\nY/X  & 2 & 3 & 4 & 5  & 6 & 7 & 8 & 合計\\\\ \\hline\n0 & 1 & 0 & 1& 0&1  & 0&1 & 4 \\\\\n1 & 0 & 2 & 0& 2&0  & 2&0 & 6 \\\\\n2 & 0 & 0 & 2& 0&2  & 0&0 & 4\\\\\n3 & 0 & 0 & 0& 2&0  & 0&0 & 2\\\\ \\hline\n合計 & 1 & 2 & 3& 4&3  & 2&1 & 16\n\\end{array}\\]\n\\(f(4,0),f(5,3)\\)を求める。\n\\[\nf(4,0)=1/16,f(5,3)=2/16=1/8\n\\]\n\n\n\n\\(f_X(6),f_Y(2)\\)を求めよ。 \\[\nf_X(6)=3/16,f_Y(2)=4/16=1/4\n\\]\n\n\n\n\\(f_{Y|X}(2|4),f_{X|Y}(5|1)\\)を求めよ\n\\[\nf_{Y|X}(2|4)=\\frac{f(4,2)}{f_X(4)}=\\frac{2/16}{3/16}=\\frac{2}{3}\n\\]\n\\[\nf_{X|Y}(5|1)=\\frac{f(5,1)}{f_Y(1)}=\\frac{2/16}{6/16}=\\frac{1}{3}\n\\]"
  },
  {
    "objectID": "empty/data_math3_quest/index.html#問題-1",
    "href": "empty/data_math3_quest/index.html#問題-1",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "問題",
    "text": "問題\n多項定理について次の問に答えよ。\n\n\\(X_i \\sim Bin(n,p_i)\\),\\(X_i+X_j \\sim Bin(n,p_i+p_j)\\)を示せ\n\\(X_i\\)を与えた時の\\(X_j\\)の条件付き確率を求めよ。\n\\(X_i+X_j\\)を与えた時の\\(X_2\\)の条件付き確率を求めよ。"
  },
  {
    "objectID": "empty/data_math3_quest/index.html#解答-1",
    "href": "empty/data_math3_quest/index.html#解答-1",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "解答",
    "text": "解答\n\n1"
  },
  {
    "objectID": "empty/quarto_my_tip/index.html",
    "href": "empty/quarto_my_tip/index.html",
    "title": "Quarto 自分用のTips!",
    "section": "",
    "text": "&lt;details&gt;\n  &lt;summary&gt;見えるところ&lt;/summary&gt;\n  隠れるところ\n&lt;/details&gt;\n\n\n\n\n\n見えるところ\n\n隠れるところ"
  },
  {
    "objectID": "empty/quarto_my_tip/index.html#コード",
    "href": "empty/quarto_my_tip/index.html#コード",
    "title": "Quarto 自分用のTips!",
    "section": "",
    "text": "&lt;details&gt;\n  &lt;summary&gt;見えるところ&lt;/summary&gt;\n  隠れるところ\n&lt;/details&gt;"
  },
  {
    "objectID": "empty/quarto_my_tip/index.html#結果",
    "href": "empty/quarto_my_tip/index.html#結果",
    "title": "Quarto 自分用のTips!",
    "section": "",
    "text": "見えるところ\n\n隠れるところ"
  },
  {
    "objectID": "empty/latex_basis/index.html",
    "href": "empty/latex_basis/index.html",
    "title": "LaTeXの数式　よく使うもの　対応表",
    "section": "",
    "text": "等号・不等号など\n\n\n\n数式\nLaTeXコード\n補足\n\n\n\n\n\\(=\\)\n=\n\n\n\n\\(&lt;\\)\n&lt;\n\n\n\n\\(\\le\\)\n\\le\n\n\n\n\\(\\leq\\)\n\\leq\n\n\n\n\\(\\leqq\\)\n\\leqq\n\n\n\n\\(&gt;\\)\n&gt;\n\n\n\n\\(\\ge\\)\n\\ge\n\n\n\n\\(\\geq\\)\n\\geq\n\n\n\n\\(\\geqq\\)\n\\geqq\n\n\n\n\\(\\risingdotseq\\)\n\\risingdotseq\n\n\n\n\\(\\fallingdotseq\\)\n\\fallingdotseq\n\n\n\n\\(\\sim\\)\n\\sim\n従う\n\n\n\n\n\n集合\n\n\n\n数式\nLaTeXコード\n補足\n\n\n\n\n\\(\\cap\\)\n\\cap\n\n\n\n\\(\\cup\\)\n\\cup\n\n\n\n\\(\\emptyset\\)\n\\emptyset\n\n\n\n\\(A^c\\)\nA^c\n\n\n\n\\(\\overline{A}\\)\n\\overline{A}\n\n\n\n\\(\\subset\\)\n\\subset\n部分集合\n\n\n\\(\\in\\)\n\\in\n\n\n\n\\(\\setminus\\)\n\\setminus\n差集合\n\n\n\n\n\n\nその他\n\n\n\n数式\nLaTeXコード\n補足\n\n\n\n\n\\(\\mathcal{X}\\)\n\\mathcal{X}\n\n\n\n\\(\\cup\\)\n\\cup\n\n\n\n\\(\\ldots\\)\n\\ldots\n\n\n\n\\(\\cdots\\)\n\\cdots"
  },
  {
    "objectID": "solve/data_math4_quest/index.html",
    "href": "solve/data_math4_quest/index.html",
    "title": "「データ解析のための数理統計入門」第4章 演習問題 解答",
    "section": "",
    "text": "\\(X \\sim Po(\\lambda)\\)\n⑴ \\(E[\\frac{1}{X+1}]\\)\n⑵ \\(E[\\frac{1}{X+2}]\\)\n\n\n\n⑴\n期待値の定義から求める。\n\\[\n\\begin{aligned}\nE[\\frac{1}{X+1}] &= \\sum_{x=0}^\\infty \\frac{1}{x+1} \\frac{\\lambda^x}{x!} e^{-\\lambda} \\\\\n&= \\sum_{x=0}^\\infty  \\frac{\\lambda^{x+1}}{(x+1)!} e^{-\\lambda} \\times \\frac{1}{\\lambda} \\\\\n&= \\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!} e^{-\\lambda} \\times \\frac{1}{\\lambda} \\\\\n&= \\frac{1}{\\lambda}(e^{\\lambda}-1)e^{\\lambda} \\\\\n&= \\frac{1}{\\lambda} (1-e^{-\\lambda})\n\\end{aligned}\n\\]\n\\(1-e^{-\\lambda}\\) の補足。\n\\[\n\\begin{aligned}\ne^\\lambda = 1 + \\lambda + \\frac{\\lambda^2}{2!}+ \\frac{\\lambda^3}{3!} + \\dots = \\sum_{x=0}^{\\infty} \\frac{\\lambda^x}{x!}\n\\end{aligned}\n\\]\nを用いて、\\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!}\\) を求めたい。これは\\(\\sum_{x=0}^{\\infty} \\frac{\\lambda^x}{x!}\\) から\\(x=0\\) の時を引けば良い。\\(x=0\\) のときは1であり, \\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!} = e^{\\lambda}-1\\)　であり、\\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!}e^{-\\lambda} = (e^{\\lambda}-1)e^{\\lambda} = 1-e^{-\\lambda}\\)\nになるってことだと思ってる。\n⑵\n階乗を利用して同じようにときたいので、\\(E[\\frac{1}{(X+2)(X+1)}]\\) をまず求める。⑴で求めた\\(E[\\frac{1}{X+1}]\\) と合わせて計算すると求めれるはず。\n\\[\n\\begin{aligned}\nE[\\frac{1}{(X+2)(X+1)}] &= \\sum_{x=0}^\\infty \\frac{1}{(x+1)(x+1)} \\frac{\\lambda^x}{x!} e^{-\\lambda} \\\\\n&= \\sum_{x=0}^\\infty  \\frac{\\lambda^{x+2}}{(x+2)!} e^{-\\lambda} \\times \\frac{1}{\\lambda^2} \\\\\n&= \\sum_{x'=2}^\\infty  \\frac{\\lambda^{x'}}{x'!} e^{-\\lambda} \\times \\frac{1}{\\lambda^2} \\\\\n&= \\frac{1}{\\lambda^2} (e^\\lambda -1 - \\lambda) e^{-\\lambda} \\\\\n&= \\frac{1}{\\lambda^2} (1- e^{-\\lambda} - \\lambda e^{-\\lambda} )\n\\end{aligned}\n\\]\n\\(e^\\lambda -1 - \\lambda\\) の補足。\n⑴と同じで、x=0,1の時の1と\\(\\lambda\\) を引いてる。\n\\[\n\\begin{aligned}\nE[\\frac{1}{X+2}] &= E[\\frac{X+1}{(X+2)(X+1)}] \\\\\n&=E[\\frac{X+2-1}{(X+2)(X+1)}] \\\\\n&=E[\\frac{1}{X+1}]-E[\\frac{1}{(X+2)(X+1)}]\\\\\n&= \\frac{1}{\\lambda} (1-e^{-\\lambda}) -\\frac{1}{\\lambda^2} (1- e^{-\\lambda} - \\lambda e^{-\\lambda} ) \\\\\n&= \\frac{1}{\\lambda^2} (-1 + \\lambda + e^{-\\lambda})\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "solve/data_math4_quest/index.html#問題概要",
    "href": "solve/data_math4_quest/index.html#問題概要",
    "title": "「データ解析のための数理統計入門」第4章 演習問題 解答",
    "section": "",
    "text": "\\(X \\sim Po(\\lambda)\\)\n⑴ \\(E[\\frac{1}{X+1}]\\)\n⑵ \\(E[\\frac{1}{X+2}]\\)"
  },
  {
    "objectID": "solve/data_math4_quest/index.html#解答",
    "href": "solve/data_math4_quest/index.html#解答",
    "title": "「データ解析のための数理統計入門」第4章 演習問題 解答",
    "section": "",
    "text": "⑴\n期待値の定義から求める。\n\\[\n\\begin{aligned}\nE[\\frac{1}{X+1}] &= \\sum_{x=0}^\\infty \\frac{1}{x+1} \\frac{\\lambda^x}{x!} e^{-\\lambda} \\\\\n&= \\sum_{x=0}^\\infty  \\frac{\\lambda^{x+1}}{(x+1)!} e^{-\\lambda} \\times \\frac{1}{\\lambda} \\\\\n&= \\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!} e^{-\\lambda} \\times \\frac{1}{\\lambda} \\\\\n&= \\frac{1}{\\lambda}(e^{\\lambda}-1)e^{\\lambda} \\\\\n&= \\frac{1}{\\lambda} (1-e^{-\\lambda})\n\\end{aligned}\n\\]\n\\(1-e^{-\\lambda}\\) の補足。\n\\[\n\\begin{aligned}\ne^\\lambda = 1 + \\lambda + \\frac{\\lambda^2}{2!}+ \\frac{\\lambda^3}{3!} + \\dots = \\sum_{x=0}^{\\infty} \\frac{\\lambda^x}{x!}\n\\end{aligned}\n\\]\nを用いて、\\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!}\\) を求めたい。これは\\(\\sum_{x=0}^{\\infty} \\frac{\\lambda^x}{x!}\\) から\\(x=0\\) の時を引けば良い。\\(x=0\\) のときは1であり, \\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!} = e^{\\lambda}-1\\)　であり、\\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!}e^{-\\lambda} = (e^{\\lambda}-1)e^{\\lambda} = 1-e^{-\\lambda}\\)\nになるってことだと思ってる。\n⑵\n階乗を利用して同じようにときたいので、\\(E[\\frac{1}{(X+2)(X+1)}]\\) をまず求める。⑴で求めた\\(E[\\frac{1}{X+1}]\\) と合わせて計算すると求めれるはず。\n\\[\n\\begin{aligned}\nE[\\frac{1}{(X+2)(X+1)}] &= \\sum_{x=0}^\\infty \\frac{1}{(x+1)(x+1)} \\frac{\\lambda^x}{x!} e^{-\\lambda} \\\\\n&= \\sum_{x=0}^\\infty  \\frac{\\lambda^{x+2}}{(x+2)!} e^{-\\lambda} \\times \\frac{1}{\\lambda^2} \\\\\n&= \\sum_{x'=2}^\\infty  \\frac{\\lambda^{x'}}{x'!} e^{-\\lambda} \\times \\frac{1}{\\lambda^2} \\\\\n&= \\frac{1}{\\lambda^2} (e^\\lambda -1 - \\lambda) e^{-\\lambda} \\\\\n&= \\frac{1}{\\lambda^2} (1- e^{-\\lambda} - \\lambda e^{-\\lambda} )\n\\end{aligned}\n\\]\n\\(e^\\lambda -1 - \\lambda\\) の補足。\n⑴と同じで、x=0,1の時の1と\\(\\lambda\\) を引いてる。\n\\[\n\\begin{aligned}\nE[\\frac{1}{X+2}] &= E[\\frac{X+1}{(X+2)(X+1)}] \\\\\n&=E[\\frac{X+2-1}{(X+2)(X+1)}] \\\\\n&=E[\\frac{1}{X+1}]-E[\\frac{1}{(X+2)(X+1)}]\\\\\n&= \\frac{1}{\\lambda} (1-e^{-\\lambda}) -\\frac{1}{\\lambda^2} (1- e^{-\\lambda} - \\lambda e^{-\\lambda} ) \\\\\n&= \\frac{1}{\\lambda^2} (-1 + \\lambda + e^{-\\lambda})\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "solve/data_math4_quest/index.html#問題概要-1",
    "href": "solve/data_math4_quest/index.html#問題概要-1",
    "title": "「データ解析のための数理統計入門」第4章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n連続確率変数\\(X\\) の分布関数が以下。\n\\[\nF(x) =\n\\begin{cases}\n0  & (- \\infty \\leq x \\leq 0)\\\\\n1-\\frac{(x-2)^2}{4} & (0 \\leq x \\leq 2)\\\\\n1 &(2 \\leq x)\n\\end{cases}\n\\]\n⑴ 確率密度関数を求める。\n⑵ \\(E[X], V(X)\\) を求める。\n⑶ メディアン、モードを求める。"
  },
  {
    "objectID": "solve/data_math4_quest/index.html#解答-1",
    "href": "solve/data_math4_quest/index.html#解答-1",
    "title": "「データ解析のための数理統計入門」第4章 演習問題 解答",
    "section": "解答",
    "text": "解答\n⑴ \\(0 \\leq x \\leq 2\\) のとき、\n\\[\nf(x)= F'(x)= -2 \\frac{x-2}{4} = \\frac{2-x}{2}\n\\]\n\\[\nF(x) =\n\\begin{cases}\n0  & (- \\infty \\leq x \\leq 0)\\\\\n\\frac{2-x}{2} & (0 \\leq x \\leq 2)\\\\\n0 &(2 \\leq x)\n\\end{cases}\n\\]\n⑵\n\\[\n\\begin{aligned}\nE[X^k]&=  \\int^{2}_{0} x^k \\frac{2-x}{2}dx \\\\\n&=  \\int^{2}_{0} x^kdx - \\frac{1}{2} \\int^{2}_{0} x^{k+1}dx \\\\\n&= [\\frac{1}{k+1}x^{k+1}]^2_0-\\frac{1}{2}[\\frac{1}{k+2}x^{k+2}]^2_0 \\\\\n&= \\frac{2^{k+1}}{k+1} - \\frac{2^{k+1}}{k+2} \\\\\n&= \\frac{2^{k+1}}{(k+1)(k+2)}\n\\end{aligned}\n\\]\n\\(E[X]=\\frac{2^2}{(2)(3)}=\\frac{2}{3}\\),\\(E[X^2]=\\frac{2^3}{(3)(4)}=\\frac{2}{3}\\)である。\n\\(V[X]=\\frac{2}{3}-\\frac{4}{9}=\\frac{2}{9}\\)\n⑶\nメディアンを\\(x_{med}\\) とする。モードは\\(x_{mode}\\) とする。\nメディアンは累積確率が0.5になるところなので、\n\\[\n\\begin{aligned}\n1 - \\frac{(x_{med}-2)^2}{4} = \\frac{1}{2} \\\\\nx_{med} = 2 \\pm \\sqrt{2}\n\\end{aligned}\n\\]\n\\(0 \\leq x \\leq 2\\) より\\(x_{med}= 2-\\sqrt{2}\\)\nモードは\\(f(x)\\)が最大となる値なので、\\(f'(x)\\) からわかる。\\(0 \\leq x \\leq 2\\) のとき\\(f'(x)=-1\\) より\\(x=0\\) がモードとなる。"
  },
  {
    "objectID": "solve/data_math3_quest/index.html",
    "href": "solve/data_math3_quest/index.html",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "",
    "text": "\\(X,Y\\)が確率変数で、1~4を２回やるときの和と差に対応。\n\n\n\\(f(4,0), f(5,3)\\) を求める。\n\n\n\n\\(f_X(6),f_Y(2)\\) を求める。\n\n\n\n\\(f_{Y|X}(2|4),f_{X|Y}(5|1)\\)\n\n\n\n\n\n\n\\[\nf(4,0)=P(X=4,Y=0) = \\frac{1}{16}\n\\]\n\\[\nf(5,3)=P(X=5,Y=3) = \\frac{2}{16} = \\frac{1}{8}\n\\]\n\n\n\n\\[\nf_X(6)= f(6,0)+f(6,1)+f(6,2)+f(6,3)= \\frac{1}{16} + 0 + \\frac{2}{16} + 0 =\\frac{3}{16}\n\\]\n\\[\nf_Y(2)= f(2,2)+f(3,2)+f(4,2)+f(5,2)+f(6,2)+f(7,2)+f(8,2)= 0+ 0+ \\frac{2}{16}+0+\\frac{2}{16}+0+0=\\frac{1}{4}\n\\]\n\n\n\n\\[\nf_{Y|X}(2|4)=\\frac{f(4,2)}{f_X(4)}=\\frac{f(4,2)}{f(4,0)+f(4,1)+f(4,2)+f(4,3)} =\\frac{2/16}{1/16+2/16}=\\frac{2}{3}\n\\]\n\\[\nf_{X|Y}(5|1) = \\frac{f(5,1)}{f_Y(1)}= \\frac{f(5,1)}{f(2,1)+f(3,1)+f(4,1)+f(5,1)+f(6,1)+f(7,1)+f(8,1)} = \\frac{2/16}{2/16+2/16+2/16}= \\frac{1}{3}\n\\]"
  },
  {
    "objectID": "solve/data_math3_quest/index.html#問題概要",
    "href": "solve/data_math3_quest/index.html#問題概要",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "",
    "text": "\\(X,Y\\)が確率変数で、1~4を２回やるときの和と差に対応。\n\n\n\\(f(4,0), f(5,3)\\) を求める。\n\n\n\n\\(f_X(6),f_Y(2)\\) を求める。\n\n\n\n\\(f_{Y|X}(2|4),f_{X|Y}(5|1)\\)"
  },
  {
    "objectID": "solve/data_math3_quest/index.html#回答",
    "href": "solve/data_math3_quest/index.html#回答",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "",
    "text": "\\[\nf(4,0)=P(X=4,Y=0) = \\frac{1}{16}\n\\]\n\\[\nf(5,3)=P(X=5,Y=3) = \\frac{2}{16} = \\frac{1}{8}\n\\]\n\n\n\n\\[\nf_X(6)= f(6,0)+f(6,1)+f(6,2)+f(6,3)= \\frac{1}{16} + 0 + \\frac{2}{16} + 0 =\\frac{3}{16}\n\\]\n\\[\nf_Y(2)= f(2,2)+f(3,2)+f(4,2)+f(5,2)+f(6,2)+f(7,2)+f(8,2)= 0+ 0+ \\frac{2}{16}+0+\\frac{2}{16}+0+0=\\frac{1}{4}\n\\]\n\n\n\n\\[\nf_{Y|X}(2|4)=\\frac{f(4,2)}{f_X(4)}=\\frac{f(4,2)}{f(4,0)+f(4,1)+f(4,2)+f(4,3)} =\\frac{2/16}{1/16+2/16}=\\frac{2}{3}\n\\]\n\\[\nf_{X|Y}(5|1) = \\frac{f(5,1)}{f_Y(1)}= \\frac{f(5,1)}{f(2,1)+f(3,1)+f(4,1)+f(5,1)+f(6,1)+f(7,1)+f(8,1)} = \\frac{2/16}{2/16+2/16+2/16}= \\frac{1}{3}\n\\]"
  },
  {
    "objectID": "solve/data_math3_quest/index.html#問題概要-1",
    "href": "solve/data_math3_quest/index.html#問題概要-1",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n多項分布について。\n\n小問1\n多項分布の周辺分布は二項分布か、周辺分布の和の分布はどうなるか。\n\n\n小問2\n\\(X_1\\) を与えた時の、\\(X_2\\)の条件付き確率。\n\n\n小問3\n\\(X_1+X_2\\) を与えた時の\\(X_2\\) の条件付き確率。"
  },
  {
    "objectID": "solve/data_math3_quest/index.html#回答-1",
    "href": "solve/data_math3_quest/index.html#回答-1",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "回答",
    "text": "回答\n\n小問1\n多項分布は多次元の確率変数で、\\(1\\)から\\(m\\) の番号が書かれた多面体を\\(n\\) 回投げる時に、それぞれの面が出る確率を\\(p_1,p_2,\\dots,p_m=1\\) とし、\\(X_1+X_2+ \\dots + X_m=n\\) である分布。\n\\(X_i\\) の周辺分布は\\(i\\)　番目が出るか出ないかであり、\\(Bin(n,p_i)\\)となるし、\\(X_i+X_j\\) の周辺分布は\\(i\\)番目もしくは\\(j\\)　番目が出るか出ないかなので\\(Bin(n,p_i+p_j)\\) である。\nサイコロで考えてみるとわかりやすいかも。\n\n\n小問2\n求めたいのは\\(\\frac{P(X_1=x_1,X_2=x_2)}{P(X_1=x_1)}\\) である。それぞれ、\n\\[\nP(X=x_1)= \\frac{n!}{x_1!(n-x_1)!} p_1^{x_1}(1-p_1)^{n-x_1}\n\\]\n\\[\nP(X_1=x_1,X_2=x_2)= \\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}\n\\]\nよって\n\\[\n\\begin{aligned}\n\\frac{P(X_1=x_1,X_2=x_2)}{P(X_1=x_1)}\n=\\frac{\\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}}{\\frac{n!}{x_1!(n-x_1)!} p_1^{x_1}(1-p_1)^{n-x_1}} \\\\\n= \\frac{(n-x_1)!}{x_2!(n-x_1-x_2)!} (\\frac{p_2}{1-p_1})^{x_2} (\\frac{1-p_1-p_2}{1-p_1})^{n-x_1-x_2}\n\\end{aligned}\n\\]\nこれによって条件付き確率は二項分布\\(Bin(n-x_1,\\frac{p_2}{1-p_1})\\) に従う。\n直感的にも、例えばサイコロを１０回投げるとして1の目が２回出たことを知っていたら、2の目が出る確率は試行回数が8回で2~6の1/5の確率で出る二項分布というのはしっくりきます。\n\n\n小問3\n求めたいのは\\(\\frac{P(X_2=x_2)}{P(X_1+X_2=z)}=\\frac{P(X_2=x_2)}{P(X_1+X_2=x_1+x_2)}\\) である。\n(変数\\(x_2\\)が与えられれば\\(x_1\\)は自ずと決まるので、\\(x_1\\)を使う。)\nそれぞれ\n\\[\nP(X_1+X_2=x_1+x_2)=\\frac{n!}{(x_1+x_2)!(n-x_1-x_2)!}(p_1+p_2)^{x_1+x_2}(1-p_1-p_2)^{n-x_1-x_2}\n\\]\n\\[\nP(X_2=x_2,X_1+X_2=x_1+x_2)=P(X_1=x_1,X_2=x_2)= \\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}\n\\]\n\\[\n\\begin{aligned}\n\\frac{P(X_2=x_2)}{P(X_1+X_2=x_1+x_2)}=\\frac{\\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_1-x_2}}{\\frac{n!}{(x_1+x_2)!(n-x_1-x_2)!}(p_1+p_2)^{x_1+x_2}(1-p_1-p_2)^{n-x_1-x_2}} \\\\\n=\\frac{(x_1+x_2)!}{x_1!x_2!} (\\frac{p_2}{p_1+p_2})^{x_2}(\\frac{p_1}{p_1+p_2})^{x_1}\n\\end{aligned}\n\\]\nよって条件付き分布は二項分布\\(Bin(z,\\frac{p_2}{p_1+p_2})\\) に従う。\nこれもサイコロで例えると、１の目が出た回数と2の目が出た回数が合計4回だと知っているとき、2の目が出る確率は試行回数4回で1/2の二項分布の確率になりそうですよね。"
  },
  {
    "objectID": "solve/data_math3_quest/index.html#問題概要-2",
    "href": "solve/data_math3_quest/index.html#問題概要-2",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(X,Y\\) がそれぞれポアソン分布に従う。\n\n小問1\n\\(Z=X+Y\\) の分布を求めよ。\n\n\n小問2\n\\(X+Y=n\\)に固定した時、\\(X\\) の条件付き分布を求める。"
  },
  {
    "objectID": "solve/data_math3_quest/index.html#回答-2",
    "href": "solve/data_math3_quest/index.html#回答-2",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "回答",
    "text": "回答\n\n小問1\n再生性からと言いたいところですが、誘導に乗ってみます。（離散確率の変数変換の方法ってどこかに載ってたかな）\n\\(X=x\\) という実現値を取る時、\\(Y\\) は自ずと\\(n-x\\) という実現時をとる。\\(X\\) と\\(Y\\) は独立であり、同時確率は積であらわすことができるため、\n\\[\nP(X+Y=n) = \\sum_{x=0}^n P(X=x)P(Y=n-x)\n\\]\nと表せる。これを計算すると\n\\[\n\\begin{aligned}\n\\sum_{x=0}^n P(X=x)P(Y=n-x) &= \\sum_{x=0}^n\\frac{\\lambda_1^x}{x!}e^{-\\lambda_1}\\frac{\\lambda_2^{n-x}}{(n-x)!}e^{-\\lambda_2} \\\\\n&=\\frac{(\\lambda_1+\\lambda_2)^n}{n!} e^{-(\\lambda_1+\\lambda_2)} \\sum_{x=0}^n\\frac{n!}{x!(n-x)!} \\left(\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\right)^x \\left(\\frac{\\lambda_2}{\\lambda_1+\\lambda_2}\\right)^{n-x} \\\\\n&=\\frac{(\\lambda_1+\\lambda_2)^n}{n!} e^{-(\\lambda_1+\\lambda_2)}\n\\end{aligned}\n\\]\n\\(\\displaystyle \\sum_{x=0}^n\\frac{n!}{x!(n-x)!} \\left(\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\right)^x \\left(\\frac{\\lambda_2}{\\lambda_1+\\lambda_2}\\right)^{n-x}\\) は嬉しいことに、二項分布\\(\\displaystyle Bin(n,\\frac{\\lambda_1}{\\lambda_1+\\lambda_2})\\) に従う分布の全確率？（用語があっているかわからない）なので1になります。\n\\(X+Y=n\\) という確率変数が従う分布は\\(Po(\\lambda_1+\\lambda_2)\\) になります。\n例えば\\(X \\sim Po(2)\\),\\(Y \\sim Po(3)\\) なら\\(X+Y \\sim Po(5)\\) になるみたいなことですね。\n\n\n小問2\n求めたいのは\\(\\displaystyle \\frac{P(X+Y=n,X=x)}{P(X+Y=n)}\\) である。\nまた\\(P(X+Y=n,X=x)=P(X=x,Y=n-x)\\) とも表せれるので、\n\\[\n\\begin{aligned}\n  \\frac{P(X=x,Y=n-x)}{P(X+Y=n)} &=\\frac{\\frac{\\lambda_1^x}{x!}e^{-\\lambda_1}\\frac{\\lambda_2^{n-x}}{(n-x)!}e^{-\\lambda_2}}{\\frac{(\\lambda_1+\\lambda_2)^n}{n!} e^{-(\\lambda_1+\\lambda_2)}} \\\\\n  &=\\frac{n!}{x!(n-x)!} \\left(\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\right)^x \\left(\\frac{\\lambda_2}{\\lambda_1+\\lambda_2}\\right)^{n-x}\n\\end{aligned}\n\\]\n綺麗に二項分布\\(\\displaystyle Bin(n,\\frac{\\lambda_1}{\\lambda_1+\\lambda_2})\\)に従います！\nちなみに統計検定準１級の勉強でも出てきました。"
  },
  {
    "objectID": "solve/data_math3_quest/index.html#問題概要-3",
    "href": "solve/data_math3_quest/index.html#問題概要-3",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(f(x,y)=xe^{-x(y+1)} I(x &gt; 0,y&gt;0)\\) の周辺確率、条件確率、\\(P(XY &gt; 1)\\) を計算。"
  },
  {
    "objectID": "solve/data_math3_quest/index.html#回答-3",
    "href": "solve/data_math3_quest/index.html#回答-3",
    "title": "「データ解析のための数理統計入門」第3章 演習問題 解答",
    "section": "回答",
    "text": "回答\n\\[\n\\begin{aligned}\n  f_X(x)\n  &= \\int^{\\infty}_{0} xe^{-x(y+1)} dy \\\\\n  &= xe^{-x} \\int^{\\infty}_{0} e^{-xy} dy \\\\\n  &= xe^{-x} \\left[-\\frac{1}{x}e^{-xy}\\right]^{\\infty}_{y=0} \\\\\n  &= e^{-x}\n\\end{aligned}\n\\]\n\\[\n\\begin{aligned}\n  f_Y(y)\n  &= \\int^{\\infty}_{0} xe^{-x(y+1)} dx \\\\\n  &= \\frac{1}{(y+1)^2} \\int^{\\infty}_{0} \\frac{1}{\\Gamma(2) (y+1)^{-2}} xe^{-x(y+1)} dx \\\\\n  &= \\frac{1}{(y+1)^2}\n\\end{aligned}\n\\]\n\\(xe^{-x}\\) みたいな形を見つけたら、ガンマ関数の式に持っていくのがよくある計算だと感じてきた。\n\\(xe^{-x(y+1)}\\)から\\(\\alpha=2,\\beta=(y+1)^{-1}\\) にしたら都合がよさそうなことから、この変形をしている。\n\\[\n\\begin{aligned}\nf_{X|Y}(x|y)\n&= \\frac{f(x,y)}{f_Y(y)} \\\\\n&= \\frac{xe^{-x(y+1)} }{(y+1)^{-2} } \\\\\n&= \\frac{1}{\\Gamma(2)(y+1)^2} x^{2-1} e^{-(y+1)x}\n\\end{aligned}\n\\]\n３つ目の等式はガンマ分布に落ち着きそうな気配を察して、\\(\\Gamma(2)=1\\)を入れている。\nよって\n\\[\nX|Y=y \\sim Ga(2,(y+1)^{-1})\n\\]\nとなる。\n\\[\n\\begin{aligned}\nf_{Y|X}(y|x)\n&= \\frac{f(x,y)}{f_X(x)} \\\\\n&= \\frac{xe^{-x(y+1)} }{e^{-x}} \\\\\n&= xe^{-xy}\n\\end{aligned}\n\\]\n一瞬見慣れないと思いきや、\\(y\\) の関数で\\(x\\)はすでに与えられているパラメーターです。すると指数分布\\(Ex(x)\\)に従うことがわかります。\n\\[\n\\begin{aligned}\n  P(XY&gt;1) &= \\int^{\\infty}_{0} \\int^{\\infty}_{\\frac{1}{x}} xe^{-x(y+1)} dy dx \\\\\n  &= \\int^{\\infty}_{0} x e^{-x} \\\\\n  &= \\frac{1}{e}\n\\end{aligned}\n\\]\n\\(\\int^{\\infty}_{0} \\int^{\\infty}_{\\frac{1}{x}}\\) がしっくりきてない。なんとなくそうな気はするけど、\\(\\int^{\\infty}_{\\frac{1}{y}} \\int^{\\infty}_{\\frac{1}{x}}\\) じゃだめなのかがわからない。"
  },
  {
    "objectID": "ukeru.html",
    "href": "ukeru.html",
    "title": "",
    "section": "",
    "text": "コード"
  },
  {
    "objectID": "ukeru.html#問題概要",
    "href": "ukeru.html#問題概要",
    "title": "",
    "section": "問題概要",
    "text": "問題概要\n\\(X,Y\\)が確率変数で、1~4を２回やるときの和と差に対応。\n\n小問1\n\\(f(4,0), f(5,3)\\) を求める。\n\n\n小問2\n\\(f_X(6),f_Y(2)\\) を求める。\n\n\n小問3\n\\(f_{Y|X}(2|4),f_{X|Y}(5|1)\\)"
  },
  {
    "objectID": "ukeru.html#回答",
    "href": "ukeru.html#回答",
    "title": "",
    "section": "回答",
    "text": "回答\n\n小問1\n\\[\nf(4,0)=P(X=4,Y=0) = \\frac{1}{16}\n\\]\n\\[\nf(5,3)=P(X=5,Y=3) = \\frac{2}{16} = \\frac{1}{8}\n\\]\n\n\n小問2\n\\[\nf_X(6)= f(6,0)+f(6,1)+f(6,2)+f(6,3)= \\frac{1}{16} + 0 + \\frac{2}{16} + 0 =\\frac{3}{16}\n\\]\n\\[\nf_Y(2)= f(2,2)+f(3,2)+f(4,2)+f(5,2)+f(6,2)+f(7,2)+f(8,2)= 0+ 0+ \\frac{2}{16}+0+\\frac{2}{16}+0+0=\\frac{1}{4}\n\\]\n\n\n小問3\n\\[\nf_{Y|X}(2|4)=\\frac{f(4,2)}{f_X(4)}=\\frac{f(4,2)}{f(4,0)+f(4,1)+f(4,2)+f(4,3)} =\\frac{2/16}{1/16+2/16}=\\frac{2}{3}\n\\]\n\\[\nf_{X|Y}(5|1) = \\frac{f(5,1)}{f_Y(1)}= \\frac{f(5,1)}{f(2,1)+f(3,1)+f(4,1)+f(5,1)+f(6,1)+f(7,1)+f(8,1)} = \\frac{2/16}{2/16+2/16+2/16}= \\frac{1}{3}\n\\]"
  },
  {
    "objectID": "ukeru.html#問題概要-1",
    "href": "ukeru.html#問題概要-1",
    "title": "",
    "section": "問題概要",
    "text": "問題概要\n多項分布について。\n\n小問1\n多項分布の周辺分布は二項分布か、周辺分布の和の分布はどうなるか。\n\n\n小問2\n\\(X_1\\) を与えた時の、\\(X_2\\)の条件付き確率。\n\n\n小問3\n\\(X_1+X_2\\) を与えた時の\\(X_2\\) の条件付き確率。"
  },
  {
    "objectID": "ukeru.html#回答-1",
    "href": "ukeru.html#回答-1",
    "title": "",
    "section": "回答",
    "text": "回答\n\n小問1\n多項分布は多次元の確率変数で、\\(1\\)から\\(m\\) の番号が書かれた多面体を\\(n\\) 回投げる時に、それぞれの面が出る確率を\\(p_1,p_2,\\dots,p_m=1\\) とし、\\(X_1+X_2+ \\dots + X_m=n\\) である分布。\n\\(X_i\\) の周辺分布は\\(i\\)　番目が出るか出ないかであり、\\(Bin(n,p_i)\\)となるし、\\(X_i+X_j\\) の周辺分布は\\(i\\)番目もしくは\\(j\\)　番目が出るか出ないかなので\\(Bin(n,p_i+p_j)\\) である。\nサイコロで考えてみるとわかりやすいかも。\n\n\n小問2\n求めたいのは\\(\\frac{P(X_1=x_1,X_2=x_2)}{P(X_1=x_1)}\\) である。それぞれ、\n\\[\nP(X=x_1)= \\frac{n!}{x_1!(n-x_1)!} p_1^{x_1}(1-p_1)^{n-x_1}\n\\]\n\\[\nP(X_1=x_1,X_2=x_2)= \\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}\n\\]\nよって\n\\[\n\\begin{aligned}\n\\frac{P(X_1=x_1,X_2=x_2)}{P(X_1=x_1)}\n=\\frac{\\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}}{\\frac{n!}{x_1!(n-x_1)!} p_1^{x_1}(1-p_1)^{n-x_1}} \\\\\n= \\frac{(n-x_1)!}{x_2!(n-x_1-x_2)!} (\\frac{p_2}{1-p_1})^{x_2} (\\frac{1-p_1-p_2}{1-p_1})^{n-x_1-x_2}\n\\end{aligned}\n\\]\nこれによって条件付き確率は二項分布\\(Bin(n-x_1,\\frac{p_2}{1-p_1})\\) に従う。\n直感的にも、例えばサイコロを１０回投げるとして1の目が２回出たことを知っていたら、2の目が出る確率は試行回数が8回で2~6の1/5の確率で出る二項分布というのはしっくりきます。\n\n\n小問3\n求めたいのは\\(\\frac{P(X_2=x_2)}{P(X_1+X_2=z)}=\\frac{P(X_2=x_2)}{P(X_1+X_2=x_1+x_2)}\\) である。\n(変数\\(x_2\\)が与えられれば\\(x_1\\)は自ずと決まるので、\\(x_1\\)を使う。)\nそれぞれ\n\\[\nP(X_1+X_2=x_1+x_2)=\\frac{n!}{(x_1+x_2)!(n-x_1-x_2)!}(p_1+p_2)^{x_1+x_2}(1-p_1-p_2)^{n-x_1-x_2}\n\\]\n\\[\nP(X_2=x_2,X_1+X_2=x_1+x_2)=P(X_1=x_1,X_2=x_2)= \\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}\n\\]\n\\[\n\\begin{aligned}\n\\frac{P(X_2=x_2)}{P(X_1+X_2=x_1+x_2)}=\\frac{\\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_1-x_2}}{\\frac{n!}{(x_1+x_2)!(n-x_1-x_2)!}(p_1+p_2)^{x_1+x_2}(1-p_1-p_2)^{n-x_1-x_2}} \\\\\n=\\frac{(x_1+x_2)!}{x_1!x_2!} (\\frac{p_2}{p_1+p_2})^{x_2}(\\frac{p_1}{p_1+p_2})^{x_1}\n\\end{aligned}\n\\]\nよって条件付き分布は二項分布\\(Bin(z,\\frac{p_2}{p_1+p_2})\\) に従う。\nこれもサイコロで例えると、１の目が出た回数と2の目が出た回数が合計4回だと知っているとき、2の目が出る確率は試行回数4回で1/2の二項分布の確率になりそうですよね。"
  },
  {
    "objectID": "ukeru.html#問題概要-2",
    "href": "ukeru.html#問題概要-2",
    "title": "",
    "section": "問題概要",
    "text": "問題概要\n\\(X,Y\\) がそれぞれポアソン分布に従う。\n\n小問1\n\\(Z=X+Y\\) の分布を求めよ。\n\n\n小問2\n\\(X+Y=n\\)に固定した時、\\(X\\) の条件付き分布を求める。"
  },
  {
    "objectID": "ukeru.html#回答-2",
    "href": "ukeru.html#回答-2",
    "title": "",
    "section": "回答",
    "text": "回答\n\n小問1\n再生性からと言いたいところですが、誘導に乗ってみます。\n\\[\n\\]"
  },
  {
    "objectID": "solve.html",
    "href": "solve.html",
    "title": "Solve",
    "section": "",
    "text": "問題解く用。\n\nデータ解析のための数理統計入門\n1章\n2章(途中)\n3章(途中)\n4章(途中)"
  },
  {
    "objectID": "post/1.html",
    "href": "post/1.html",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "",
    "text": "\\(X \\sim Bin(n,p)\\) のとき、\\(E[X]=np\\) , \\(V[X]=np(1-p)\\) である。\n\n\n\\[\n\\begin{aligned}\nE[X] &= \\sum_{k=0}^{n} k P(X=k) \\\\\n&= \\sum_{k=0}^{n} k\n\\begin{pmatrix}\n   n \\\\\n   k\n\\end{pmatrix} p^k (1-p)^{n-k} \\\\\n&= \\sum_{k=0}^{n} k \\frac{n!}{k!(n-k)!} p^k (1-p)^{n-k} \\\\\n&= \\sum_{k=1}^{n} \\frac{n!}{(k-1)!(n-k)!} p^k (1-p)^{n-k} \\\\\n&= \\sum_{k=1}^{n} \\frac{n!(n-k+1)}{(k-1)!(n-(k-1))!} p^k (1-p)^{n-k} \\\\\n&= \\sum_{k'=0}^{n-1} \\frac{n!(n-k+1)}{(k')!(n-k')!} p^k (1-p)^{n-k} \\\\\n\\end{aligned}\n\\]\n\n\n\n同じ求め方で求めれると思われる。\nあとはベルヌーイ分布の和の分布でも求めれそう。\n確率母関数から求める方法もある。\n\\(G_X(s)=E[s^X]=(ps+1-p)^n\\), \\(M_X(t)=E[e^{tX}]=(pe^t+1-p)^n\\) から求める方法もある。\n\\(E[X]=\\frac{d}{ds} G_X(s)|_{s=1} = n(ps+1-p)^{n-1} p|_{s=1}=np\\)\n\\(E[X]=\\frac{d}{dt} M_X(t)|_{t=0} = n(pe^t+1-p)^{n-1} p|_{t=0}=np\\)\n\\(E[X(X-1)]= \\frac{d^2}{ds^2} G_X(s)|_{s=1} = \\frac{d}{ds} \\{n(ps+1-p)^{n-1} p\\}|_{s=1}= \\{n(n-1)(ps+1-p)^{n-2} p^2\\}|_{s=1}=n(n-1)p^2\\)\n\\(E[X^2]=\\frac{d^2}{dt^2} M_X(t)|_{t=0}= \\frac{d}{dt}\\{n(pe^t+1-p)^{n-1} p\\}|_{t=0}=n(n-1)(pe^t+1-p)^{n-2} p^2|_{t=0}=n(n-1)p^2\\)\n\\(V[X]=E[X^2]-(E[X])^2=n(n-1)p^2-(np)^2????\\)\n\\(V[X]=E[X^2]-(E[X])^2=E[X(X-1)]+E[X]-(E[X])^2=n(n-1)p^2+np-(np)^2=np(1-p)\\)"
  },
  {
    "objectID": "post/1.html#二項分布",
    "href": "post/1.html#二項分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "",
    "text": "\\(X \\sim Bin(n,p)\\) のとき、\\(E[X]=np\\) , \\(V[X]=np(1-p)\\) である。\n\n\n\\[\n\\begin{aligned}\nE[X] &= \\sum_{k=0}^{n} k P(X=k) \\\\\n&= \\sum_{k=0}^{n} k\n\\begin{pmatrix}\n   n \\\\\n   k\n\\end{pmatrix} p^k (1-p)^{n-k} \\\\\n&= \\sum_{k=0}^{n} k \\frac{n!}{k!(n-k)!} p^k (1-p)^{n-k} \\\\\n&= \\sum_{k=1}^{n} \\frac{n!}{(k-1)!(n-k)!} p^k (1-p)^{n-k} \\\\\n&= \\sum_{k=1}^{n} \\frac{n!(n-k+1)}{(k-1)!(n-(k-1))!} p^k (1-p)^{n-k} \\\\\n&= \\sum_{k'=0}^{n-1} \\frac{n!(n-k+1)}{(k')!(n-k')!} p^k (1-p)^{n-k} \\\\\n\\end{aligned}\n\\]\n\n\n\n同じ求め方で求めれると思われる。\nあとはベルヌーイ分布の和の分布でも求めれそう。\n確率母関数から求める方法もある。\n\\(G_X(s)=E[s^X]=(ps+1-p)^n\\), \\(M_X(t)=E[e^{tX}]=(pe^t+1-p)^n\\) から求める方法もある。\n\\(E[X]=\\frac{d}{ds} G_X(s)|_{s=1} = n(ps+1-p)^{n-1} p|_{s=1}=np\\)\n\\(E[X]=\\frac{d}{dt} M_X(t)|_{t=0} = n(pe^t+1-p)^{n-1} p|_{t=0}=np\\)\n\\(E[X(X-1)]= \\frac{d^2}{ds^2} G_X(s)|_{s=1} = \\frac{d}{ds} \\{n(ps+1-p)^{n-1} p\\}|_{s=1}= \\{n(n-1)(ps+1-p)^{n-2} p^2\\}|_{s=1}=n(n-1)p^2\\)\n\\(E[X^2]=\\frac{d^2}{dt^2} M_X(t)|_{t=0}= \\frac{d}{dt}\\{n(pe^t+1-p)^{n-1} p\\}|_{t=0}=n(n-1)(pe^t+1-p)^{n-2} p^2|_{t=0}=n(n-1)p^2\\)\n\\(V[X]=E[X^2]-(E[X])^2=n(n-1)p^2-(np)^2????\\)\n\\(V[X]=E[X^2]-(E[X])^2=E[X(X-1)]+E[X]-(E[X])^2=n(n-1)p^2+np-(np)^2=np(1-p)\\)"
  },
  {
    "objectID": "post/1.html#ベルヌーイ分布",
    "href": "post/1.html#ベルヌーイ分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "ベルヌーイ分布",
    "text": "ベルヌーイ分布\n\\(X \\sim Ber(p)\\) のとき、\\(E[X]=p\\) , \\(V[X]=p(1-p)\\) である。"
  },
  {
    "objectID": "post/1.html#幾何分布",
    "href": "post/1.html#幾何分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "幾何分布",
    "text": "幾何分布\n\\(X \\sim Geo(p)\\) のとき、\\(E[X]=\\frac{q}{p}\\) , \\(V[X]=\\frac{q}{p^2}\\) である。"
  },
  {
    "objectID": "post/1.html#ポアソン分布",
    "href": "post/1.html#ポアソン分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "ポアソン分布",
    "text": "ポアソン分布\n\\(X \\sim Po(\\lambda)\\) のとき、\\(E[X]=\\lambda\\) , \\(V[X]=\\lambda\\) である。\n\\(E[X]=\\sum_{k=0}^{\\infty}k \\frac{\\lambda^k}{k!} e^{-\\lambda}=\\sum_{k=1}^{\\infty} \\frac{\\lambda \\lambda^{k-1}}{(k-1)!} e^{-\\lambda}=\\sum_{k'=0}^{\\infty} \\frac{\\lambda \\lambda^{k'}}{(k')!} e^{-\\lambda}=\\lambda  \\sum_{k'=0}^{\\infty} \\frac{\\lambda^{k'}}{(k')!} e^{-\\lambda}=\\lambda\\)\n\\(E[X(X-1)]=\\sum_{k=0}^{\\infty}k(k-1) \\frac{\\lambda^k}{k!} e^{-\\lambda}=\\sum_{k=2}^{\\infty} \\frac{\\lambda^2 \\lambda^{k-2}}{(k-2)!} e^{-\\lambda}=\\sum_{k'=0}^{\\infty} \\frac{\\lambda^2 \\lambda^{k'}}{(k')!} e^{-\\lambda}=\\lambda^2  \\sum_{k'=0}^{\\infty} \\frac{\\lambda^{k'}}{(k')!} e^{-\\lambda}=\\lambda^2\\)\n\\(V[X]=E[X^2]-\\{E[X]\\}^2=E[X(X-1)]+E[X]-\\{E[X]\\}^2= \\lambda^2 + \\lambda - \\lambda^2 =\\lambda\\)\n確率母関数、積率母関数からも求めれそうです。\nポアソン分布の確率母関数\\(G_X(s)=\\exp\\{s\\lambda-\\lambda\\}\\),積率母関数は\\(M_X(t)=\\exp\\{e^t\\lambda-\\lambda\\}\\)である。\n\\(E[X]=\\frac{d}{ds}G_X(s)|_{s=1}= \\{\\lambda \\exp\\{s\\lambda-\\lambda\\}\\}|_{s=1} = \\lambda\\)\n\\(E[X]=\\frac{d}{dt}M_X(t)|_{t=0}= e^t\\lambda \\exp\\{e^t\\lambda-\\lambda\\}|_{t=0} = \\lambda\\)\n\\(E[X(X-1)]=\\frac{d^2}{ds^2}G_X(s)|_{s=1}= \\frac{d}{ds}\\{\\lambda \\exp\\{s\\lambda-\\lambda\\}\\}|_{s=1} =\\{\\lambda^2 \\exp\\{s\\lambda-\\lambda\\}\\}|_{s=1} = \\lambda^2\\)\n\\(E[X^2]=\\frac{d^2}{dt^2}M_X(t)|_{t=0}= \\frac{d}{dt} \\{e^t\\lambda \\exp\\{e^t\\lambda-\\lambda\\}\\}|_{t=0}\\)"
  },
  {
    "objectID": "post/1.html#離散一様分布",
    "href": "post/1.html#離散一様分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "離散一様分布",
    "text": "離散一様分布\n\\(f(x)=\\frac{1}{N}\\) より、\\(E[X]=\\frac{N+1}{2}\\)、\\(V[X]=\\frac{N^2-1}{12}\\)\n\n\\(E[X]=\\frac{N+1}{2}\\) の求め方\n\\[\nE[X]=\\sum_{k=1}^{N} k \\frac{1}{N} = \\frac{1}{N} \\sum_{k=1}^{N} k =  \\frac{1}{N} \\frac{N(N+1)}{2} = \\frac{N+1}{2}\n\\]\n\n\n\\(V[X]=\\frac{N^2-1}{12}\\) の求め方\n\\[\nE[X^2]=\\sum_{k=1}^{N} k^2 \\frac{1}{N} = \\frac{1}{N} \\sum_{k=1}^{N} k^2 =  \\frac{1}{N} \\frac{N(N+1)(2N+1)}{6} = \\frac{(N+1)(2N+1)}{6}\n\\]\n\\[\nV[X]=E[X^2]-(E[X])^2 = \\frac{(N+1)(2N+1)}{6} - \\frac{(N+1)^2}{4} =\\frac{4N+2-3N-3}{12} = \\frac{(N+1)(N-1)}{12}\n\\]"
  },
  {
    "objectID": "post/1.html#ガンマ分布",
    "href": "post/1.html#ガンマ分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "ガンマ分布",
    "text": "ガンマ分布\n\\(X \\sim Ga(\\alpha, \\beta)\\) のとき、\\(E[X]=\\alpha\\beta\\), \\(V[X]=\\alpha\\beta^2\\)\n\n\\(E[X]=\\alpha\\beta\\) の求め方\n\\[\n\\begin{aligned}\nE[X]&=\\int_{0}^{\\infty} x \\frac{x^{\\alpha-1}e^{-\\frac{x}{\\beta}}}{\\Gamma(\\alpha)\\beta^{\\alpha}} dx \\\\\n&=\\int_{0}^{\\infty} \\frac{x^{(\\alpha+1)-1}e^{-\\frac{x}{\\beta}}}{\\Gamma(\\alpha)\\beta^{\\alpha}} dx \\\\\n&=\\int_{0}^{\\infty} \\frac{x^{(\\alpha+1)-1}e^{-\\frac{x}{\\beta}}}{\\frac{1}{\\alpha}\\Gamma(\\alpha+1)\\frac{1}{\\beta}\\beta^{\\alpha+1}} dx \\\\\n&= \\alpha\\beta\n\\end{aligned}\n\\]\n\n\n\\(V[X]=\\alpha\\beta^2\\) の求め方\n\\[\n\\begin{aligned}\nE[X^2]&=\\int_{0}^{\\infty} x^2 \\frac{x^{\\alpha-1}e^{-\\frac{x}{\\beta}}}{\\Gamma(\\alpha)\\beta^{\\alpha}} dx \\\\\n&=\\int_{0}^{\\infty} \\frac{x^{(\\alpha+2)-1}e^{-\\frac{x}{\\beta}}}{\\Gamma(\\alpha)\\beta^{\\alpha}} dx \\\\\n&=\\int_{0}^{\\infty} \\frac{x^{(\\alpha+2)-1}e^{-\\frac{x}{\\beta}}}{\\frac{1}{\\alpha(\\alpha+1)}\\Gamma(\\alpha+2)\\frac{1}{\\beta^2}\\beta^{\\alpha+2}} dx \\\\\n&= \\alpha(\\alpha+1)\\beta^2\n\\end{aligned}\n\\]\n\\[\nV[X]=E[X^2]-(E[X])^2 = \\alpha(\\alpha+1)\\beta^2 -\\alpha^2 \\beta^2 = \\alpha\\beta^2\n\\]"
  },
  {
    "objectID": "post/1.html#ベータ分布",
    "href": "post/1.html#ベータ分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "ベータ分布",
    "text": "ベータ分布\n\\(X \\sim B(a,b)\\) のとき、\\(E[X]=\\frac{a}{a+b}\\)、\\(V[X]=\\frac{ab}{(a+b)^2(a+b+1)}\\)\n\n\\(E[X]=\\frac{a}{a+b}\\) の求め方\n\\[\n\\begin{aligned}\nE[X]&=\\int_{0}^1 x \\frac{x^{a-1}(1-x)^{b-1}}{B(a,b)} dx  \\\\\n&=\\int_{0}^1 x \\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)}x^{a-1}(1-x)^{b-1} dx \\\\\n&=\\int_{0}^1  \\frac{\\Gamma(a+b)}{\\Gamma(a+1+b)}\\frac{\\Gamma(a+1)}{\\Gamma(a)}\\frac{\\Gamma(a+1+b)}{\\Gamma(a+1)\\Gamma(b)}x^{a+1-1}(1-x)^{b-1} dx \\\\\n&=\\frac{\\Gamma(a+b)}{(a+b)\\Gamma(a+b)}\\frac{a\\Gamma(a)}{\\Gamma(a)} \\int_{0}^1  \\frac{\\Gamma(a+1+b)}{\\Gamma(a+1)\\Gamma(b)}x^{a+1-1}(1-x)^{b-1} dx \\\\\n&= \\frac{a}{a+b}\n\\end{aligned}\n\\]\n\n\n\\(V[X]=\\frac{ab}{(a+b)^2(a+b+1)}\\) の求め方\n\\[\n\\begin{aligned}\nE[X^2]&=\\int_{0}^1 x^2 \\frac{x^{a-1}(1-x)^{b-1}}{B(a,b)} dx  \\\\\n&=\\int_{0}^1 x^2 \\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)}x^{a-1}(1-x)^{b-1} dx \\\\\n&=\\int_{0}^1  \\frac{\\Gamma(a+b)}{\\Gamma(a+2+b)}\\frac{\\Gamma(a+2)}{\\Gamma(a)}\\frac{\\Gamma(a+2+b)}{\\Gamma(a+2)\\Gamma(b)}x^{a+2-1}(1-x)^{b-1} dx \\\\\n&=\\frac{\\Gamma(a+b)}{(a+b+1)(a+b)\\Gamma(a+b)}\\frac{a(a+1)\\Gamma(a)}{\\Gamma(a)} \\int_{0}^1  \\frac{\\Gamma(a+1+b)}{\\Gamma(a+1)\\Gamma(b)}x^{a+1-1}(1-x)^{b-1} dx \\\\\n&= \\frac{a(a+1)}{(a+b+1)(a+b)}\n\\end{aligned}\n\\]\n\\[\nV[X]=E[X^2]-(E[X])^2 =\\frac{a(a+1)}{(a+b+1)(a+b)} -\\frac{a^2}{(a+b)^2} = \\frac{a(a+1)(a+b)-a^2(a+b+1)}{(a+b+1)(a+b)^2} = \\frac{ab}{(a+b)^2(a+b+1)}\n\\]"
  },
  {
    "objectID": "post/1.html#標準正規分布",
    "href": "post/1.html#標準正規分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "標準正規分布",
    "text": "標準正規分布\n\\(X \\sim N(0, 1)\\) のとき\\(E[X]=0\\),\\(V[X]=1\\) である。"
  },
  {
    "objectID": "post/1.html#正規分布",
    "href": "post/1.html#正規分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "正規分布",
    "text": "正規分布\n\\(X \\sim N(\\mu, \\sigma^2)\\) のとき\\(E[X]=\\mu\\),\\(V[X]=\\sigma^2\\) である。\n\n\\(E[X]=\\mu\\) の求め方\n\\[\n\\begin{aligned}\nE[X] = \\int^{\\infty}_{-\\infty} x \\frac{1}{\\sqrt{2 \\pi \\sigma^2}} \\exp{(\\frac{-(x-\\mu)^2}{2 \\sigma^2})}\n\\end{aligned}\n\\]\n標準正規分布から変換する方法も簡単そう。"
  },
  {
    "objectID": "post/1.html#指数分布",
    "href": "post/1.html#指数分布",
    "title": "各確率分布の期待値・分散の求め方(制作途中)",
    "section": "指数分布",
    "text": "指数分布\n\\(X \\sim Ex(\\lambda)\\)のとき\\(E[X]=\\frac{1}{\\lambda}\\),\\(V[X]=\\frac{1}{\\lambda^2}\\) である。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html",
    "href": "solve/data_math1_quest/index.html",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "",
    "text": "大学生の就職活動に関して、ある企業にエントリーした学生は男性が60%を占めていたが、採用を内定された割合は、男性は男性応募者の40%、女性は女性応募者の30%であった。\n\n\n\n⑴この企業の男女合わせた全体の応募者に対する男性の採用内定率、女性の採用内定率を求めよ。\n⑵この企業の男女合わせた全体の採用内定率を求めよ。\n⑶この企業の採用内定者の名簿から一人をランダムに選んだ場合、それが女性である確率を求めよ。\n\n\n\n\n\n\n\n\nある企業にエントリーした学生全体を\\(\\Omega\\)とし、男性である事象を\\(A\\)とする。また男性である確率は\\(P(A)\\)と表します。\nこの場合女性である事象は\\(A^c\\)で表され、女性である確率は\\(P(A)\\)となります。\n男性の割合は60%なので、\\(P(A)=0.6\\)である。 女性の割合は、\\(P(A^c)=1-0.6=0.4\\)である。\n\n\n\nまた採用される事象は\\(B\\)と表し、採用されない事象は\\(B^c\\)となります。\n男性は男性応募者の40%、女性は女性応募者の30%が採用内定である。これは条件付き確率で表される。40%とは、男性である条件のもとで採用した確率なので、\\(P(B|A)=0.4\\)。同様に、\\(P(B|A^c)=0.3\\)\n\n\n\n⑴で聞かれているのは、男性の採用内定率つまり\\(P(A \\cap B)\\)と、女性の採用内定率つまり\\(P(A^c \\cap B)\\)である。\n\n\n\n\\(P(A \\cap B)=P(B|A) \\times P(A) = 0.4 \\times  0.6 = 0.24\\)\n\\(P(A^c \\cap B)=P(B|A^c) \\times P(A^c) = 0.3 \\times  0.4 = 0.12\\)\n\n\n\n\n\n\n⑵で聞かれているのは、全体の採用内定率つまり\\(P(B)\\)である。\n\\(A+A^c=\\Omega\\)で、\\(A\\)と\\(A^c\\)は排反より、全確率の公式を用いると、以下の式が成り立つ。\n\\(P(B) = P(B|A) \\times P(A) + P(B|A^c) \\times P(A^c) = 0.24+0.12=0.36\\)\n\n\n\n\n\n\n⑶は条件付き確率の問題で、採用内定者のもとで女性である確率つまり\\(P(A^c|B)\\)である。\n\\(P(A^c|B)=\\frac{P(A^c \\cap B)}{P(B)}= \\frac{0.12}{0.36} =\\frac{1}{3}\\)"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目",
    "href": "solve/data_math1_quest/index.html#問目",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "",
    "text": "大学生の就職活動に関して、ある企業にエントリーした学生は男性が60%を占めていたが、採用を内定された割合は、男性は男性応募者の40%、女性は女性応募者の30%であった。\n\n\n\n⑴この企業の男女合わせた全体の応募者に対する男性の採用内定率、女性の採用内定率を求めよ。\n⑵この企業の男女合わせた全体の採用内定率を求めよ。\n⑶この企業の採用内定者の名簿から一人をランダムに選んだ場合、それが女性である確率を求めよ。\n\n\n\n\n\n\n\n\nある企業にエントリーした学生全体を\\(\\Omega\\)とし、男性である事象を\\(A\\)とする。また男性である確率は\\(P(A)\\)と表します。\nこの場合女性である事象は\\(A^c\\)で表され、女性である確率は\\(P(A)\\)となります。\n男性の割合は60%なので、\\(P(A)=0.6\\)である。 女性の割合は、\\(P(A^c)=1-0.6=0.4\\)である。\n\n\n\nまた採用される事象は\\(B\\)と表し、採用されない事象は\\(B^c\\)となります。\n男性は男性応募者の40%、女性は女性応募者の30%が採用内定である。これは条件付き確率で表される。40%とは、男性である条件のもとで採用した確率なので、\\(P(B|A)=0.4\\)。同様に、\\(P(B|A^c)=0.3\\)\n\n\n\n⑴で聞かれているのは、男性の採用内定率つまり\\(P(A \\cap B)\\)と、女性の採用内定率つまり\\(P(A^c \\cap B)\\)である。\n\n\n\n\\(P(A \\cap B)=P(B|A) \\times P(A) = 0.4 \\times  0.6 = 0.24\\)\n\\(P(A^c \\cap B)=P(B|A^c) \\times P(A^c) = 0.3 \\times  0.4 = 0.12\\)\n\n\n\n\n\n\n⑵で聞かれているのは、全体の採用内定率つまり\\(P(B)\\)である。\n\\(A+A^c=\\Omega\\)で、\\(A\\)と\\(A^c\\)は排反より、全確率の公式を用いると、以下の式が成り立つ。\n\\(P(B) = P(B|A) \\times P(A) + P(B|A^c) \\times P(A^c) = 0.24+0.12=0.36\\)\n\n\n\n\n\n\n⑶は条件付き確率の問題で、採用内定者のもとで女性である確率つまり\\(P(A^c|B)\\)である。\n\\(P(A^c|B)=\\frac{P(A^c \\cap B)}{P(B)}= \\frac{0.12}{0.36} =\\frac{1}{3}\\)"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-1",
    "href": "solve/data_math1_quest/index.html#問目-1",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "2問目",
    "text": "2問目\n\n問題\n週の天気予報によると、土曜日に雨の降る確率は25%、日曜日に雨の降る確率も25%である。 週末の土日のどこかに雨が降る確率は25+25=50%になると考えた。これは正しいかどうか。\n\n\n解答\n正しくない。\n土曜日に雨が降る事象を\\(A\\)とし、確率は\\(P(A)\\)で表される。\n日曜日に雨が降る事象を\\(B\\)とし、確率は\\(P(B)\\)で表される。\n\n\n\nこの問題が言っていることは\\(P(A \\cup B) = P(A)+P(B)\\)になるということである。しかし、これが成り立つのは、\\(A\\)と\\(B\\)が排反の時である。\n事象\\(A\\)と\\(B\\)はどう考えても排反ではないので、成り立たない。\n\n\n\n\n\n\nノート\n\n\n\n事象\\(A\\)と\\(B\\)が排反とは、\\(A\\)と\\(B\\)が同時に起こり得ないということです。\n\n\n\\(P(A \\cup B) = P(A)+P(B)-P(A \\cap B)\\)なので、確率は50%より低くなることが考えられる。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-2",
    "href": "solve/data_math1_quest/index.html#問目-2",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "3問目",
    "text": "3問目\n\n問題\nある大学のある学部はA学科とB学科の２つからなり、それぞれの志願者数と合格率が男女別に次の表で与えられたとする。学部全体の男女の合格率に関して、シンプソンのパラドクスが生ずるような\\(a\\)の条件を考えよ。\n\n\n\n\n\n\n\n\n\nA 学科\n志願者\n合格率\n\n\n\n\n男性\n500\n60%\n\n\n女性\n30\n70%\n\n\n\n\n\n\n\n\nB 学科\n志願者\n合格率\n\n\n\n\n男性\n400\n10%\n\n\n女性\n300\na%\n\n\n\n\n\n\n\n\n解答\nA学科を見ると女性の方が合格率が高い。\n男女の合格率に関してシンプソンのパラドクスが生じるようにという問題です。つまり、B学科もA学科同様に学科単体では女性の合格率が高いが、A学科とB学科を合計すると男性の合格率のほうが高くなるような\\(a\\)を求める問題です。\n\n\n\nまず、学科単体では女性の合格率が高くなるので、\\(a&gt;10\\)です。\n\n\n\n次に、男女別の学科合計の合格率を考えます。\n男性の合格率\n\\(\\frac{500 \\times 0.6 + 400 \\times 0.1}{500+400}=\\frac{340}{900}\\)\n女性の合格率\n\\(\\frac{30 \\times 0.7 + 300 \\times a/100}{500+400} = \\frac{21+3a}{330}\\)\n男性の合格率&gt;女性の合格率となればいいので、以下の式が成り立ちます。\n\\(\\frac{340}{900}&gt;\\frac{21+3a}{330}\\)\n\\(a &lt; \\frac{340}{900} \\times 110 -7\\fallingdotseq 34.6\\)\nよって\\(a\\)の条件とは \\(10&lt;a&lt;34.6\\) である。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-3",
    "href": "solve/data_math1_quest/index.html#問目-3",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "4問目",
    "text": "4問目\n\n問題\n両親と二人の子供がいる4人家族において、同じ誕生日の人がいる確率を求めよ。\n\n\n解答\n誕生日問題は補集合で考えるとわかりやすい。\n同じ誕生日の人がいない事象を\\(A\\)とすると、求めたい事象は\\(A^c\\)であり、求めたい確率は\\(P(A^c)\\)である。\n\\(P(A)=\\frac{365}{365} \\cdot \\frac{364}{365} \\cdot \\frac{363}{365} \\cdot \\frac{362}{365} = \\frac{364\\cdot 363\\cdot 362}{365^3}\\)\n\\(P(A^c)=1-P(A)=1-\\frac{364\\cdot 363\\cdot 362}{365^3} = 0.016\\)\nよって約1.6%である。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-4",
    "href": "solve/data_math1_quest/index.html#問目-4",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "5問目",
    "text": "5問目\nここに書いてあるので、省略します。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-5",
    "href": "solve/data_math1_quest/index.html#問目-5",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "6問目",
    "text": "6問目\n\n問題\n条件付き確率について不等式\\(P(A|D) \\geq P(B|D)\\),\\(P(A|D^c) \\geq P(B|D^c)\\)が成り立つならば、\\(P(A) \\geq P(B)\\)であることを示せ。\n\n\n解答\n\\(P(A|D^c)\\)のような補集合の条件付き確率が出てきていることから、全確率の公式を用いることが推察できます。\n\\(P(A|D)P(D) + P(A|D^c)P(D^c) =P(A)\\)\n\\(P(B|D)P(D) + P(B|D^c)P(D^c) =P(B)\\)\nこの２つを用いれば解くことができそうですね。\n\n\n\n\\(P(A|D) \\geq P(B|D)\\)の両辺に\\(P(D)\\)をかけても不等式は成り立ちます。\n\\(P(A|D)P(D) \\geq P(B|D)P(D)\\)\n\\(P(A|D^c) \\geq P(B|D^c)\\)の両辺に\\(P(D^c)\\)をかけても不等式は成り立ちます。\n\\(P(A|D^c)P(D^c) \\geq P(B|D^c)P(D^c)\\)\n不等式同士を辺々足しても大小関係は変わらないため、以下の式が成り立つ。\n\\(P(A|D)P(D)+P(A|D^c)P(D^c) \\geq P(B|D)P(D)+ P(B|D^c)P(D^c)\\)\n全確率の公式より\n\\(P(A) \\geq P(B)\\)である。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-6",
    "href": "solve/data_math1_quest/index.html#問目-6",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "7問目",
    "text": "7問目\n\n問題\n次の多項式の係数を求めよ。\n⑴\\((x+y)^6\\)における\\(x^3y^3\\)の係数\n⑵\\((x+y+z)^6\\)における\\(x^2y^2z^2\\)の係数\n\n\n解答\n⑴\n\\(\\begin{pmatrix}\n6 \\\\\n3\n\\end{pmatrix} =\\frac{6!}{3!3!}=20\\)\n⑵\n\\(\\begin{pmatrix}\n& 6 & \\\\\n2 & 2 & 2\n\\end{pmatrix} =\\frac{6!}{2!2!2!}=90\\)"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-7",
    "href": "solve/data_math1_quest/index.html#問目-7",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "8問目",
    "text": "8問目\n\n問題\n正しいコインを３回投げる時次の確率を求めよ\n⑴少なくとも１回は表が出るという条件のもとで２回以上表の出る確率\n⑵少なくとも１回は裏が出るという条件のもとで２回以上表の出る確率\n\n\n解答\n正しいコインの意味はおそらく裏表が1/2の確率になるという意味だと思います。\n⑴\n条件付き確率ですね。\n少なくとも１回は表が出るという事象を\\(A\\)として、2回以上表が出る事象を\\(B\\)とする。\n求めるのは\\(P(B|A)\\)である。\n\n\n\n\\(P(B|A)=\\frac{P(A \\cap B)}{P(A)}\\)となるので、それぞれの確率を求めれば良い。\n\n\n\n\\(P(A)\\)は余事象ですぐ求めることができる。\n\\(P(A)=1-P(A^c)=1-(\\frac{1}{2})^3=\\frac{7}{8}\\)\n\n\n\n\\(P(A \\cap B)\\) は\\(B \\subset A\\)より\\(P(A \\cap B)=P(B)\\)である。 また、表が２回出る確率は\\({}_3 C_1(\\frac{1}{2})^3\\)です。\n\\(P(A \\cap B)=P(B)=\\frac{1}{8}+\\frac{3}{8}=\\frac{1}{2}\\)\n\n\n\nよって、\n\\(P(B|A)=\\frac{P(A \\cap B)}{P(A)}= \\frac{P(1/2)}{7/8}=\\frac{4}{7}\\)\n⑵\n⑴と同様に求めます。\n少なくとも１回は裏が出るという事象を\\(A\\)として、2回以上表が出る事象を\\(B\\)とする。\n\\(P(A)=1-P(A^c)=1-(\\frac{1}{2})^3=\\frac{7}{8}\\)\n少なくとも１回は裏が出るかつ２回以上表が出る事象は、表が２回（裏が１回）の事象のみである。\n\\(P(A \\cap B)={}_3 C_1(\\frac{1}{2})^3=\\frac{3}{8}\\)\nよって、\n\\(P(B|A)=\\frac{P(A \\cap B)}{P(A)}= \\frac{P(3/8)}{7/8}=\\frac{3}{7}\\)"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-8",
    "href": "solve/data_math1_quest/index.html#問目-8",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "9問目",
    "text": "9問目\n\n問題\n2人の子供がいる夫婦について、第一子が女の子であるという条件のもとで二人とも女の子であるという確率を求めよ。また子供の一人が女子であるという条件のもとで二人とも女子である確率を求めよ。\n\n\n解答\nこれも条件付き確率の問題と考えることができます。\n1つ目について。\nA：第一子が女の子である\nB：二人とも女の子である\n一つ目で求められているのは\\(P(B|A)\\)である。\n\\(P(A)=1/2\\)\n\\(P(A \\cap B)=1/2 \\times 1/2 =1/4\\)\n\\(P(B|A)= \\frac{1/4}{1/2} = 1/2\\)\n2つ目について。\nC：子供の一人が女子である\nD：二人とも女子である\n\\(P(C)=1- (\\frac{1}{2})^2 = 3/4\\)\n\\(P(D \\cap C)=1/4\\)\n\\(P(D|C)= \\frac{1/4}{3/4} = 1/3\\)"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-9",
    "href": "solve/data_math1_quest/index.html#問目-9",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "10問目",
    "text": "10問目\n\n問題\n独立性に関して次の問いに答えよ\n⑴\\(A\\)と\\(B\\)が独立ならば、\\(A\\)と\\(B^c\\)も独立になり、\\(A^c\\)と\\(B^c\\)も独立になるか。\n⑵\\(A\\)と\\(B\\)が独立で、\\(B\\)と\\(C\\)が独立であるとき、\\(A\\)と\\(C\\)は独立になるか。\n⑶\\(A\\)と\\(B\\)が排反であれば常に\\(A\\)と\\(B\\)は独立であるか。\n⑷\\(A \\subset B\\)であるとき、\\(A\\)と\\(B\\)は独立になるか。\n\n\n解答\n\n\n\n\n\n\nノート\n\n\n\n\\(A\\)と\\(B\\)が独立であるとは、\\(P(A \\cap B)=P(A) \\cdot P(B)\\)であること。\n\n\n\nこの式は条件付き確率からわかる。\n\\[\nP(A | B)=\\frac{P(A \\cap B)}{P(B)}\n\\]\n式を移行すると、\n\\[\nP(A \\cap B)=P(A | B) \\cdot P(B)\n\\]\nこの\\(B\\)という事象の元で\\(A\\)という事象が起こる確率が\\(B\\)に依存しない時、\\(P(A | B)=P(A)\\)となる。\n\n\n⑴\n\\(A\\)と\\(B\\)が独立であるとは、\\(P(A \\cap B)=P(A) \\cdot P(B)\\)であることである。\n\n\n\n\\(A\\)と\\(B^c\\)が独立であることを示したいときは\\(P(A \\cap B^c)=P(A) \\cdot P(B^c)\\)を示せば良い。\nまた\\(P(A \\cap B)=P(A) \\cdot P(B)\\)という条件があるので、\\(A \\cap B\\)の形を出せると使えそうなことがわかる。\n\\[\\begin{align}\nP(A \\cap B^c)&=P(A)-P(A\\cap B) \\\\\n&=P(A)-P(A)\\cdot P(B)\\\\\n&=P(A)\\cdot(1-P(B))\\\\\n&=P(A)\\cdot P(B^c)\n\\end{align}\\]\nこれで\\(P(A \\cap B^c)=P(A) \\cdot P(B^c)\\)が示せたので、\\(A\\)と\\(B\\)が独立なとき、\\(A\\)と\\(B^c\\)が独立であることを示せた。\n⑵\n\\(P(A \\cap B)=P(A) \\cdot P(B)\\)\n\\(P(B \\cap C)=P(B) \\cdot P(C)\\)\nこの２つから\\(P(A \\cap C)=P(A) \\cdot P(C)\\)を求めることができれば、独立が成り立つと言えそうだが、明らかに言えなそうなので反例を探していく。\n例えば、\\(P(B)=0\\)の時を考える。上２式は\\(B\\)の事象が \\(\\emptyset\\)より0の等式が成り立つ。\n\\(P(A \\cap C)=P(A) \\cdot P(C)\\)の式は上2式で定まらないので、単独で考えると、独立でない時もあるので成り立たない。\n⑶\n\n\n\n\n\n\nノート\n\n\n\n\\(A\\)と\\(B\\)が排反であるとは、\\(A\\cap B = \\emptyset\\)であるということ。\n\n\n\\[\nP(A \\cap B)=P(\\emptyset) =0\n\\]\nである。\\(P(A)\\)と\\(P(B)\\)は1/3と1/3とかもあり得るので、\\(P(A)\\cdot P(B)\\)は常に0ではない。\nよって、常に独立にはならない。\n⑷\n\\[\nP(A \\cap B)=P(A) \\ne P(A) \\cdot P(B)\n\\]\nよって常に独立にはならない。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-10",
    "href": "solve/data_math1_quest/index.html#問目-10",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "11問目",
    "text": "11問目\n\n問題\nベイズの定理により事前確率は事後確率の取り方に依存する。 例1.6のウイルス検査において、発熱という症状が出ている患者群を母集団として考えた場合、ウイルスに感染している確率が高くなるので事前確率は高くなる。 例えば、発熱している患者の半数が感染していて、半数が感染していないという設定では事前確率が\\(P(A_1)=0.5\\)、\\(P(A_2)=0.5\\)となる。 このとき陽性反応が出たという条件のもとで、感染している確率はどうなるか。\n\n\n解答\n感染している割合が0.1から0.5に上がった時（母集団を変えた時）にどうなるかということです。\n\\[\nP(A_1)=0.5\n\\]\n\\[\nP(A_2)=0.5\n\\]\n以下の条件は変わらない。\n\\[\\begin{align}\nP(B_1|A_1)=0.9\nP(B_2|A_1)=0.1\nP(B_1|A_2)=0.01\nP(B_1|A_2)=0.99\n\\end{align}\\]\n陽性反応が出たという条件のもとで、感染している確率\\(P(A_1|B_1)\\)を求める。\n\\[\\begin{align}\nP(A_1|B_1)&=\\frac{P(A_1 \\cap B_1)}{P(B_1)} \\\\\n&=\\frac{P(B_1|A_1)\\cdot P(A_1)}{P(B_1|A_1)\\cdot P(A_1)+P(B_1|A_2)\\cdot P(A_2)}\\\\\n&=\\frac{0.9 \\cdot 0.5}{0.9 \\cdot 0.5 + 0.01 \\cdot 0.5}\\\\\n&=\\frac{0.45}{0.455}\\\\\n&=0.989\n\\end{align}\\]\n確率結構上がりましたね。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-11",
    "href": "solve/data_math1_quest/index.html#問目-11",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "12問目",
    "text": "12問目\n\n問題\n正しいコインを２回投げる時、１回目に表が出る事象を\\(A\\)、２回目に表の出る事象を\\(B\\)、２回のうちに１回だけ表の出る事象を\\(C\\)とする。\n⑴\\(A,B,C\\)はペアワイズ独立であることを示せ。\n⑵\\(A,B,C\\)は互いに独立でないことを示せ。\n\n\n解答\n\n\n\n\n\n\nノート\n\n\n\n\\(A,B,C\\)はペアワイズ独立であるとは、\\(P(A\\cap B)=P(A) \\cdot P(B)\\)かつ\\(P(B\\cap C)=P(B) \\cdot P(C)\\)かつ\\(P(A\\cap C)=P(A) \\cdot P(C)\\)が成り立つこと。\n\n\n⑴\n正しいコインを投げる時表が出る事象を\\(H\\),裏が出る事象を\\(T\\)とする。\nすると２回投げる時,\\(\\{HH,HT,TH,TT\\}\\)の４パターンになる。\n\\[\\begin{align}\nA=\\{HH,HT\\} ,P(A)=1/2\\\\\nB=\\{HH,TH\\},P(B)=1/2 \\\\\nC=\\{HT,TH\\} ,P(C)=1/2\\\\\n\\end{align}\\]\n\\[\\begin{align}\nA \\cap B=\\{HH\\} ,P(A \\cap B)=1/4\\\\\nB \\cap C=\\{TH\\},P(A \\cap B)=1/4 \\\\\nA \\cap C=\\{HT\\} ,P(A \\cap B)=1/4\\\\\n\\end{align}\\]\n\\(P(A\\cap B)=P(A) \\cdot P(B)\\)かつ\\(P(B\\cap C)=P(B) \\cdot P(C)\\)かつ\\(P(A\\cap C)=P(A) \\cdot P(C)\\)が成り立つので、ペアワイズ独立である。\n⑵\n\n\n\n\n\n\nノート\n\n\n\n三つの事象が互いに独立であるとは、\n\\[\\begin{align}\nP(A\\cap B)=P(A) \\cdot P(B) \\\\\nP(B\\cap C)=P(B) \\cdot P(C)\\\\\nP(A\\cap C)=P(A) \\cdot P(C)\\\\\nP(A\\cap B \\cap C)=P(A)\\cdot P(B) \\cdot P(C)\\\\\n\\end{align}\\]\nすべてが成り立つことである。\n\n\n\\[\nA \\cap B \\cap C= \\emptyset,P(A \\cap B\\cap C)=0\n\\]\n\\(P(A)\\cdot P(B) \\cdot P(C)=1/8\\)より\\(P(A\\cap B \\cap C)=P(A)\\cdot P(B) \\cdot P(C)\\)が成り立たないため、\\(A,B,C\\)は互いに独立ではない。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-12",
    "href": "solve/data_math1_quest/index.html#問目-12",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "13問目",
    "text": "13問目\n\n問題\nモンティ・ホール問題を説明せよ。\n\n\n解答\n後でシミュレーションとか作って丁寧にやります。"
  },
  {
    "objectID": "solve/data_math1_quest/index.html#問目-13",
    "href": "solve/data_math1_quest/index.html#問目-13",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "14問目",
    "text": "14問目\n\n問題\n２項係数の関係式を示し、これを用いて２項定理を証明せよ。 また、パスカルの３角形が成り立つことを証明せよ。\n\n\n解答\n一つ目は\n\\[\n\\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right)\n=\n\\left(\n\\begin{matrix}\nn-1 \\\\\nk-1\n\\end{matrix}\n\\right) +\n\\left(\n\\begin{matrix}\nn-1 \\\\\nk\n\\end{matrix}\n\\right)\n\\]\n\\[\\begin{align}\n\\left(\n\\begin{matrix}\nn-1 \\\\\nk-1\n\\end{matrix}\n\\right)\n+\\left(\n\\begin{matrix}\nn-1 \\\\\nk\n\\end{matrix}\n\\right) &=\\frac{(n-1)!}{(k-1)!(n-1-(k-1))!}+\\frac{(n-1)!}{k!(n-1-k)!} \\\\\n&= \\frac{(n-1)! \\cdot k}{(k)!(n-k)!}+\\frac{(n-1)! \\cdot (n-k)}{k!(n-k)!} \\\\\n&=\\frac{(n-1)! \\cdot (k+n-k)}{(k)!(n-k)!} \\\\\n&=\\frac{(n)!}{(k)!(n-k)!} \\\\\n&=\\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right)\n\n\n\\end{align}\\]\n二つ目は\n\\[\n(a+b)^n = \\sum_{k=0}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^k b^{n-k}\n\\tag{1}\\]\nこの二項定理が成り立つことを示せということです。\n感覚的に(a+b)がたくさんある中で\\(a^kb^{n-k}\\)の組み合わせは何個だからみたいな方法もわかりやすくていいと思うんですが、帰納法で示します。\n\\(n=1\\)のとき、\n\\[\na+b=\\sum_{k=0}^1 \\left(\n\\begin{matrix}\n1 \\\\\nk\n\\end{matrix}\n\\right) a^k b^{1-k}\n=\\left(\n\\begin{matrix}\n1 \\\\\n0\n\\end{matrix}\n\\right) a^0 b^{1}+\\left(\n\\begin{matrix}\n1 \\\\\n1\n\\end{matrix}\n\\right) a^1 b^{0}\n=a+b\n\\]\nよって\\(n=1\\)の時成り立つ。\n\\(n=k\\)のとき 式 1 が成り立つと仮定する。\n\\(n=k+1\\)のとき\n\\[\\begin{align}\n(a+b)^{k+1} &= (a+b)\\sum_{k=0}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^k b^{n-k}\\\\\n&=  \\sum_{k=0}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k+1} b^{n-k}\n+\\sum_{k=0}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k} b^{n-k+1}\n\\\\\n\n\n\n&=a^{n+1} +\\sum_{k=0}^{n-1} \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k+1} b^{n-k}\n+\\sum_{k=1}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n\n\n&=a^{n+1} +\\sum_{k=1}^{n} \\left(\n\\begin{matrix}\nn \\\\\nk-1\n\\end{matrix}\n\\right) a^{k} b^{n-k+1}\n+\\sum_{k=1}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n\n\n&=a^{n+1} +\\sum_{k=1}^{n} (\\left(\n\\begin{matrix}\nn \\\\\nk-1\n\\end{matrix}\n\\right)+\\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right)) a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n&=a^{n+1} +\\sum_{k=1}^{n} \\left(\n\\begin{matrix}\nn+1 \\\\\nk\n\\end{matrix}\n\\right)a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n&=\\sum_{k=1}^{n+1} \\left(\n\\begin{matrix}\nn+1 \\\\\nk\n\\end{matrix}\n\\right)a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n&=\\sum_{k=0}^{n+1} \\left(\n\\begin{matrix}\nn+1 \\\\\nk\n\\end{matrix}\n\\right)a^{k} b^{n-k+1}\n\\end{align}\\]\n\\(n=k+1\\)の時 式 1 が成り立つので、二項定理が示された。\n三つ目\nパスカルの三角形が成り立つことを証明せよ。\n問題の意味がわからなかったのですが、おそらく「パスカルの三角形が二項定理の係数に相当することを示せ」ということだと解釈しました。\n\n\\(n\\)列目の\\(k\\)行目の数を\\({}_n C_k\\)とすると、\\({}_n C_k={}_{n-1}+ C_{k-1}{}_{n-1} C_{k}\\)が成り立つことを示せという問題なんですかね。\nこれは一つ目で示したものと同じになります。"
  },
  {
    "objectID": "solve/data_math2_quest/index.html",
    "href": "solve/data_math2_quest/index.html",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "",
    "text": "現状 解答済み　問1,2,3,4,6,12"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#問題",
    "href": "solve/data_math2_quest/index.html#問題",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "問題",
    "text": "問題\n二項分布\\(Bin(n,p)\\)の確率関数を\\(p_k=P(X=k)\\),\\(k=0, \\ldots, n\\)とする。\n⑴\\(p_k\\)を\\(p_{k-1}\\)を用いて表せ。\\(\\{p_0,\\ldots,p_n\\}\\)の中で最大を与える\\(k\\)を求めよ\n⑵\\(p=1/2\\)のとき、\\(n=10,k=9\\)の時の確率と\\(n=20,k=18\\)の時の確率ではどちらが大きいか。"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#解答",
    "href": "solve/data_math2_quest/index.html#解答",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "解答",
    "text": "解答\n\n\n\n\n\n\nNote 1\n\n\n\n確率変数\\(X\\)が二項分布\\(Bin(n,p)\\)に従う時、\\(X=k\\)となる確率は\\(q=1-p\\)に対して次のようになる。\n\\[\np(k)=\\binom{n}{k}p^k q^{n-k}\n\\]\n\n\n\n⑴\n\\(p_k=\\binom{n}{k}p^k q^{n-k}\\)と\\(p_{k-1}=\\binom{n}{k-1}p^{k-1} q^{n-(k-1)}\\)の関係を示したいです。\nカッコのままだとわかりにくかったので、階乗に直します。\n\\(p_k=\\frac{n!}{k!(n-k)!} p^k q^{n-k}\\) を　\\(p_{k-1}=\\frac{n!}{(k-1)!(n-(k-1))!} p^{k-1} q^{n-(k-1)}\\)の関係を示す問題です。\n式変形していきます。\n\\[\\begin{align}\np_{k}\n&=\n\\binom{n}{k}p^k q^{n-k}\n\\\\\n\n&=\n\\frac{n!}{k!(n-k)!} p^k q^{n-k}\n\\\\\n\n&=\n\\frac{n!(n-(k-1))}{k(k-1)! \\cdot (n-(k-1))!} p^k q^{n-k}\n\\\\\n\n&=\n\\frac{n!(n-(k-1))}{k(k-1)! \\cdot (n-(k-1))!} p^{k-1} q^{n-(k-1)} \\frac{p}{q}\n\\\\\n\n&=\n\\frac{n!}{(k-1)!(n-(k-1))!} p^{k-1} q^{n-(k-1)}\\frac{p(n-(k-1))}{kq}\n\\\\\n&=\n\\frac{p(n-(k-1))}{kq} p_{k-1}\n\\\\\n&=\n\\frac{p(n-(k-1))}{k(1-p)} p_{k-1}\n\n\\end{align}\\]\nきれいに治すと、 \\[\np_k=\\frac{p}{1-p} \\frac{n-(k-1)}{k} p_{k-1}\n\\tag{1}\\]\nとなります。\n\\(\\{p_0,\\ldots,p_n\\}\\)の中で最大を与える\\(k\\)を求める問題です。\\(p_k \\ge p_{k-1}\\)かつ\\(p_k \\ge p_{k+1}\\)となるような\\(k\\)の確率が最大となります。式 1 が誘導になってることがわかりますね。\n\\[\np_k = \\frac{p}{1-p} \\frac{n-(k-1)}{k} p_{k-1} \\ge p_{k-1}\n\\]\nかつ\n\\[\np_{k+1} = \\frac{p}{1-p} \\frac{n-k}{k+1} p_{k} \\le p_{k}\n\\]\nが成り立つことである。\n1つ目の式は確率は0以上であるため、下のように変形できる。\n\\[\\begin{align}\np_k = \\frac{p}{1-p} \\frac{n-(k-1)}{k} p_{k-1} &\\ge p_{k-1}　 \\\\\n\\Longleftrightarrow p(n-k+1) &\\ge (1-p)k \\\\\n\\Longleftrightarrow p(n+1) \\ge k\n\\end{align}\\]\n2つ目の式も同様に変形できる。\n\n\\[\\begin{align}\np_{k+1} = \\frac{p}{1-p} \\frac{n-k}{k+1} p_{k} &\\le p_{k} \\\\\n\\Longleftrightarrow p(n-k) &\\le (1-p)(k+1) \\\\\n\\Longleftrightarrow pn \\le k-p+1 \\\\\n\\Longleftrightarrow p(n+1) \\le k+1\n\\end{align}\\]\nよって\\(k\\)について以下の不等式を解くと確率が最大になる時の\\(k\\)がもとまる。\n\\[\np(n+1)-1 \\le k \\le p(n+1)\n\\]\nこれを満たす整数\\(k\\)は\\(p(n+1)\\)が整数かどうかで変わる。\n\\(p(n+1)\\)が整数のとき、\\(k=p(n+1),p(n+1)-1\\)である。\n\\(p(n+1)\\)が整数ではないとき、\\(k=[p(n+1)]\\)となる。\n\n\n\n\\(p(n+1)\\)が整数の時のグラフ！\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import binom\nimport japanize_matplotlib\n\n# 複数のn, p値を定義\nparams = [(9, 0.2), (9, 0.5), (19, 0.7), (19, 0.5), (19, 0.7)]\n\n# x の範囲を定義\nx = np.arange(0, 21)\n\n# グラフのプロット\nplt.figure(figsize=(10, 6))\n\nfor n, p in params:\n    pmf = binom.pmf(x, n, p)\n    plt.plot(x, pmf, marker='o', linestyle='-', label=f'n = {n}, p = {p}')\n\n# x軸の目盛りを整数に設定\nplt.xticks(np.arange(0, 21, 1))\n\nplt.xlabel('x')\nplt.ylabel('確率')\nplt.title('nとpを変動させた二項分布')\nplt.legend()\nplt.grid(True)\nplt.savefig('binom_distribution.png')\nplt.show()\n\n\n\n\n\n\n\n\n\n\\(p(n+1)\\)が整数の時のグラフ！\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import binom\nimport japanize_matplotlib\n\n# 複数のn, p値を定義\nparams = [(10, 0.2), (10, 0.5), (10, 0.7), (20, 0.5), (20, 0.7)]\n\n# x の範囲を定義\nx = np.arange(0, 21)\n\n# グラフのプロット\nplt.figure(figsize=(10, 6))\n\nfor n, p in params:\n    pmf = binom.pmf(x, n, p)\n    plt.plot(x, pmf, marker='o', linestyle='-', label=f'n = {n}, p = {p}')\n\n# x軸の目盛りを整数に設定\nplt.xticks(np.arange(0, 21, 1))\n\nplt.xlabel('x')\nplt.ylabel('確率')\nplt.title('nとpを変動させた二項分布')\nplt.legend()\nplt.grid(True)\nplt.savefig('binom_distribution.png')\nplt.show()\n\n\n\n\n\n\n\n\n\nグラフで見てみるとわかりやすいですね！\n\n\n⑵\n\\(n=10,k=9\\)のとき Note 2　より\n\\[\np_9=\\binom{10}{9} (\\frac{1}{2})^{10}\n\\]\n\\[\np_{18}=\\binom{20}{18} (\\frac{1}{2})^{20}\n\\]\n\\[\n\\binom{10}{9}={}_{10} C_9={}_{10} C_1=10,  \n\\binom{20}{18}={}_{20} C_{18}={}_{20} C_2=190\n\\]\nよって　\\(p_9=\\binom{10}{9} (\\frac{1}{2})^{10} &gt; p_{18}=\\binom{20}{18} (\\frac{1}{2})^{20}\\)\n\\(p_{9}\\)の方が確率は大きい。"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#問題-1",
    "href": "solve/data_math2_quest/index.html#問題-1",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "問題",
    "text": "問題\nポアソン分布\\(Po(\\lambda)\\)の確率関数を\\(p_k=P(X=k)\\),\\(k=0, \\ldots,\\)とする。\n⑴\\(p_k\\)を\\(p_{k-1}\\)を用いて表せ。\\(\\{p_0,\\ldots,\\}\\)の中で最大を与える\\(k\\)を求めよ\n⑵少なくとも１回以上起こる確率が90%以上になる\\(\\lambda\\)の条件を求めよ"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#解答-1",
    "href": "solve/data_math2_quest/index.html#解答-1",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "解答",
    "text": "解答\n\n⑴\n問１と同じですね。\n\n\n\n\n\n\nNote 2\n\n\n\n確率変数\\(X\\)ポアソン分布\\(Po(\\lambda)\\)に従う時、\\(X=k\\)となる確率は下のようになる。\nここに詳しく書いてある。\n\\[\np(k) = P(X=k) = \\frac{\\lambda^k}{k!}e^{-\\lambda}, k = 0,1,2,3, \\ldots\n\\]\n\n\n\\(p_k= \\frac{\\lambda^k}{k!}e^{-\\lambda}\\) を、\\(p_{k-1}= \\frac{\\lambda^{k-1}}{(k-1)!}e^{-\\lambda}\\) を用いて表す。\n\\[\np(k) = \\frac{\\lambda^k}{k!}e^{-\\lambda} = \\frac{\\lambda \\lambda^{k-1} }{k(k-1)!}e^{-\\lambda} =\\frac{\\lambda}{k}p_{k-1}\n\\]\n\\(p_k \\ge p_{k-1}\\)かつ\\(p_k \\ge p_{k+1}\\)となるような\\(k\\)の確率が最大となります。\n\\[\np_k = \\frac{\\lambda}{k}p_{k-1} \\ge p_{k-1} \\Longleftrightarrow \\lambda \\ge k\n\\]\n\\[\np_{k+1} = \\frac{\\lambda}{k+1}p_{k} \\le p_{k} \\Longleftrightarrow \\lambda \\le k+1\n\\]\nよって\\(\\lambda-1 \\le k \\le \\lambda\\) となります。\n\\(\\lambda\\)が整数の時、\\(k=\\lambda-1,\\lambda\\)。\n\\(\\lambda\\)が整数ではない時、\\(k=[\\lambda]\\)となります。\n\n\n⑵\n少なくとも１回以上起こる確率は\n\\[\nP(X \\le 1)=1-P(X=0)=1-\\frac{\\lambda^0}{0!}e^{-\\lambda}=1-e^{-\\lambda} \\ge 0.9\n\\]\n\\[\ne^{-\\lambda} \\le 0.1\n\\]\n両辺\\(e\\)を底数とする対数を取ると、 \\[\n-\\lambda \\le \\log 0.1 = - \\log 10\n\\]\n\\[\n\\lambda \\ge \\log 10\n\\]"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#問題-2",
    "href": "solve/data_math2_quest/index.html#問題-2",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "問題",
    "text": "問題\n３個の正しいコインを同時に投げ、３枚とも表か３枚とも裏が出るまで投げ続ける実験を行い、投げ続けた回数を\\(X+1\\)で表すことにする。このとき、\\(X\\)の確率分布を求めよ。また\\(P(X \\le k) \\ge 0.9\\)を満たす最小の\\(k\\)を求めよ。"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#解答-2",
    "href": "solve/data_math2_quest/index.html#解答-2",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "解答",
    "text": "解答\n求めているものが出るまでやり続ける回数は幾何分布に従う。\n注意する点として失敗する回数が幾何分布に従うことである。なのでこの問題で成功した時を\\(X+1\\)としているのは、\\(X\\)が幾何分布に従うことを意味する。\n\n\n\n\n\n\n\n\n\nNote 3: 幾何分布(\\(Geo(p)\\))\n\n\n\n確率変数\\(X\\)が幾何分布に従う時、\\(p\\)を成功確率、\\(k\\)を失敗確率として、\\(k\\)回失敗した時の$Xの確率関数は\n\\[\np(k)=q^k p, k=0,1,2 \\ldots\n\\]\n\n\n成功確率\\(p=(1/2)^3 \\times 2 = 1/4\\),\\(q=3/4\\)\nよって確率変数\\(X\\)は\\(Geo(3/4)\\)の幾何分布に従う。←確率分布を求めよの答えかなあ\n\\(X\\)の確率関数は\n\\[\np(k)=(3/4)^k (1/4)\n\\]\nとなる。\n累積分布関数が0.9を越す最小の\\(k\\)を求めます。\n\\[\nF(k)=P(X \\le k) = \\sum_{x=0}^k p(x) = \\sum_{x=0}^k (3/4)^x (1/4)=1/4+\\sum_{x=1}^k (3/4)^{x-1} (3/4)(1/4)=1/4+\\frac{3/16(1-(3/4)^{k})}{1-3/4}=1-(3/4)^{k+1} \\ge 0.9\n\\]\n\\[\n1-(3/4)^{k+1} \\ge 0.9\n\\]\n\\[\n(k+1) \\log (3/4) \\le - \\log 10\n\\]\n\\[\nk \\le -1 -  \\frac{\\log 10}{\\log (3/4)}\n\\]\nである。"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#問題-3",
    "href": "solve/data_math2_quest/index.html#問題-3",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "問題",
    "text": "問題\n\\(U\\)を一様分布\\(U(0,1)\\)に従う確率変数とし、自然数\\(n\\)に対して\\(X=[nU]\\)とおく。\\(X\\)の確率分布を与えよ。"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#解答-3",
    "href": "solve/data_math2_quest/index.html#解答-3",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "解答",
    "text": "解答\n\\([nU]=k\\)とすると\\(k \\le nU &lt; k+1\\)となる。\n\\[\n\\frac{k}{n} \\le U &lt; \\frac{k+1}{n}\n\\]\n\\[\nP(X=k) = P(k \\le nU &lt; k+1) = P(\\frac{k}{n} \\le U &lt; \\frac{k+1}{n} ) = \\frac{1}{n}\n\\]"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#問題概要",
    "href": "solve/data_math2_quest/index.html#問題概要",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(Y \\sim Ex(\\lambda)\\) のとき、\\(X=[Y]\\) とおく。\\(X\\) はどういう確率分布に従うか。"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#回答",
    "href": "solve/data_math2_quest/index.html#回答",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "回答",
    "text": "回答\nといてない"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#問題概要-1",
    "href": "solve/data_math2_quest/index.html#問題概要-1",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(X \\sim N(\\mu, \\sigma^2)\\)\n⑴ \\(P(\\mu - c \\leq X \\leq \\mu + c)=0.95\\) となる\\(c\\)\n⑵ \\(P(\\mu - 2\\sigma \\leq X \\leq \\mu + \\sigma)\\) の確率。\\(P(X \\leq d)=0.05\\) となる\\(d\\)。\n⑶ \\(Y=aX+b\\), \\(Y\\) の確率分布は？"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#解答-4",
    "href": "solve/data_math2_quest/index.html#解答-4",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "解答",
    "text": "解答\n⑴\n\\(X\\) を標準化した確率変数 \\(Z=\\frac{X-\\mu}{\\sigma}\\) を使い、標準正規分布表を用いて考える。\n\\(Z \\sim N(0,1)\\) であり、\\(P(-1.96 \\leq Z \\leq 1.96) = 0.95\\) である。\n\\[\n\\begin{aligned}\nP(\\mu - c \\leq X \\leq \\mu + c)\n&= P(\\frac{\\mu - c-\\mu}{\\sigma} \\leq \\frac{X-\\mu}{\\sigma} \\leq \\frac{\\mu + c-\\mu}{\\sigma}) \\\\\n&=P(\\frac{ - c}{\\sigma} \\leq \\frac{X-\\mu}{\\sigma} \\leq \\frac{c}{\\sigma}) \\\\\n&= P(-1.96 \\leq Z \\leq 1.96) \\\\\n\\end{aligned}\n\\]\nよって \\(\\frac{c}{\\sigma}=1.96\\) であり、\\(c=1.96\\sigma\\)\n⑵\n同じく標準化して考える。\n\\[\n\\begin{aligned}\nP(\\mu - 2\\sigma \\leq X \\leq \\mu + \\sigma)\n&= P( \\frac{\\mu - 2\\sigma -\\mu}{ \\sigma} \\leq \\frac{X-\\mu}{\\sigma} \\leq \\frac{\\mu + \\sigma -\\mu}{ \\sigma}) \\\\\n&= P(-2 \\leq Z \\leq 1) \\\\\n&= \\Phi(1) - \\Phi(-2) \\\\\n&= 1 - 0.1587 - 0.0228 \\\\\n&= 0.82\n\\end{aligned}\n\\]\n二つ目の問題も同じ解き方である。\n\\[\n\\begin{aligned}\nP(X \\leq d)=P(\\frac{X - \\mu}{\\sigma} \\leq \\frac{d - \\mu}{\\sigma})\n=P(Z \\leq \\frac{d - \\mu}{\\sigma})\n\\end{aligned}\n\\]\n標準正規分布表で累積確率が0.05となる値は-1.64である。\n\\(\\frac{d - \\mu}{\\sigma} = -1.64\\) より \\(d = \\mu - 1.64 \\sigma\\)\n⑶\n(命題) \\(X \\sim N(\\mu,\\sigma)\\) を\\(Y=aX+b\\)という変換をすると、 \\(N(a \\mu + b, a^2 \\sigma^2)\\) 。\n一応１から書く！\n変数変換の公式から, \\(X\\) の確率関数を\\(f_X(x)\\)とすると、\\(Y=aX+b\\)の確率関数は\n\\[\nf_Y(y)=\\frac{1}{|a|} f_X(\\frac{y-b}{a})\n\\]\nである。\nよって、\n\\[\n\\begin{aligned}\nf_Y(y) &= \\frac{1}{|a|} f_X(\\frac{y-b}{a}) \\\\\n&=  \\frac{1}{\\sqrt{2 \\pi \\sigma^2}|a|} \\exp\\left\\{ - \\frac{(\\frac{y-b}{a} - \\mu)^2}{2 \\sigma^2}\\right\\} \\\\\n&= \\frac{1}{\\sqrt{2 \\pi \\sigma^2}|a|} \\exp\\left\\{ - \\frac{(y-b - a\\mu)^2}{2 a^2\\sigma^2}\\right\\} \\\\\n\\end{aligned}\n\\]\nとなる。この確率密度関数は\\(E[Y]= a \\mu + b\\),\\(Var(Y)= a^2 \\sigma^2\\) の正規分布に従う確率密度関数と一致するため、\\(Y \\sim N(a \\mu + b ,a^2 \\sigma^2)\\)"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#問題概要-2",
    "href": "solve/data_math2_quest/index.html#問題概要-2",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n⑴ \\(X \\sim N(0, \\sigma^2)\\) のとき、\\(Y=X^2,Z=|X|\\) の確率分布は。\n⑵ \\(U \\sim U(-1,1)\\) のとき、\\(Y=U^2\\) の確率分布は。\n⑶ \\(\\Theta \\sim U(-\\frac{\\pi}{2},\\frac{\\pi}{2})\\) のとき、\\(Y=\\tan{\\Theta}\\) の確率分布は。"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#解答-5",
    "href": "solve/data_math2_quest/index.html#解答-5",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "解答",
    "text": "解答"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#問題概要-3",
    "href": "solve/data_math2_quest/index.html#問題概要-3",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(X \\sim Geo(\\frac{\\theta}{n})\\), \\(\\lim_{n \\to \\infty}P(X \\leq n)\\) を求める問題"
  },
  {
    "objectID": "solve/data_math2_quest/index.html#解答-6",
    "href": "solve/data_math2_quest/index.html#解答-6",
    "title": "「データ解析のための数理統計入門」第2章 演習問題 解答",
    "section": "解答",
    "text": "解答\n幾何分布の確率関数は、\\(p(x)= \\frac{\\theta}{n} (1 - \\frac{\\theta}{n})^x\\)\n\\[\n\\begin{aligned}\nP(X \\leq n) &= \\sum_{x=0}^n \\frac{\\theta}{n} (1 - \\frac{\\theta}{n})^x \\\\\n&= \\frac{\\theta}{n} \\frac{1-(1 - \\frac{\\theta}{n})^{n+1}}{1-(1 - \\frac{\\theta}{n})} \\\\\n&= 1-(1 - \\frac{\\theta}{n})^{n+1}\n\\end{aligned}\n\\]\nである。これの極限を求める。\n\\[\n\\begin{aligned}\n\\lim_{n \\to \\infty}P(X \\leq n) = \\lim_{n \\to \\infty}1-(1 - \\frac{\\theta}{n})^{n+1}\n= 1 - e^{-\\theta}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "empty/data_math1_chap1_me/index.html",
    "href": "empty/data_math1_chap1_me/index.html",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.1標本空間",
    "section": "",
    "text": "試行：結果が生ずるような行為\n標本空間(\\(\\Omega\\))：試行によって起こりうるすべての結果\n事象：起こりうる結果(\\(\\omega\\))の集まり\n\n\nサイコロを投げる時に出る目について考える。\n\nサイコロを投げるという行為は試行になります。\n標本空間は試行によって起こりうるすべての結果なので、\\(\\Omega=\\{1,2,3,4,5,6\\}\\)\n事象は起こりうる結果の集まりなので、\\(\\{1,2\\},\\{2,5\\}\\)のような\\(\\Omega\\)の部分集合にあたります。\n\n\n上で挙げた通り、試行による結果（\\(\\omega\\)）は集合の要素または元に対応する。\n\n\n\n\n\n\n\\(\\Omega\\)と\\(\\omega\\)\n\n\n\n標本空間と結果が\\Omega（標本空間）\\omega（結果）になるのは意味が対応しててわかりやすいですね。\n\n\n\n積事象：２つの事象\\(A,B\\)がともに起こる事象\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(6, 6))\n\nv = venn2(subsets=(2, 2, 1))\n\nv.get_patch_by_id('10').set_color('white')\nv.get_patch_by_id('11').set_color('black')\nv.get_patch_by_id('01').set_color('white')\n\nv.get_patch_by_id('10').set_alpha(1.0)\nv.get_patch_by_id('11').set_alpha(0.3)\nv.get_patch_by_id('01').set_alpha(1.0)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('11').set_text('AかつB(積事象)')\nv.get_label_by_id('01').set_text('')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n和事象：２つの事象\\(A,B\\)の少なくともどちらかが起こる事象\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(6, 6))\n\nv = venn2(subsets=(2, 2, 1))\n\nv.get_patch_by_id('10').set_color('black')\nv.get_patch_by_id('11').set_color('black')\nv.get_patch_by_id('01').set_color('black')\n\nv.get_patch_by_id('10').set_alpha(0.3)\nv.get_patch_by_id('11').set_alpha(0.3)\nv.get_patch_by_id('01').set_alpha(0.3)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('11').set_text('AまたはB(和事象)')\nv.get_label_by_id('01').set_text('')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n積事象・和事象は積集合・和集合にそれぞれ対応している。\n\\(A \\cap B = \\{x|x\\in A かつx\\in B\\}\\), \\(A \\cup B = \\{x|x\\in A またはx\\in B\\}\\)\n\n起こりうる結果である事象を集合として捉えるといいって話ですかね。\n\n補集合：\\(A\\)の補集合とは、\\(A\\)に属さない元の集合で、\\(A^c\\)と表す。\n差集合：\\(AとB\\)の差集合とは、\\(A\\)に属するが\\(B\\)に属さない元の集合で、\\(A\\setminus B\\)と表す。また\\(A\\setminus B=A\\cap B^c\\)となる。補集合は\\(A^c=\\Omega \\setminus A\\)と表すこともできる。\n\n\nコード\nimport matplotlib.pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\n# 集合の定義\nA = set([1, 2, 3, 4])\nB = set([3, 4, 5, 6])\n\n# Venn 図の作成\nplt.figure(figsize=(6, 6))\nvenn = venn2([A, B], ('A', 'B'))\n\nvenn.get_patch_by_id('10').set_color('black')\nvenn.get_patch_by_id('11').set_color('white')\nvenn.get_patch_by_id('01').set_color('white')\n\nvenn.get_patch_by_id('11').set_edgecolor('black')\nvenn.get_patch_by_id('11').set_linewidth(2)\nvenn.get_patch_by_id('01').set_edgecolor('black')\nvenn.get_patch_by_id('01').set_linewidth(2)\n\n# 差集合 A - B の部分を強調\nfor subset in ('10', '11', '01'):\n    venn.get_label_by_id(subset).set_text('')\nvenn.get_label_by_id('10').set_text('A と Bの差集合')\n\nplt.title(\"差集合\")\nplt.show()\n\n\n\n\n\n\n\n\n\n\n排反：空集合を\\(\\emptyset\\)とする。\\(A \\cap B=\\emptyset\\)のときAとBは互いに排反であるという。\n事象同士に共通部分がないってことですかね。\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(7, 7))\n\nv = venn2(subsets=(2, 2, 0))\n\nv.get_patch_by_id('10').set_color('white')\n\nv.get_patch_by_id('01').set_color('white')\n\n# v.get_patch_by_id('10').set_alpha(0.3)\n# v.get_patch_by_id('11').set_alpha(0.3)\n# v.get_patch_by_id('01').set_alpha(0.3)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('01').set_text('')\nplt.gca().set_axis_on()\nplt.gca().set_facecolor('white')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\nサイコロを投げる時、偶数の目が出る事象を\\(A=\\{2,4,6\\}\\)、４以上の目が出る事象を\\(B=\\{4,5,6\\}\\)とし、奇数の目が出る事象を\\(C=\\{1,3,5\\}\\)としたとき、\n\n和事象：\\(A \\cap B=\\{2,4,6\\}\\)\n積事象：\\(A \\cup B=\\{2,4,5,6\\}\\)\nとなる。\n\\(A \\cap C = \\emptyset\\)より、\\(A\\)と\\(C\\)は互いに排反である。"
  },
  {
    "objectID": "empty/data_math1_chap1_me/index.html#用語",
    "href": "empty/data_math1_chap1_me/index.html#用語",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.1標本空間",
    "section": "",
    "text": "試行：結果が生ずるような行為\n標本空間(\\(\\Omega\\))：試行によって起こりうるすべての結果\n事象：起こりうる結果(\\(\\omega\\))の集まり\n\n\nサイコロを投げる時に出る目について考える。\n\nサイコロを投げるという行為は試行になります。\n標本空間は試行によって起こりうるすべての結果なので、\\(\\Omega=\\{1,2,3,4,5,6\\}\\)\n事象は起こりうる結果の集まりなので、\\(\\{1,2\\},\\{2,5\\}\\)のような\\(\\Omega\\)の部分集合にあたります。\n\n\n上で挙げた通り、試行による結果（\\(\\omega\\)）は集合の要素または元に対応する。\n\n\n\n\n\n\n\\(\\Omega\\)と\\(\\omega\\)\n\n\n\n標本空間と結果が\\Omega（標本空間）\\omega（結果）になるのは意味が対応しててわかりやすいですね。\n\n\n\n積事象：２つの事象\\(A,B\\)がともに起こる事象\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(6, 6))\n\nv = venn2(subsets=(2, 2, 1))\n\nv.get_patch_by_id('10').set_color('white')\nv.get_patch_by_id('11').set_color('black')\nv.get_patch_by_id('01').set_color('white')\n\nv.get_patch_by_id('10').set_alpha(1.0)\nv.get_patch_by_id('11').set_alpha(0.3)\nv.get_patch_by_id('01').set_alpha(1.0)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('11').set_text('AかつB(積事象)')\nv.get_label_by_id('01').set_text('')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n和事象：２つの事象\\(A,B\\)の少なくともどちらかが起こる事象\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(6, 6))\n\nv = venn2(subsets=(2, 2, 1))\n\nv.get_patch_by_id('10').set_color('black')\nv.get_patch_by_id('11').set_color('black')\nv.get_patch_by_id('01').set_color('black')\n\nv.get_patch_by_id('10').set_alpha(0.3)\nv.get_patch_by_id('11').set_alpha(0.3)\nv.get_patch_by_id('01').set_alpha(0.3)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('11').set_text('AまたはB(和事象)')\nv.get_label_by_id('01').set_text('')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n積事象・和事象は積集合・和集合にそれぞれ対応している。\n\\(A \\cap B = \\{x|x\\in A かつx\\in B\\}\\), \\(A \\cup B = \\{x|x\\in A またはx\\in B\\}\\)\n\n起こりうる結果である事象を集合として捉えるといいって話ですかね。\n\n補集合：\\(A\\)の補集合とは、\\(A\\)に属さない元の集合で、\\(A^c\\)と表す。\n差集合：\\(AとB\\)の差集合とは、\\(A\\)に属するが\\(B\\)に属さない元の集合で、\\(A\\setminus B\\)と表す。また\\(A\\setminus B=A\\cap B^c\\)となる。補集合は\\(A^c=\\Omega \\setminus A\\)と表すこともできる。\n\n\nコード\nimport matplotlib.pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\n# 集合の定義\nA = set([1, 2, 3, 4])\nB = set([3, 4, 5, 6])\n\n# Venn 図の作成\nplt.figure(figsize=(6, 6))\nvenn = venn2([A, B], ('A', 'B'))\n\nvenn.get_patch_by_id('10').set_color('black')\nvenn.get_patch_by_id('11').set_color('white')\nvenn.get_patch_by_id('01').set_color('white')\n\nvenn.get_patch_by_id('11').set_edgecolor('black')\nvenn.get_patch_by_id('11').set_linewidth(2)\nvenn.get_patch_by_id('01').set_edgecolor('black')\nvenn.get_patch_by_id('01').set_linewidth(2)\n\n# 差集合 A - B の部分を強調\nfor subset in ('10', '11', '01'):\n    venn.get_label_by_id(subset).set_text('')\nvenn.get_label_by_id('10').set_text('A と Bの差集合')\n\nplt.title(\"差集合\")\nplt.show()\n\n\n\n\n\n\n\n\n\n\n排反：空集合を\\(\\emptyset\\)とする。\\(A \\cap B=\\emptyset\\)のときAとBは互いに排反であるという。\n事象同士に共通部分がないってことですかね。\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(7, 7))\n\nv = venn2(subsets=(2, 2, 0))\n\nv.get_patch_by_id('10').set_color('white')\n\nv.get_patch_by_id('01').set_color('white')\n\n# v.get_patch_by_id('10').set_alpha(0.3)\n# v.get_patch_by_id('11').set_alpha(0.3)\n# v.get_patch_by_id('01').set_alpha(0.3)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('01').set_text('')\nplt.gca().set_axis_on()\nplt.gca().set_facecolor('white')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\nサイコロを投げる時、偶数の目が出る事象を\\(A=\\{2,4,6\\}\\)、４以上の目が出る事象を\\(B=\\{4,5,6\\}\\)とし、奇数の目が出る事象を\\(C=\\{1,3,5\\}\\)としたとき、\n\n和事象：\\(A \\cap B=\\{2,4,6\\}\\)\n積事象：\\(A \\cup B=\\{2,4,5,6\\}\\)\nとなる。\n\\(A \\cap C = \\emptyset\\)より、\\(A\\)と\\(C\\)は互いに排反である。"
  },
  {
    "objectID": "empty/data_math1_chap1_me/index.html#事象と集合",
    "href": "empty/data_math1_chap1_me/index.html#事象と集合",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.1標本空間",
    "section": "",
    "text": "上で挙げた通り、試行による結果（\\(\\omega\\)）は集合の要素または元に対応する。\n\n\n\n\n\n\n\\(\\Omega\\)と\\(\\omega\\)\n\n\n\n標本空間と結果が\\Omega（標本空間）\\omega（結果）になるのは意味が対応しててわかりやすいですね。\n\n\n\n積事象：２つの事象\\(A,B\\)がともに起こる事象\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(6, 6))\n\nv = venn2(subsets=(2, 2, 1))\n\nv.get_patch_by_id('10').set_color('white')\nv.get_patch_by_id('11').set_color('black')\nv.get_patch_by_id('01').set_color('white')\n\nv.get_patch_by_id('10').set_alpha(1.0)\nv.get_patch_by_id('11').set_alpha(0.3)\nv.get_patch_by_id('01').set_alpha(1.0)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('11').set_text('AかつB(積事象)')\nv.get_label_by_id('01').set_text('')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n和事象：２つの事象\\(A,B\\)の少なくともどちらかが起こる事象\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(6, 6))\n\nv = venn2(subsets=(2, 2, 1))\n\nv.get_patch_by_id('10').set_color('black')\nv.get_patch_by_id('11').set_color('black')\nv.get_patch_by_id('01').set_color('black')\n\nv.get_patch_by_id('10').set_alpha(0.3)\nv.get_patch_by_id('11').set_alpha(0.3)\nv.get_patch_by_id('01').set_alpha(0.3)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('11').set_text('AまたはB(和事象)')\nv.get_label_by_id('01').set_text('')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n積事象・和事象は積集合・和集合にそれぞれ対応している。\n\\(A \\cap B = \\{x|x\\in A かつx\\in B\\}\\), \\(A \\cup B = \\{x|x\\in A またはx\\in B\\}\\)\n\n起こりうる結果である事象を集合として捉えるといいって話ですかね。\n\n補集合：\\(A\\)の補集合とは、\\(A\\)に属さない元の集合で、\\(A^c\\)と表す。\n差集合：\\(AとB\\)の差集合とは、\\(A\\)に属するが\\(B\\)に属さない元の集合で、\\(A\\setminus B\\)と表す。また\\(A\\setminus B=A\\cap B^c\\)となる。補集合は\\(A^c=\\Omega \\setminus A\\)と表すこともできる。\n\n\nコード\nimport matplotlib.pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\n# 集合の定義\nA = set([1, 2, 3, 4])\nB = set([3, 4, 5, 6])\n\n# Venn 図の作成\nplt.figure(figsize=(6, 6))\nvenn = venn2([A, B], ('A', 'B'))\n\nvenn.get_patch_by_id('10').set_color('black')\nvenn.get_patch_by_id('11').set_color('white')\nvenn.get_patch_by_id('01').set_color('white')\n\nvenn.get_patch_by_id('11').set_edgecolor('black')\nvenn.get_patch_by_id('11').set_linewidth(2)\nvenn.get_patch_by_id('01').set_edgecolor('black')\nvenn.get_patch_by_id('01').set_linewidth(2)\n\n# 差集合 A - B の部分を強調\nfor subset in ('10', '11', '01'):\n    venn.get_label_by_id(subset).set_text('')\nvenn.get_label_by_id('10').set_text('A と Bの差集合')\n\nplt.title(\"差集合\")\nplt.show()\n\n\n\n\n\n\n\n\n\n\n排反：空集合を\\(\\emptyset\\)とする。\\(A \\cap B=\\emptyset\\)のときAとBは互いに排反であるという。\n事象同士に共通部分がないってことですかね。\n\n\nコード\nfrom matplotlib import pyplot as plt\nfrom matplotlib_venn import venn2\nimport japanize_matplotlib\n\nplt.figure(figsize=(7, 7))\n\nv = venn2(subsets=(2, 2, 0))\n\nv.get_patch_by_id('10').set_color('white')\n\nv.get_patch_by_id('01').set_color('white')\n\n# v.get_patch_by_id('10').set_alpha(0.3)\n# v.get_patch_by_id('11').set_alpha(0.3)\n# v.get_patch_by_id('01').set_alpha(0.3)\n\nv.get_patch_by_id('10').set_edgecolor('black')\nv.get_patch_by_id('10').set_linewidth(2)\nv.get_patch_by_id('01').set_edgecolor('black')\nv.get_patch_by_id('01').set_linewidth(2)\n\nv.get_label_by_id('10').set_text('')\nv.get_label_by_id('01').set_text('')\nplt.gca().set_axis_on()\nplt.gca().set_facecolor('white')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\nサイコロを投げる時、偶数の目が出る事象を\\(A=\\{2,4,6\\}\\)、４以上の目が出る事象を\\(B=\\{4,5,6\\}\\)とし、奇数の目が出る事象を\\(C=\\{1,3,5\\}\\)としたとき、\n\n和事象：\\(A \\cap B=\\{2,4,6\\}\\)\n積事象：\\(A \\cup B=\\{2,4,5,6\\}\\)\nとなる。\n\\(A \\cap C = \\emptyset\\)より、\\(A\\)と\\(C\\)は互いに排反である。"
  },
  {
    "objectID": "empty/free-wifi-kobe/index.html",
    "href": "empty/free-wifi-kobe/index.html",
    "title": "神戸市のフリーwifiをpythonで地図上にプロットしてみる！",
    "section": "",
    "text": "コードを見る\nimport folium\nimport pandas as pd\n\ndf=pd.read_csv('opendata_94.csv',encoding='utf-8')\n\nkobe_map = folium.Map(location=[34.728063, 135.23434], zoom_start=13)\n\n\nfor index, row in df.iterrows():\n    folium.Marker(\n        location=[row['緯度'], row['経度']],\n        popup=f\"{row['設置場所']} ({row['分類']})\",\n        icon=folium.Icon(icon=\"wifi\", prefix='fa')\n    ).add_to(kobe_map)\n\n\nmap_file_path = 'kobe_wifi_map.html'\nkobe_map.save(map_file_path)\n\n\nkobe_map\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook"
  },
  {
    "objectID": "empty/data_math1_chap2_me/index.html",
    "href": "empty/data_math1_chap2_me/index.html",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.2確率",
    "section": "",
    "text": "\\(\\Omega\\)上の確率\\(P(\\cdot)\\)は\\(\\Omega\\)の部分集合から区間\\([0,1]\\)上の実数への関数で、3つの性質を満たす。\n\n\n定理 1 \\[\nA \\subset \\Omega ならP(A) \\ge 0\n\\]\n\n\n定理 2 \\[\nP(\\Omega)=1\n\\]\n\n\n定理 3 \\[\nA_1とA_2が排反なら、P(A_1 \\cup A_2)=P(A_1)+P(A_2)\n\\]\n\n\n定理 3 については無限大まで扱えるそうです。\n\n\n\n補題 1 (性質A) \\[\nP(A^c)=1-P(A),P(\\emptyset)=0\n\\]\n\n\n\n補題 2 (性質B) \\[\nA \\subset B ならばP(A) \\le P(B)\n\\]\n\n\n\n補題 3 (性質C) \\[\nP(A \\cap B) \\le min\\{P(A),P(B)\\}\n\\]\n\n\n\n補題 4 (性質D) \\[\nP(A \\cup B) = P(A)+P(B)+P(A \\cap B)\n\\]\n\n\n\n証明. 補題 1 が成り立つことを示す。\n\\(P(A)+P(A^c)=1\\)であることを示せば良い。また\\(P(\\Omega)=1\\)より、\\(P(A)+P(A^c)=P(\\Omega)\\)を示せばいいことがわかる。\n\\(A\\)と\\(A^c\\)は排反より、定理 3 を用いて\\(P(A \\cup A^c) = P(A)+P(A^c)\\) となる。\n\\(\\Omega = A \\cup A^c\\)より\\(P(A)+P(A^c)=P(\\Omega)\\)が成り立つ。\nよって\\(P(A)+P(A^c)=1\\)が成り立つ。\n\\(A\\)に\\(\\Omega\\)を代入すると、\\(P(\\Omega)+P(\\Omega^c)=1\\)。よって\\(P(\\emptyset) = 1- P(\\Omega)=0\\)\n\n\n\n証明. 補題 2 が成り立つことを示す。\n確率は0より大きいことを利用して、確率の大小関係を示すことができる。\nつまり、\\(P(B)=P(A)+なにか\\)のような形で示せればよい。また 定理 3 により\\(B\\) が\\(A\\) と \\(A \\cup なにか\\) で表すことができ、その２つの事象が排反になれば、求めるような形にできる。\n差集合を使う。包含関係より\n\\[\nB=A \\cup (B \\setminus A)=A \\cup (B \\cap A^c)\n\\]\nとなる。また、\\(A\\) と\\((B \\setminus A)\\)は排反であるため、定理 3 定理 1 より以下のようになる。\n\\[\nP(B)=P(A \\cup (B \\cap A^c))=P(A)+P((B \\cap A^c)) \\ge P(A)\n\\]\n\n\n\n証明. 補題 3 が成り立つことを示す。\n補題 2 と同じように確率の大小関係を示す。\n\\((A \\cap B) \\subset A\\) より\\(P(A \\cap B) \\le P(A)\\)\n\\(B\\)についても同様である。\n\n\n\n証明. 補題 4 が成り立つことを示す。\n\\(A\\)を\\((A \\cap B) \\cup (A \\cap B^c)\\)と分割することで、排反なので、定理 3 を使うことができる。 \\[\nP(A)=P((A \\cap B) \\cup (A \\cap B^c))=P(A \\cap B)+P(A \\cap B^c)\n\\]\n\\[\nP(B)=P((A \\cap B) \\cup (B \\cap A^c))=P(A \\cap B)+P(B \\cap A^c)\n\\]\n\\(A \\cup B = (A \\cap B^c) \\cup (A \\cap B) \\cup (B \\cap A^c)\\)であり、それぞれ排反なので、定理 3 を拡張したものより \\(P(A \\cup B) = P(A \\cap B^c) \\cup P(A \\cap B) \\cup P(B \\cap A^c)\\)である。\n\\(P(A)+P(B)\\)すると \\[\nP(A)+P(B)=P(A \\cap B)+P(A \\cap B^c)+P(A \\cap B)+P(B \\cap A^c)=P(A \\cap B)+P(A \\cup B)\n\\]"
  },
  {
    "objectID": "empty/data_math1_chap2_me/index.html#確率の定義",
    "href": "empty/data_math1_chap2_me/index.html#確率の定義",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.2確率",
    "section": "",
    "text": "\\(\\Omega\\)上の確率\\(P(\\cdot)\\)は\\(\\Omega\\)の部分集合から区間\\([0,1]\\)上の実数への関数で、3つの性質を満たす。\n\n\n定理 1 \\[\nA \\subset \\Omega ならP(A) \\ge 0\n\\]\n\n\n定理 2 \\[\nP(\\Omega)=1\n\\]\n\n\n定理 3 \\[\nA_1とA_2が排反なら、P(A_1 \\cup A_2)=P(A_1)+P(A_2)\n\\]\n\n\n定理 3 については無限大まで扱えるそうです。\n\n\n\n補題 1 (性質A) \\[\nP(A^c)=1-P(A),P(\\emptyset)=0\n\\]\n\n\n\n補題 2 (性質B) \\[\nA \\subset B ならばP(A) \\le P(B)\n\\]\n\n\n\n補題 3 (性質C) \\[\nP(A \\cap B) \\le min\\{P(A),P(B)\\}\n\\]\n\n\n\n補題 4 (性質D) \\[\nP(A \\cup B) = P(A)+P(B)+P(A \\cap B)\n\\]\n\n\n\n証明. 補題 1 が成り立つことを示す。\n\\(P(A)+P(A^c)=1\\)であることを示せば良い。また\\(P(\\Omega)=1\\)より、\\(P(A)+P(A^c)=P(\\Omega)\\)を示せばいいことがわかる。\n\\(A\\)と\\(A^c\\)は排反より、定理 3 を用いて\\(P(A \\cup A^c) = P(A)+P(A^c)\\) となる。\n\\(\\Omega = A \\cup A^c\\)より\\(P(A)+P(A^c)=P(\\Omega)\\)が成り立つ。\nよって\\(P(A)+P(A^c)=1\\)が成り立つ。\n\\(A\\)に\\(\\Omega\\)を代入すると、\\(P(\\Omega)+P(\\Omega^c)=1\\)。よって\\(P(\\emptyset) = 1- P(\\Omega)=0\\)\n\n\n\n証明. 補題 2 が成り立つことを示す。\n確率は0より大きいことを利用して、確率の大小関係を示すことができる。\nつまり、\\(P(B)=P(A)+なにか\\)のような形で示せればよい。また 定理 3 により\\(B\\) が\\(A\\) と \\(A \\cup なにか\\) で表すことができ、その２つの事象が排反になれば、求めるような形にできる。\n差集合を使う。包含関係より\n\\[\nB=A \\cup (B \\setminus A)=A \\cup (B \\cap A^c)\n\\]\nとなる。また、\\(A\\) と\\((B \\setminus A)\\)は排反であるため、定理 3 定理 1 より以下のようになる。\n\\[\nP(B)=P(A \\cup (B \\cap A^c))=P(A)+P((B \\cap A^c)) \\ge P(A)\n\\]\n\n\n\n証明. 補題 3 が成り立つことを示す。\n補題 2 と同じように確率の大小関係を示す。\n\\((A \\cap B) \\subset A\\) より\\(P(A \\cap B) \\le P(A)\\)\n\\(B\\)についても同様である。\n\n\n\n証明. 補題 4 が成り立つことを示す。\n\\(A\\)を\\((A \\cap B) \\cup (A \\cap B^c)\\)と分割することで、排反なので、定理 3 を使うことができる。 \\[\nP(A)=P((A \\cap B) \\cup (A \\cap B^c))=P(A \\cap B)+P(A \\cap B^c)\n\\]\n\\[\nP(B)=P((A \\cap B) \\cup (B \\cap A^c))=P(A \\cap B)+P(B \\cap A^c)\n\\]\n\\(A \\cup B = (A \\cap B^c) \\cup (A \\cap B) \\cup (B \\cap A^c)\\)であり、それぞれ排反なので、定理 3 を拡張したものより \\(P(A \\cup B) = P(A \\cap B^c) \\cup P(A \\cap B) \\cup P(B \\cap A^c)\\)である。\n\\(P(A)+P(B)\\)すると \\[\nP(A)+P(B)=P(A \\cap B)+P(A \\cap B^c)+P(A \\cap B)+P(B \\cap A^c)=P(A \\cap B)+P(A \\cup B)\n\\]"
  },
  {
    "objectID": "empty/data_math1_chap2_me/index.html#確率の基本的な4つの性質",
    "href": "empty/data_math1_chap2_me/index.html#確率の基本的な4つの性質",
    "title": "「データ解析のための数理統計入門」第1章 確率モデル 1.2確率",
    "section": "",
    "text": "補題 1 (性質A) \\[\nP(A^c)=1-P(A),P(\\emptyset)=0\n\\]\n\n\n\n補題 2 (性質B) \\[\nA \\subset B ならばP(A) \\le P(B)\n\\]\n\n\n\n補題 3 (性質C) \\[\nP(A \\cap B) \\le min\\{P(A),P(B)\\}\n\\]\n\n\n\n補題 4 (性質D) \\[\nP(A \\cup B) = P(A)+P(B)+P(A \\cap B)\n\\]\n\n\n\n証明. 補題 1 が成り立つことを示す。\n\\(P(A)+P(A^c)=1\\)であることを示せば良い。また\\(P(\\Omega)=1\\)より、\\(P(A)+P(A^c)=P(\\Omega)\\)を示せばいいことがわかる。\n\\(A\\)と\\(A^c\\)は排反より、定理 3 を用いて\\(P(A \\cup A^c) = P(A)+P(A^c)\\) となる。\n\\(\\Omega = A \\cup A^c\\)より\\(P(A)+P(A^c)=P(\\Omega)\\)が成り立つ。\nよって\\(P(A)+P(A^c)=1\\)が成り立つ。\n\\(A\\)に\\(\\Omega\\)を代入すると、\\(P(\\Omega)+P(\\Omega^c)=1\\)。よって\\(P(\\emptyset) = 1- P(\\Omega)=0\\)\n\n\n\n証明. 補題 2 が成り立つことを示す。\n確率は0より大きいことを利用して、確率の大小関係を示すことができる。\nつまり、\\(P(B)=P(A)+なにか\\)のような形で示せればよい。また 定理 3 により\\(B\\) が\\(A\\) と \\(A \\cup なにか\\) で表すことができ、その２つの事象が排反になれば、求めるような形にできる。\n差集合を使う。包含関係より\n\\[\nB=A \\cup (B \\setminus A)=A \\cup (B \\cap A^c)\n\\]\nとなる。また、\\(A\\) と\\((B \\setminus A)\\)は排反であるため、定理 3 定理 1 より以下のようになる。\n\\[\nP(B)=P(A \\cup (B \\cap A^c))=P(A)+P((B \\cap A^c)) \\ge P(A)\n\\]\n\n\n\n証明. 補題 3 が成り立つことを示す。\n補題 2 と同じように確率の大小関係を示す。\n\\((A \\cap B) \\subset A\\) より\\(P(A \\cap B) \\le P(A)\\)\n\\(B\\)についても同様である。\n\n\n\n証明. 補題 4 が成り立つことを示す。\n\\(A\\)を\\((A \\cap B) \\cup (A \\cap B^c)\\)と分割することで、排反なので、定理 3 を使うことができる。 \\[\nP(A)=P((A \\cap B) \\cup (A \\cap B^c))=P(A \\cap B)+P(A \\cap B^c)\n\\]\n\\[\nP(B)=P((A \\cap B) \\cup (B \\cap A^c))=P(A \\cap B)+P(B \\cap A^c)\n\\]\n\\(A \\cup B = (A \\cap B^c) \\cup (A \\cap B) \\cup (B \\cap A^c)\\)であり、それぞれ排反なので、定理 3 を拡張したものより \\(P(A \\cup B) = P(A \\cap B^c) \\cup P(A \\cap B) \\cup P(B \\cap A^c)\\)である。\n\\(P(A)+P(B)\\)すると \\[\nP(A)+P(B)=P(A \\cap B)+P(A \\cap B^c)+P(A \\cap B)+P(B \\cap A^c)=P(A \\cap B)+P(A \\cup B)\n\\]"
  },
  {
    "objectID": "seminar.html",
    "href": "seminar.html",
    "title": "Seminar",
    "section": "",
    "text": "並び替え\n       デフォルト\n         \n          日付 - 日付（昇順）\n        \n         \n          日付 - 日付（降順）\n        \n         \n          題名\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n日付\n\n\n題名\n\n\nstatus\n\n\n\n\n\n\n2024/11/05\n\n\n11月5日　7-4 推定量がUMVUを満たすかどうかの具体例（二項分布・正規分布）\n\n\n作成中\n\n\n\n\n2024/10/29\n\n\n10月29日　不偏分散がカイ二乗分布に従う話\n\n\n完了\n\n\n\n\n2024/10/22\n\n\n10月22日「データ解析のための数理統計入門」第6章 連続補正\n\n\n完了\n\n\n\n\n2024/10/08\n\n\n10月8日「データ解析のための数理統計入門」第5章\n\n\n完了\n\n\n\n\n2024/10/01\n\n\n10月1日「データ解析のための数理統計入門」第4章 4-3条件付き期待値前半\n\n\n完了\n\n\n\n\n2024/07/23\n\n\n7月23日「データ解析のための数理統計入門」第4章 命題4.21\n\n\n完了\n\n\n\n\n2024/07/16\n\n\n7月16日「データ解析のための数理統計入門」第4章 4の例18から\n\n\n完了\n\n\n\n\n2024/07/09\n\n\n7月9日「データ解析のための数理統計入門」第3章 演習問題　７問目\n\n\n完了\n\n\n\n\n2024/07/02\n\n\n7月2日「データ解析のための数理統計入門」第3章 3.1と3.2の途中まで\n\n\n完了\n\n\n\n\n2024/06/25\n\n\n6月25日「データ解析のための数理統計入門」第2章 2.3 確率変数の変数変換\n\n\n完了\n\n\n\n\n2024/06/18\n\n\n6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布\n\n\n完了\n\n\n\n\n2024/06/11\n\n\n6月11日「データ解析のための数理統計入門」第1章 例1.2, 問5\n\n\n完了\n\n\n\n\n\n一致なし"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Hirayama Nanami",
    "section": "",
    "text": "About\n興味、関心、雑記系。\n\n\nSeminar\nゼミの発表資料用。\n\n\nPost\n気になったことや問題を解いたり、探索用。"
  },
  {
    "objectID": "seminar/seminar2024_0702/index.html",
    "href": "seminar/seminar2024_0702/index.html",
    "title": "7月2日「データ解析のための数理統計入門」第3章 3.1と3.2の途中まで",
    "section": "",
    "text": "2つの離散確率変数\\(X\\)と\\(Y\\)がそれぞれ\\(\\mathcal{X} = \\{x_1, x_2, \\ldots\\}\\),\\(\\mathcal{Y} = \\{y_1, y_2, \\ldots\\}\\)に値を取るものとする。\n\\((X,Y)\\)が\\((x_i,y_j)\\)の値を取る同時確率関数は\n\\[\np(x_i,y_j)=P(X=x_i,Y=y_j)\n\\]\nで与えられる。\n\n\n\n\n\n\n\n\n\n\\(P(X=x_i,Y=y_j)\\)とは\n\n\n\n\\(P(X=x_i,Y=y_j)=P(\\{X=x_i\\} \\cap \\{Y=y_j\\})\\)を意味する。\n\n\n\n\n\n\\((X,Y)\\)の周辺確率関数は、\n\\[\\begin{align}\np_X(x_i) = \\sum_{j=1}^\\infty p(x_i,y_j)\\\\\np_Y(y_j) = \\sum_{i=1}^\\infty p(x_i,y_j)\n\\end{align}\\]\n\n\n\n\n\n\nコインを３回投げる時を考える。\n\n\n\n１回目に投げたコインが、表が出たら\\(X=1\\),裏が出たら\\(X=0\\)とする。\n３回投げた時、コインの表が出た合計数を\\(Y\\)とする。\n\\(X,Y\\)はどちらも確率変数である。\\(X,Y\\)の同時確率分布は以下のようになる。\n\n\n\n\n\\[\\begin{array}{c|cccc|c}\n& y_j & & &  \\\\\nx_i & 0 & 1 & 2 & 3 \\\\ \\hline\n0 & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8} & 0 \\\\\n1 & 0 & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8}  \\\\\n\n\\end{array}\\]\n\n\n\n\n\n例えば\n\\[\\begin{equation}\nP(X=1,Y=1)=1/8\n\\end{equation}\\]\n\\(X=1\\)かつ\\(Y=1\\)となるのは、表裏裏の順番で出る時のみである。そのため\\((1/2)^3\\)で計算することができる。\n\n\n\n\\[\\begin{equation}\nP(X=1,Y=2)=1/4\n\\end{equation}\\]\n\\(X=1\\)かつ\\(Y=2\\)となるのは、表表裏・表裏表の順番で出る時である。そのため\\((1/2)^3 \\times 2\\)で計算することができる。\n\n\n\n\n\n\n\\(Y\\)の周辺分布\\(p_Y(y_j)=P(Y=y_j)\\)は以下のようになる。\n\\[\\begin{equation}\np_Y(0)=P(Y=0)=P(X=0,Y=0)+P(X=1,Y=0)=1/8+0=1/8\n\\end{equation}\\]\n\\[\\begin{equation}\np_Y(1)=P(Y=1)=P(X=0,Y=1)+P(X=1,Y=1)=1/4+1/8=3/8\n\\end{equation}\\]\n\\[\\begin{equation}\np_Y(2)=P(Y=2)=P(X=0,Y=2)+P(X=1,Y=2)=1/8+1/4=3/8\n\\end{equation}\\]\n\\[\\begin{equation}\np_Y(3)=P(Y=3)=P(X=0,Y=3)+P(X=1,Y=3)=0+1/8=1/8\n\\end{equation}\\]\n\n\n\n同様に\\(X\\)の周辺分布\\(p_X(x_i)=P(X=x_i)\\)は以下のようになる。\n\\[\\begin{equation}\np_X(0)=P(X=0)=P(X=0,Y=0)+P(X=0,Y=1)+P(X=0,Y=2)+P(X=0,Y=3)=1/8+1/4+1/8+0=1/2\n\\end{equation}\\]\n\\[\\begin{equation}\np_X(1)=P(X=1)=P(X=1,Y=0)+P(X=1,Y=1)+P(X=1,Y=2)+P(X=1,Y=3)=0+1/8+1/4+1/8=1/2\n\\end{equation}\\]\n\n\n\n周辺分布は下の表のように、下側と右側の合計値になります。\n\\[\\begin{array}{c|cccc|c}\n& y_j & & & & \\\\\nx_i & 0 & 1 & 2 & 3 & \\text{合計} \\\\ \\hline\n0 & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8} & 0 & \\frac{1}{2} \\\\\n1 & 0 & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8} & \\frac{1}{2} \\\\ \\hline\n\\text{合計} & \\frac{1}{8} & \\frac{3}{8} & \\frac{3}{8} & \\frac{1}{8} & 1\n\\end{array}\\]\n\n\n\n\n\n\n\n\\(X_1, \\ldots ,X_k\\)を\\(k\\)個の確率変数とする。 \\(X_i\\)の実現値の集合を\\(\\mathcal{X_i}\\)とする。\n\n\n\n\n\n\\((X_1, \\ldots ,X_k)\\)の同時確率関数は、\n\\[\np(x_1,x_2,\\ldots,x_k)=P(X_1=x_1,X_2=x_2,\\ldots,X_k=x_k)\n\\]\nで与えられる。\n\n\n\n\n\n\n例えば、\\(X_1\\)の周辺確率関数は\n\\[\np_{X_1}(x_1)=\\sum_{x_2 \\in \\mathcal{X_2}} \\cdots \\sum_{x_k \\in \\mathcal{X_k}} p(x_1,x_2,\\ldots,x_k)\n\\]\nであり、\\((X_1,X_2)\\)の同時確率関数は次のようになる。\n\\[\np_{X_1,X_2}(x_1,x_2)=\\sum_{x_3 \\in \\mathcal{X_3}} \\cdots \\sum_{x_k \\in\\mathcal{X_k} } p(x_1,x_2,\\ldots,x_k)\n\\]\n\n\n\n\n\n\n\\(\\sum_{x_i \\in X_i}\\)とは\n\n\n\n\\(\\sum_{x_i \\in X_i}\\)は\\(X_i\\)に入るすべての\\(X_i\\)に関して和を取ることを意味する。\n\n\n\n\n\n\n\n\n多次元の離散確率変数の代表例が多項分布である。\n\n\n\nこれは二項分布を一般化した分布であり、例えば\\(m\\)個の面に\\(1\\)から\\(m\\)の番号が書かれた多面体を\\(n\\)回投げて\\(1\\)から\\(m\\)の面が出る回数を\\(X_1,\\ldots,X_m\\)とする。\nそれぞれの面が出る確率を\\(p_1,\\ldots,p_m\\)とすると、\\(p_1+\\cdots+p_m=1\\)であり、\\(X_1+\\cdots+X_m=n\\)である。\n\n\n\nこのとき\\((X_1,\\ldots,X_m)\\)の同時確率関数は次で与えられる。\n\\[\np(x_1,\\ldots,x_m)=\\frac{n!}{x_1! \\cdots x_m!} p_1^{x_1} \\cdots p_m^{x_m}\n\\]\nこの分布を多項分布と呼び、\\(Mult_m(n, p_1, \\ldots, p_m)\\)で表す。\n\n\n\n多項定理において、\\(1=(p_1+ \\cdots +p_m)^n\\)を考えれば確率分布になることがわかる。\n\n\n\n\n\n\n多項定理\n\n\n\n\\[\n(x_1 + x_2 + \\cdots + x_m)^n = \\sum_{k_1 + k_2 + \\cdots + k_m = n} \\frac{n!}{k_1! k_2! \\cdots k_m!} x_1^{k_1} x_2^{k_2} \\cdots x_m^{k_m}\n\\]\n\n\n定理の\\(x\\)を\\(p\\)とし、\\(k\\)を\\(x\\)として考える。このとき同時確率関数の和が1となる。\n\n\n\n\\(i\\)の番号の面が出たら成功、残りを失敗と考えると\\(X_i\\)の周辺分布は二項分布\\(Bin(n,p_i)\\)となる。\n同様に考えて、\\(X_i+X_j \\sim Bin(n,p_i+p_j)\\)となる。これは\\(i,j\\)のどちらかの番号の面が出たら成功、残りを失敗と考えることができるからである。"
  },
  {
    "objectID": "seminar/seminar2024_0702/index.html#同時確率関数と周辺確率関数",
    "href": "seminar/seminar2024_0702/index.html#同時確率関数と周辺確率関数",
    "title": "7月2日「データ解析のための数理統計入門」第3章 3.1と3.2の途中まで",
    "section": "",
    "text": "2つの離散確率変数\\(X\\)と\\(Y\\)がそれぞれ\\(\\mathcal{X} = \\{x_1, x_2, \\ldots\\}\\),\\(\\mathcal{Y} = \\{y_1, y_2, \\ldots\\}\\)に値を取るものとする。\n\\((X,Y)\\)が\\((x_i,y_j)\\)の値を取る同時確率関数は\n\\[\np(x_i,y_j)=P(X=x_i,Y=y_j)\n\\]\nで与えられる。\n\n\n\n\n\n\n\n\n\n\\(P(X=x_i,Y=y_j)\\)とは\n\n\n\n\\(P(X=x_i,Y=y_j)=P(\\{X=x_i\\} \\cap \\{Y=y_j\\})\\)を意味する。\n\n\n\n\n\n\\((X,Y)\\)の周辺確率関数は、\n\\[\\begin{align}\np_X(x_i) = \\sum_{j=1}^\\infty p(x_i,y_j)\\\\\np_Y(y_j) = \\sum_{i=1}^\\infty p(x_i,y_j)\n\\end{align}\\]"
  },
  {
    "objectID": "seminar/seminar2024_0702/index.html#例3.1",
    "href": "seminar/seminar2024_0702/index.html#例3.1",
    "title": "7月2日「データ解析のための数理統計入門」第3章 3.1と3.2の途中まで",
    "section": "",
    "text": "コインを３回投げる時を考える。\n\n\n\n１回目に投げたコインが、表が出たら\\(X=1\\),裏が出たら\\(X=0\\)とする。\n３回投げた時、コインの表が出た合計数を\\(Y\\)とする。\n\\(X,Y\\)はどちらも確率変数である。\\(X,Y\\)の同時確率分布は以下のようになる。\n\n\n\n\n\\[\\begin{array}{c|cccc|c}\n& y_j & & &  \\\\\nx_i & 0 & 1 & 2 & 3 \\\\ \\hline\n0 & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8} & 0 \\\\\n1 & 0 & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8}  \\\\\n\n\\end{array}\\]\n\n\n\n\n\n例えば\n\\[\\begin{equation}\nP(X=1,Y=1)=1/8\n\\end{equation}\\]\n\\(X=1\\)かつ\\(Y=1\\)となるのは、表裏裏の順番で出る時のみである。そのため\\((1/2)^3\\)で計算することができる。\n\n\n\n\\[\\begin{equation}\nP(X=1,Y=2)=1/4\n\\end{equation}\\]\n\\(X=1\\)かつ\\(Y=2\\)となるのは、表表裏・表裏表の順番で出る時である。そのため\\((1/2)^3 \\times 2\\)で計算することができる。\n\n\n\n\n\n\n\\(Y\\)の周辺分布\\(p_Y(y_j)=P(Y=y_j)\\)は以下のようになる。\n\\[\\begin{equation}\np_Y(0)=P(Y=0)=P(X=0,Y=0)+P(X=1,Y=0)=1/8+0=1/8\n\\end{equation}\\]\n\\[\\begin{equation}\np_Y(1)=P(Y=1)=P(X=0,Y=1)+P(X=1,Y=1)=1/4+1/8=3/8\n\\end{equation}\\]\n\\[\\begin{equation}\np_Y(2)=P(Y=2)=P(X=0,Y=2)+P(X=1,Y=2)=1/8+1/4=3/8\n\\end{equation}\\]\n\\[\\begin{equation}\np_Y(3)=P(Y=3)=P(X=0,Y=3)+P(X=1,Y=3)=0+1/8=1/8\n\\end{equation}\\]\n\n\n\n同様に\\(X\\)の周辺分布\\(p_X(x_i)=P(X=x_i)\\)は以下のようになる。\n\\[\\begin{equation}\np_X(0)=P(X=0)=P(X=0,Y=0)+P(X=0,Y=1)+P(X=0,Y=2)+P(X=0,Y=3)=1/8+1/4+1/8+0=1/2\n\\end{equation}\\]\n\\[\\begin{equation}\np_X(1)=P(X=1)=P(X=1,Y=0)+P(X=1,Y=1)+P(X=1,Y=2)+P(X=1,Y=3)=0+1/8+1/4+1/8=1/2\n\\end{equation}\\]\n\n\n\n周辺分布は下の表のように、下側と右側の合計値になります。\n\\[\\begin{array}{c|cccc|c}\n& y_j & & & & \\\\\nx_i & 0 & 1 & 2 & 3 & \\text{合計} \\\\ \\hline\n0 & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8} & 0 & \\frac{1}{2} \\\\\n1 & 0 & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8} & \\frac{1}{2} \\\\ \\hline\n\\text{合計} & \\frac{1}{8} & \\frac{3}{8} & \\frac{3}{8} & \\frac{1}{8} & 1\n\\end{array}\\]"
  },
  {
    "objectID": "seminar/seminar2024_0702/index.html#確率変数が３つ以上のとき",
    "href": "seminar/seminar2024_0702/index.html#確率変数が３つ以上のとき",
    "title": "7月2日「データ解析のための数理統計入門」第3章 3.1と3.2の途中まで",
    "section": "",
    "text": "\\(X_1, \\ldots ,X_k\\)を\\(k\\)個の確率変数とする。 \\(X_i\\)の実現値の集合を\\(\\mathcal{X_i}\\)とする。\n\n\n\n\n\n\\((X_1, \\ldots ,X_k)\\)の同時確率関数は、\n\\[\np(x_1,x_2,\\ldots,x_k)=P(X_1=x_1,X_2=x_2,\\ldots,X_k=x_k)\n\\]\nで与えられる。\n\n\n\n\n\n\n例えば、\\(X_1\\)の周辺確率関数は\n\\[\np_{X_1}(x_1)=\\sum_{x_2 \\in \\mathcal{X_2}} \\cdots \\sum_{x_k \\in \\mathcal{X_k}} p(x_1,x_2,\\ldots,x_k)\n\\]\nであり、\\((X_1,X_2)\\)の同時確率関数は次のようになる。\n\\[\np_{X_1,X_2}(x_1,x_2)=\\sum_{x_3 \\in \\mathcal{X_3}} \\cdots \\sum_{x_k \\in\\mathcal{X_k} } p(x_1,x_2,\\ldots,x_k)\n\\]\n\n\n\n\n\n\n\\(\\sum_{x_i \\in X_i}\\)とは\n\n\n\n\\(\\sum_{x_i \\in X_i}\\)は\\(X_i\\)に入るすべての\\(X_i\\)に関して和を取ることを意味する。\n\n\n\n\n\n\n\n\n多次元の離散確率変数の代表例が多項分布である。\n\n\n\nこれは二項分布を一般化した分布であり、例えば\\(m\\)個の面に\\(1\\)から\\(m\\)の番号が書かれた多面体を\\(n\\)回投げて\\(1\\)から\\(m\\)の面が出る回数を\\(X_1,\\ldots,X_m\\)とする。\nそれぞれの面が出る確率を\\(p_1,\\ldots,p_m\\)とすると、\\(p_1+\\cdots+p_m=1\\)であり、\\(X_1+\\cdots+X_m=n\\)である。\n\n\n\nこのとき\\((X_1,\\ldots,X_m)\\)の同時確率関数は次で与えられる。\n\\[\np(x_1,\\ldots,x_m)=\\frac{n!}{x_1! \\cdots x_m!} p_1^{x_1} \\cdots p_m^{x_m}\n\\]\nこの分布を多項分布と呼び、\\(Mult_m(n, p_1, \\ldots, p_m)\\)で表す。\n\n\n\n多項定理において、\\(1=(p_1+ \\cdots +p_m)^n\\)を考えれば確率分布になることがわかる。\n\n\n\n\n\n\n多項定理\n\n\n\n\\[\n(x_1 + x_2 + \\cdots + x_m)^n = \\sum_{k_1 + k_2 + \\cdots + k_m = n} \\frac{n!}{k_1! k_2! \\cdots k_m!} x_1^{k_1} x_2^{k_2} \\cdots x_m^{k_m}\n\\]\n\n\n定理の\\(x\\)を\\(p\\)とし、\\(k\\)を\\(x\\)として考える。このとき同時確率関数の和が1となる。\n\n\n\n\\(i\\)の番号の面が出たら成功、残りを失敗と考えると\\(X_i\\)の周辺分布は二項分布\\(Bin(n,p_i)\\)となる。\n同様に考えて、\\(X_i+X_j \\sim Bin(n,p_i+p_j)\\)となる。これは\\(i,j\\)のどちらかの番号の面が出たら成功、残りを失敗と考えることができるからである。"
  },
  {
    "objectID": "seminar/seminar2024_0702/index.html#連続確率変数の同時確率密度関数と周辺確率密度関数",
    "href": "seminar/seminar2024_0702/index.html#連続確率変数の同時確率密度関数と周辺確率密度関数",
    "title": "7月2日「データ解析のための数理統計入門」第3章 3.1と3.2の途中まで",
    "section": "連続確率変数の同時確率密度関数と周辺確率密度関数",
    "text": "連続確率変数の同時確率密度関数と周辺確率密度関数\n2つの連続確率変数\\(X\\)と\\(Y\\)が\\(x-y\\)平面\\(\\mathbb{R}^2\\)上に値をとり、平面上の任意の集合\\(A\\) に対して、\n\\[\nP((X,Y) \\in A) = \\int \\int_A f(x,y)dxdy\n\\]\nと表される時、\\(f(x,y)\\)を\\((X,Y)\\)の同時確率密度関数と呼ぶ。\n\n\n\nこれは\\(f(x,y) \\ge 0,\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)dxdy=1\\)を満たす。\n\n\n\n\\(A\\)として、\\(A=\\{(X,Y) \\in \\mathbb{R}^2| X \\le x,Y \\le y\\}\\)とおくと\n\\[\nF(x,y) =P(X \\le x, Y \\le y) = \\int_{-\\infty}^y\\int_{-\\infty}^x f(u,v)dudv\n\\tag{1}\\]\nと表せる。２次元の累積分布関数と呼ぶ。微積分の基本公式から、\n\\[\nf(x,y)=\\frac{\\partial^2}{\\partial x \\partial y}F(x,y)\n\\]\nが成り立つ。また、\\(X,Y\\)の周辺確率密度関数は次で与えられる。\n\\[\nf_X(x)=\\int_{-\\infty}^\\infty f(x,y)dy,\nf_Y(y)=\\int_{-\\infty}^\\infty f(x,y)dx\n\\tag{2}\\]"
  },
  {
    "objectID": "seminar/seminar2024_0702/index.html#例3.2",
    "href": "seminar/seminar2024_0702/index.html#例3.2",
    "title": "7月2日「データ解析のための数理統計入門」第3章 3.1と3.2の途中まで",
    "section": "例3.2",
    "text": "例3.2\n\n設定\n\\(0 \\le c \\le 1\\)を満たす実数\\(c\\)に対して、連続確率変数\\((X,Y)\\)の同時確率密度関数が、\n\\[\nf(x,y)=1-c+4cxy, 0 \\le x \\le 1, 0 \\le y \\le 1\n\\]\nで与えられるとする。\n\n\n\n\n\n求めること\n\n累積分布関数を求める\n周辺確率密度関数を求める\n\\(c \\le X \\le\\)かつ\\(0 \\le Y \\le c-1\\)の時の確率をもとめる。\n\n\n\n\n\n求めること1\n分布関数\\(F(x,y)\\)は\\(0 \\le x \\le 1, 0 \\le y \\le 1\\)に対して、式 1 より\n\\[\nF(x,y)=\\int^y_0 \\int^x_0 (1-c+4cuv)dudv = \\int^y_0 \\{(1-c)x+2cx^2v\\}dv\n=xy(1-c+cxy)\n\\]\n\n\n\n\n\n求めること2\n\nシンプルな求め方\n式 2 より同時確率密度関数から周辺確率密度関数を求めることができる。\n\\[\nf_X(x)=\\int_{0}^1 (1-c+4cxy)dy = [(1-c)y+2cxy^2]^1_0=1-c+2cx\n\\]\n\\[\nf_Y(y)=\\int_{0}^1 (1-c+4cxy)dx = [(1-c)x+2cxy^2]^1_0=1-c+2cy\n\\]\n\n\n\n\n\n教科書の求め方\n\\(X,Y\\)の周辺分布関数は\n\\[\nF_X(x)=F(x,1)=x(1-c+cx),\nF_Y(y)=F(1,y)=y(1-c+cy)\n\\]\nとなり、これを微分することで周辺確率密度関数を求めることができる。\n\\[\nf_X(x)=1-c+2cx,\nf_Y(y)=1-c+2cy\n\\]\nが得られる。\n\n\n\n\n\n\n求めること3\n\\[\nP(c &lt; X &lt; 1,0&lt;Y&lt;1-c)=F(1,1-c)-F(1,0)-F(c,1-c)+F(c,0)=(1-c)^2(1-c^3)=(1-c)^3(1+c+c^2)\n\\]"
  },
  {
    "objectID": "seminar/seminar2024_0625/index.html",
    "href": "seminar/seminar2024_0625/index.html",
    "title": "6月25日「データ解析のための数理統計入門」第2章 2.3 確率変数の変数変換",
    "section": "",
    "text": "連続確率変数\\(X\\)が与えられた時,\\(Y=g(X)\\)となる確率変数\\(Y\\)の確率密度関数や累積分布関数を求めることができる!\n例：\\(Y=2X+4\\)の確率密度関数や累積分布関数を,\\(X\\)の確率密度関数\\(f(x)\\)や累積分布関数\\(F(x)\\)から求める."
  },
  {
    "objectID": "seminar/seminar2024_0625/index.html#確率変数の変数変換の大まかな説明",
    "href": "seminar/seminar2024_0625/index.html#確率変数の変数変換の大まかな説明",
    "title": "6月25日「データ解析のための数理統計入門」第2章 2.3 確率変数の変数変換",
    "section": "",
    "text": "連続確率変数\\(X\\)が与えられた時,\\(Y=g(X)\\)となる確率変数\\(Y\\)の確率密度関数や累積分布関数を求めることができる!\n例：\\(Y=2X+4\\)の確率密度関数や累積分布関数を,\\(X\\)の確率密度関数\\(f(x)\\)や累積分布関数\\(F(x)\\)から求める."
  },
  {
    "objectID": "seminar/seminar2024_0625/index.html#yaxbの場合の変数変換",
    "href": "seminar/seminar2024_0625/index.html#yaxbの場合の変数変換",
    "title": "6月25日「データ解析のための数理統計入門」第2章 2.3 確率変数の変数変換",
    "section": "\\(Y=aX+b\\)の場合の変数変換",
    "text": "\\(Y=aX+b\\)の場合の変数変換\n\n\n\n\\(X\\)の確率密度関数を\\(f_X(x)\\),累積分布関数を\\(F_X(x)\\) で表す。 また,\\(Y=g(X)\\) とおき,\\(Y\\)の確率密度関数を\\(f_Y(y)\\),累積分布関数を\\(F_Y(y)\\) で表す。\n\n\n\n実数\\(a,b\\)に対して\\(Y=aX+b\\) となる変換を考える。\n\n\n\n(後でaで割る時に、aが正か負かで不等式の符号が変わるので、先に場合わけしておく)\n\\(a &gt; 0\\)のとき \\[\\begin{align*}\n  F_Y(y)&=P(Y \\leq y) = P(aX+b \\leq y) = P(X \\leq \\frac{y-b}{a}) = F_X(\\frac{y-b}{a}) \\\\\n  f_Y(y)&= \\frac{d}{dy} F_X (\\frac{y-b}{a}) = \\frac{1}{a}f_X(\\frac{y-b}{a})\n\\end{align*}\\]\n\\(a &lt; 0\\)のとき \\[\\begin{align*}\n  F_Y(y)&=P(Y \\leq y) = P(aX+b \\leq y) = P(X \\geq \\frac{y-b}{a}) =   1-F_X(\\frac{y-b}{a}) \\\\\n  f_Y(y)&= -\\frac{d}{dy} F_X (\\frac{y-b}{a}) = -\\frac{1}{a}f_X(\\frac{y-b}{a})\n\\end{align*}\\]\n\n\n\nよって,全ての実数\\(a\\)に対して次の式が成り立つ。\n\\[\n  \\mathbf{f_Y(y) = \\frac{1}{|a|} f_X(\\frac{y-b}{a})}\n\\tag{1}\\]"
  },
  {
    "objectID": "seminar/seminar2024_0625/index.html#yaxbの場合の変数変換と正規分布標準正規分布",
    "href": "seminar/seminar2024_0625/index.html#yaxbの場合の変数変換と正規分布標準正規分布",
    "title": "6月25日「データ解析のための数理統計入門」第2章 2.3 確率変数の変数変換",
    "section": "\\(Y=aX+b\\)の場合の変数変換と正規分布・標準正規分布",
    "text": "\\(Y=aX+b\\)の場合の変数変換と正規分布・標準正規分布\n正規分布\n\\(X \\sim \\mathcal{N}(\\mu, \\sigma^2)\\)とする.\n\\[\\begin{equation*}\n  f_X(x)= \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\lbrace{-\\frac{(x-\\mu)^2}{2\\sigma^2}}\\rbrace\n\\end{equation*}\\]\n\n\n\n正規分布を位置尺度変換する\n\\(Y=aX+b\\) の確率密度関数は 式 1 より\n\\[\\begin{equation*}\n  f_Y(y)= \\frac{1}{\\sqrt{2\\pi}|a|\\sigma} \\exp\\lbrace{-\\frac{(y-b-a\\mu)^2}{\\color{red}\n2\\color{black}a^2\\sigma^2}}\\rbrace\n\\end{equation*}\\]\nと書ける.\n\n\n\n次の命題が成り立つ.\n命題2.1.5 \\(X \\sim \\mathcal{N}(\\mu, \\sigma^2)\\)とする.\\(Y=aX+b\\)とおくと,\\(Y \\sim \\mathcal{N}(a\\mu+b, a^2\\sigma^2)\\) となる.また,\\(Z=(X-\\mu)/\\sigma\\) とおくと \\(Z \\sim \\mathcal{N}(0, 1)\\) となる。\n\n\n\n命題2.1.5を用いて正規分布における確率を求める方法\n\\(X\\)が正規分布\\(\\mathcal{N}(\\mu, \\sigma^2)\\)に従うとき,実数\\(x_1,x_2(x_1 &lt; x_2)\\) に対する確率\\(P(x_1&lt;X&lt;x_2)\\) を以下のように求める.\n\\[\\begin{align*}\n  P(x_1 &lt; X &lt; x_2) &= P(\\frac{x_1 - \\mu}{\\sigma} &lt; Z &lt; \\frac{x_2 - \\mu}{\\sigma} ) \\\\\n  &= P(Z&lt;\\frac{x_2-\\mu}{\\sigma}) - P(Z&lt;\\frac{x_1-\\mu}{\\sigma}) \\\\\n  &= \\Phi(Z&lt;\\frac{x_2-\\mu}{\\sigma})-\\Phi(Z&lt;\\frac{x_1-\\mu}{\\sigma})\n\\end{align*}\\]\n正規分布を標準正規分布に標準化することで,確率を求めることができる!\n(p55の標準化につながる.)\n\n\n\n命題2.1.6 \\(X\\)を確率密度関数\\(f_X(x)\\)をもつ連続確率変数とし,\\(g(x)\\)を,\\(f_X(x)\\neq0\\)になる\\(x\\)の範囲で単調増加もしくは単調減少する関数とする.\\(Y=g(X)\\)とおくとき,\\(Y\\)の確率密度関数は,\n\\[\n  f_Y(y)=f_X(g^{-1}(y))|\\frac{d}{dy}g^{-1}(y)|\n\\tag{2}\\]\nここで,\\(g^{-1}(y)\\)は\\(y=g(x)\\)の逆関数であり,\n\\[\n  \\frac{d}{dy}g^{-1}(y) = \\frac{1}{g'(g^{-1}(y))}\n\\tag{3}\\]\nという等式が成り立つ.\n\\(g(x)\\)が単調増加関数であるとすると,1対1関数になるので逆関数\\(g^{-1}(y)\\)がとれる.\n\\(g(x)\\) が単調増加の場合 \\[\\begin{equation*}\nF_Y(y)=P(Y \\leq y) = P(g(X) \\leq y) = P(X \\leq g^{-1}(y)) =F_X(g^{-1}(y))\n\\end{equation*}\\]\n\\[\\begin{align*}\n  f_Y(y)&=\\frac{d}{dy}F_Y(y) = \\frac{d}{dy}F_X(g^{-1}(y)) = \\frac{d}{dx}F_X(x)|_{x=g^{-1}(y)}\\frac{d}{dy}g^{-1}(y) \\\\\n  &=f_X(g^{-1}(y)) \\frac{d}{dy}g^{-1}(y)\n\\end{align*}\\]\n\\(g(x)\\) が単調減少の場合\n\\[\\begin{align*}\nF_Y(y)&=  P(g{X} \\leq y) = P(X \\geq g^{-1}(y)) =1-F_X(g^{-1}(y)) \\\\\nf_Y(y)&=-f_X(g^{-1}(y)) \\frac{d}{dy}g^{-1}(y)=f_X(g^{-1}(y)) |\\frac{d}{dy}g^{-1}(y)|\n\\end{align*}\\]\n単調減少の時,\\(g^{-1}(x)\\)は負になるので、絶対値を取ると一般化できる。\nよって、式 2 が成り立つ。\n式 3 について,\n\\[\\begin{align*}\n  y=g(x) \\\\\n  1 = g'(x)(dx/dy)\n\\end{align*}\\]\n\\(x=g^{-1}(y)\\)を代入する. \\[\\begin{equation*}\n  1 = g'(g^{-1}(y))\\frac{d}{dy} g^{-1}(y)\n\\end{equation*}\\]\n式 3 が成り立つので,逆関数の微分の計算が可能になる."
  },
  {
    "objectID": "seminar/seminar2024_1001/index.html",
    "href": "seminar/seminar2024_1001/index.html",
    "title": "10月1日「データ解析のための数理統計入門」第4章 4-3条件付き期待値前半",
    "section": "",
    "text": "条件付き確率分布に関する期待値を条件付き期待値と言います。\n\n\n\n\n定義4.9（条件付き期待値）\n\n二つの確率変数\\(X,Y\\)と関数\\(g(X)\\)を考える。\n(A)離散確率変数の場合\n\\(Y=y_i\\) を与えた時の\\(X\\)の条件付き確率関数 \\(p_{X|Y}(x_j|y_i)\\) で表すと、\\(Y=y_i\\)を与えた時の\\(g(X)\\)の条件付き期待値は\n\\[\nE[g(X)|Y=y_i]= \\sum_{j=1}^{\\infty} g(x_j) p_{X|Y}(x_j|y_i)\n\\]\n\n\n\n(B)連続確率変数の場合\n\\(Y=y\\) を与えた時の\\(X\\)の条件付き確率密度関数 \\(f_{X|Y}(x|y)\\) で表すと、\\(Y=y\\) を与えた時の \\(g(X)\\) の条件付き期待値は\n\\[\nE[g(X)|Y=y]= \\int_{-\\infty}^{\\infty} g(x_j) f_{X|Y}(x|y)dx\n\\]\n\n\n\n\\(Y=y\\) を与えた時の\\(X\\)の条件付き平均\\(E[X|Y=y]\\) 、条件付き分散 \\(Var[X|Y=y]=E[(X-E[X|Y=y])^2|Y=y]\\) と表される。\n周辺分布の平均と分散を求める際、条件付き平均や条件付き分散を求める方が易しくなる場合がある。 →5章ででくるらしいです。\n\n\n\n\n命題4.10 条件付き期待値の性質\n\n⑴繰り返し期待値の法則\n\\[\nE[X]=E[E[X|Y]]\n\\]\n右辺については、まず\\(E[X|Y=y]\\) を求め、次に\\(y\\) を\\(Y\\)で置き換えて\\(Y\\) に関して期待値を取ることを意味する。\n\n\n\n⑴証明\n連続分布の場合、右辺\n\\[\\begin{align}\nE[E[X|Y]]&= \\int_{-\\infty}^{\\infty} \\{\\int_{-\\infty}^{\\infty} x f_{X|Y}(x|y)dx\\} f_Y(y)dy \\\\\n&= \\int_{-\\infty}^{\\infty}x \\int_{-\\infty}^{\\infty}  f_{X|Y}(x|y)f_Y(y)dy dx \\\\\n&= \\int_{-\\infty}^{\\infty}x \\int_{-\\infty}^{\\infty} \\frac{f(x,y)}{f_Y(y)} f_Y(y)dy dx \\\\\n&= \\int_{-\\infty}^{\\infty}x \\int_{-\\infty}^{\\infty} f(x,y)dydx \\\\\n&= \\int_{-\\infty}^{\\infty}x f_X(x) dx \\\\\n&= E[X]\n\\end{align}\\]\nおそらく離散分布の場合は右辺は下のようになる。\n\\[\\begin{align}\nE[E[X|Y]]&= \\sum_{i=1}^{\\infty} \\{\\sum_{j=1}^{\\infty} x_j p_{X|Y}(x_j|y_i)\\} p_Y(y_i) \\\\\n&= \\sum_{j=1}^{\\infty} x_j \\sum_{i=1}^{\\infty}  p_{X|Y}(x_j|y_i) p_Y(y_i) \\\\\n&= \\sum_{j=1}^{\\infty} x_j \\sum_{i=1}^{\\infty}   \\frac{p(x_j,y_i)}{p_Y(y_i)} p_Y(y_i) \\\\\n&= \\sum_{j=1}^{\\infty} x_j \\sum_{i=1}^{\\infty}   p(x_j,y_i) \\\\\n&= \\sum_{j=1}^{\\infty} x_j p_X(x_j) \\\\\n&= E[X]\n\\end{align}\\]"
  },
  {
    "objectID": "seminar/seminar2024_1022/index.html",
    "href": "seminar/seminar2024_1022/index.html",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "確率変数\\(X \\sim Bin(n,p)\\) に従うとする。整数\\(m_1,m_2\\) が\\(0 \\leq m_1 \\leq m_2 \\leq n\\) を満たす時、確率\\(P(m_1 \\leq X \\leq m_2 )\\) の近似値を中心極限定理を用いて求めることを考える。\n\n\n\n\\(X\\) はベルヌーイ分布に従う\\(n\\) 個の独立な確率変数の和で表される1ので、\\(n\\) が大きい時は中心極限定理が適用できて、\\((X-np)/\\sqrt{np(1-p)}\\) は標準正規分布で近似できる。\n1 \\(X_i \\sim Ber(p)\\) にそれぞれ従う時、\\(X=X_1+X_2+ \\cdots + X_n\\) とすると、和の分布である\\(X\\) は二項分布に従う。p18の定義にも書いてある。\\(X=X_1+X_2+ \\cdots + X_n\\) とすると、それぞれ独立に \\(X_i \\sim Ber(p)\\) より、\\(E[X_i]=p\\)、\\(V[X_i]=p(1-p)\\) になる。これを用いて、中心極限定理を適用すると、\n\\[\n\\frac{\\sqrt{n}(\\overline{X} - \\mu) }{\\sigma} = \\frac{\\sqrt{n}(\\frac{1}{n}(X_1+X_2+ \\cdots + X_n) - p) }{\\sqrt{p(1-p)}}= \\frac{\\frac{1}{\\sqrt{n}}(X - np) }{\\sqrt{p(1-p)}}=\\frac{X - np }{\\sqrt{np(1-p)}}\n\\]\nと計算されるので、\\(\\frac{X - np }{\\sqrt{np(1-p)}} \\sim N(0,1)\\) である。この形は、確率変数\\(X\\) を\\(E[X]=np\\),\\(V[X]=np(1-p)\\) で標準化しているともとれる2ので、\\(X \\sim Bin(n,p)\\) は\\(X \\sim N(np,np(1-p))\\) に近似できると考えることができるはず。\n2 \\(X \\sim N(\\mu,\\sigma^2)\\) を\\(Y=aX+b\\) という変換で考えると、\\(Y \\sim N(a \\mu +b, a^2 \\sigma^2)\\) で考えることもできるはず。p35の命題2.15参照。\n\n\nしたがって、\n\\[\nP(m_1 \\leq X \\leq m_2 ) \\approx \\Phi(\\frac{m_2-np}{\\sqrt{np(1-p)}})-\\Phi(\\frac{m_1-np}{\\sqrt{np(1-p)}})\n\\]\nのように近似し、標準正規分布の分布関数 \\(\\Phi(\\cdot)\\) を用いて確率を計算することができる。\nしかし、\\(m_1,m_2\\) が整数であるから\\(X=m_1,X=m_2\\) で確率を持つことになる。3 図6.2が示唆するように、\\(m_1 \\leq X \\leq m_2\\) の確率を考えるより\\(m_1-0.5 \\leq X \\leq m_2+0.5\\) の確率を求めた方が近似が良くなることが知られている。\n3 正規分布は連続変数だから、m_1,m_2では0になるってことを言ってるのかな？\\[\nP(m_1 \\leq X \\leq m_2 ) \\approx \\Phi(\\frac{m_2+0.5-np}{\\sqrt{np(1-p)}})-\\Phi(\\frac{m_1-0.5-np}{\\sqrt{np(1-p)}})\n\\]\nで近似する。これを連続補正と呼ぶ。\nサイコロを120回投げて6の目が25回以上30回以下でる正確な確率は\\(P(25 \\leq Y_{120} \\leq 30)=0.129\\) であるが、通常の正規近似では\\(0.103\\), 連続補正した正規近似では\\(0.130\\) となり連続補正した方が近似が良いことがわかる。\n\n\nコード\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom scipy import stats\n\nn = 120  # 試行回数\np = 1/6  # 確率\nx = np.arange(n + 1)\n\nbars = plt.bar(x, stats.binom.pmf(x, n, p), color='blue')\n\nfor i in range(25, 31):\n    bars[i].set_color('red')  \n\nplt.xlim(0, 35)\n\nplt.xlabel('number of successes')\nplt.ylabel('probability')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nコード\nimport math\n\np_25_30 = 0\n\nfor i in range(25, 31):\n  p_25_30 = p_25_30 + math.factorial(120)/(math.factorial(i)*math.factorial(120-i)) * ((1/6)**i)*((5/6)**(120-i))\n\nprint(p_25_30)\n\n\n0.12893057190612908\n\n\n\n\nコード\nfrom scipy import stats\n\nstats.binom.cdf(30,120,1/6)-stats.binom.cdf(24,120,1/6)\n\n\n0.12893057190612855\n\n\n\n\n\n\n\nコード\nfrom scipy.stats import norm\n\np_25_30_norm = norm.cdf(x = 30, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = 25, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm)\n\n\n0.10318274174220854\n\n\n\n\n\n\n\nコード\nfrom scipy.stats import norm\n\np_25_30_norm_hosei = norm.cdf(x = (30+1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = (25-1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm_hosei)\n\n\n0.1301159033667233\n\n\n\\[\n\\frac{\\lambda^k}{k!} e^{-\\lambda}\n\\]"
  },
  {
    "objectID": "seminar/seminar2024_1022/index.html#正確な確率python",
    "href": "seminar/seminar2024_1022/index.html#正確な確率python",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nimport math\n\np_25_30 = 0\n\nfor i in range(25, 31):\n  p_25_30 = p_25_30 + math.factorial(120)/(math.factorial(i)*math.factorial(120-i)) * ((1/6)**i)*((5/6)**(120-i))\n\nprint(p_25_30)\n\n\n0.12893057190612908\n\n\n\n\nコード\nfrom scipy import stats\n\nstats.binom.cdf(30,120,1/6)-stats.binom.cdf(24,120,1/6)\n\n\n0.12893057190612855"
  },
  {
    "objectID": "seminar/seminar2024_1022/index.html#通常の正規近似python",
    "href": "seminar/seminar2024_1022/index.html#通常の正規近似python",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nfrom scipy.stats import norm\n\np_25_30_norm = norm.cdf(x = 30, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = 25, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm)\n\n\n0.10318274174220854"
  },
  {
    "objectID": "seminar/seminar2024_1022/index.html#連続補正した正規近似python",
    "href": "seminar/seminar2024_1022/index.html#連続補正した正規近似python",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nfrom scipy.stats import norm\n\np_25_30_norm_hosei = norm.cdf(x = (30+1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = (25-1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm_hosei)\n\n\n0.1301159033667233\n\n\n\\[\n\\frac{\\lambda^k}{k!} e^{-\\lambda}\n\\]"
  },
  {
    "objectID": "seminar/seminar2024_1105/index.html",
    "href": "seminar/seminar2024_1105/index.html",
    "title": "11月5日　7-4 推定量がUMVUを満たすかどうかの具体例（二項分布・正規分布）",
    "section": "",
    "text": "２項分布\n\\(X \\sim Bin(n,p)\\)とする。\nまず二項分布における\\(p\\) の推定量を\\(\\displaystyle \\hat{p}=\\frac{X}{n}\\) とおく。 \\(\\displaystyle E_p[\\hat{p}] = \\frac{E_p[X]}{n}=\\frac{np}{n}=p\\) より不偏推定量である。\nちなみに不偏推定量の定義は、以下である。\n\n定理 1 \n\\(\\hat{\\theta}\\) が不偏推定量であるとは\n\\[\nE_\\theta[\\hat{\\theta}(X)] = \\theta, \\quad \\delta\\theta\n\\]\nが成り立つことである。\n\n\n\n\n\n不偏推定量 \\(\\displaystyle \\hat{p}=\\frac{X}{n}\\) がUMVUであることを示すには、次の等式を満たす。\n\n定理 2 (クラメル・ラオの不等式を用いたUMVUの証明) \n不偏推定量\\(\\hat{\\theta^*}\\) が\n\\[\nVar_\\theta[\\hat{\\theta^*}] = \\frac{1}{I_n(\\theta)},\\quad \\delta\\theta\n\\]\nを満たせば、\\(\\hat{\\theta*}\\)はUMVUである。\n\nつまり、\\(\\displaystyle Var_\\theta \\left[\\hat{p}\\right] = \\frac{1}{I_n(\\theta)}\\) であることを示したい。\n\n\n\n\nまず、推定量の分散は\\(\\displaystyle Var[\\hat{p}]=\\frac{Var[X]}{n^2}=\\frac{p(1-p)}{n}\\) である。\n\n\n\n次にフィッシャー情報量\\(I_n(\\theta)\\)を求めたい。\n\n定理 3 (フィッシャー情報量の求め方) \n\\(\\ell'(\\theta,X)\\)は対数充度関数\\(\\ell(\\theta,X)\\) を\\(\\theta\\) で微分したものである。\n\\[\nI_n(\\theta) = E_\\theta \\left[(\\ell'(\\theta,X)^2)\\right]\n\\]\n\n\n２項分布の確率変数 \\(f(x,p)=p^x(1-p)^{n-x}\\begin{pmatrix}\nn  \\\\\nx  \\\\\n\\end{pmatrix}\\)の対数を\\(p\\) で微分すると\n\\[\n\\begin{aligned}\n    \\ell'(p, x) &= \\frac{\\partial}{\\partial p} \\left( x \\log p + (n - x) \\log (1 - p) + \\log \\binom{n}{x} \\right) \\\\\n    &= \\frac{x}{p}+\\frac{-(n-x)}{1-p} = \\frac{x-np}{p(1-p)}\n\\end{aligned}\n\\]\nとなる。従ってフィッシャー情報量は\n\\[\nI(p)=E[\\ell'(p,X)^2]=\\frac{E[(X-np)^2]}{(p(1-p))^2} =\\frac{np(1-p)}{(p(1-p))^2} = \\frac{n}{p(1-p)}\n\\]\nとなり、これは\\(\\displaystyle \\frac{1}{Var_p[\\hat{p}]}\\) に一致する。したがって\\(\\hat{p}\\)は\\(UMVU\\)であることが確かめられた。\n\\(E[(X-np)^2]\\)はテクニカル！\n\n\n\n正規分布\n次に正規分布の母平均\\(\\mu\\)の推定において標本平均\\(\\bar{X}\\) がUMVUであることを示す。\nまず、\\(\\mu\\) に関するフィッシャー情報量を求める。\n\\[\n\\ell(\\mu,x)= - \\frac{(x-\\mu)^2}{2\\sigma^2} - \\frac{1}{2} \\log(2\\pi \\sigma^2)\n\\]\nを\\(\\mu\\) で偏微分すると\\(\\displaystyle \\ell'(\\mu,x)=\\frac{x-\\mu}{\\sigma^2}\\) を得る。したがって、\n\\[\nI(\\mu)=\\frac{E[(X-\\mu)^2]}{\\sigma^4} = \\frac{1}{\\sigma^2}\n\\]\nとなり、\\(\\bar{X}\\) がUMVUであることが示された。\n\\(E[(X-\\mu)^2]\\)もテクニカル！"
  },
  {
    "objectID": "seminar/seminar2024_0611/index.html",
    "href": "seminar/seminar2024_0611/index.html",
    "title": "6月11日「データ解析のための数理統計入門」第1章 例1.2, 問5",
    "section": "",
    "text": "教室にいる40人の人の中に同じ誕生日の人がいる確率を考える. 感覚的には同じ誕生日の人はあまりいないように思える. しかし、同じ誕生日の人がいる確率を計算すると80％を超えるのである.\n\n\n\nクラスの中に同じ人がいる事象を\\(A\\) とすると、同じ人がいる確率は\\(P(A)\\)である。\\(A^c\\) は同じ人がいない事象であり、\\(P(A^c)\\) を求める。\n\\(n\\)人いるとすると,\n\\[\\begin{align*}\n    &P(A^c) = \\frac{365 \\times 364 \\times 363 \\times \\cdots \\times (365 - n + 1)}{365^n} \\\\\n    &1 - P(A^c) = 1 - \\frac{365 \\times 364 \\times 363 \\times \\cdots \\times (365 - n + 1)}{365^n}\n\\end{align*}\\]\nよって\\(n=40\\) の時、\\(P(A)=0.89\\) となる.\n\n\n\n\\(t\\)が0~10の時,誕生日が同じ人がいない確率をpythonで求める.\n\n\nコード\nt = 1\n\nfor x in range(10):\n    t = t * (365 - x) / 365\n    print(t)\n\n\n1.0\n0.9972602739726028\n0.9917958341152185\n0.9836440875334497\n0.9728644263002063\n0.9595375163508884\n0.9437642969040244\n0.9256647076483308\n0.905376166110833\n0.8830518222889221\n\n\n\\(t\\)が0~10の時,誕生日が同じ人がいる確率は,以下で求めることができる.\n\n\nコード\nt = 1\n\nfor x in range(10):\n    t = t * (365 - x) / 365\n    print(f'{x+1}人の時 {1-t}')\n\n\n1人の時 0.0\n2人の時 0.002739726027397249\n3人の時 0.008204165884781456\n4人の時 0.016355912466550326\n5人の時 0.02713557369979369\n6人の時 0.04046248364911165\n7人の時 0.05623570309597559\n8人の時 0.07433529235166925\n9人の時 0.09462383388916695\n10人の時 0.1169481777110779\n\n\n誕生日が同じ人がいる確率を関数にします.\n\n\nコード\ndef exit_birthday(n):\n  t = 1\n  for x in range(n):\n    t = t * (365 - x) / 365\n    if x == n-1:\n      print(1-t)\n\n\n\n\nコード\nexit_birthday(40)\n\n\n0.891231809817949\n\n\n教科書でわかった通り,約0.89であることがコードからもわかります.\nでは,人数が増えるにつれどのように確率が変化するかをmatplotlibを使って図で示します.\n\n\nコード\nimport matplotlib.pyplot as plt\n\n\ndef exit_birthday_plot(n):\n    t = 1\n    values = []\n\n    for x in range(n):\n        t = t * (365 - x) / 365\n        values.append(1-t)\n    plt.plot(range(n), values, 'o-', label='Probability')\n    plt.savefig('2.png')\n    plt.show()\n\n\nexit_birthday_plot(50)\n\n\n\n\n\n\n\n\n\nすると,50人にもなるとほぼ確率が1であることが図からわかります.つまり,50人もいれば同じ誕生日の人はだいたいいる計算になります."
  },
  {
    "objectID": "seminar/seminar2024_0611/index.html#例1.2-誕生日問題",
    "href": "seminar/seminar2024_0611/index.html#例1.2-誕生日問題",
    "title": "6月11日「データ解析のための数理統計入門」第1章 例1.2, 問5",
    "section": "",
    "text": "教室にいる40人の人の中に同じ誕生日の人がいる確率を考える. 感覚的には同じ誕生日の人はあまりいないように思える. しかし、同じ誕生日の人がいる確率を計算すると80％を超えるのである.\n\n\n\nクラスの中に同じ人がいる事象を\\(A\\) とすると、同じ人がいる確率は\\(P(A)\\)である。\\(A^c\\) は同じ人がいない事象であり、\\(P(A^c)\\) を求める。\n\\(n\\)人いるとすると,\n\\[\\begin{align*}\n    &P(A^c) = \\frac{365 \\times 364 \\times 363 \\times \\cdots \\times (365 - n + 1)}{365^n} \\\\\n    &1 - P(A^c) = 1 - \\frac{365 \\times 364 \\times 363 \\times \\cdots \\times (365 - n + 1)}{365^n}\n\\end{align*}\\]\nよって\\(n=40\\) の時、\\(P(A)=0.89\\) となる.\n\n\n\n\\(t\\)が0~10の時,誕生日が同じ人がいない確率をpythonで求める.\n\n\nコード\nt = 1\n\nfor x in range(10):\n    t = t * (365 - x) / 365\n    print(t)\n\n\n1.0\n0.9972602739726028\n0.9917958341152185\n0.9836440875334497\n0.9728644263002063\n0.9595375163508884\n0.9437642969040244\n0.9256647076483308\n0.905376166110833\n0.8830518222889221\n\n\n\\(t\\)が0~10の時,誕生日が同じ人がいる確率は,以下で求めることができる.\n\n\nコード\nt = 1\n\nfor x in range(10):\n    t = t * (365 - x) / 365\n    print(f'{x+1}人の時 {1-t}')\n\n\n1人の時 0.0\n2人の時 0.002739726027397249\n3人の時 0.008204165884781456\n4人の時 0.016355912466550326\n5人の時 0.02713557369979369\n6人の時 0.04046248364911165\n7人の時 0.05623570309597559\n8人の時 0.07433529235166925\n9人の時 0.09462383388916695\n10人の時 0.1169481777110779\n\n\n誕生日が同じ人がいる確率を関数にします.\n\n\nコード\ndef exit_birthday(n):\n  t = 1\n  for x in range(n):\n    t = t * (365 - x) / 365\n    if x == n-1:\n      print(1-t)\n\n\n\n\nコード\nexit_birthday(40)\n\n\n0.891231809817949\n\n\n教科書でわかった通り,約0.89であることがコードからもわかります.\nでは,人数が増えるにつれどのように確率が変化するかをmatplotlibを使って図で示します.\n\n\nコード\nimport matplotlib.pyplot as plt\n\n\ndef exit_birthday_plot(n):\n    t = 1\n    values = []\n\n    for x in range(n):\n        t = t * (365 - x) / 365\n        values.append(1-t)\n    plt.plot(range(n), values, 'o-', label='Probability')\n    plt.savefig('2.png')\n    plt.show()\n\n\nexit_birthday_plot(50)\n\n\n\n\n\n\n\n\n\nすると,50人にもなるとほぼ確率が1であることが図からわかります.つまり,50人もいれば同じ誕生日の人はだいたいいる計算になります."
  },
  {
    "objectID": "seminar/seminar2024_0611/index.html#問題5-以下の不等式を示せ",
    "href": "seminar/seminar2024_0611/index.html#問題5-以下の不等式を示せ",
    "title": "6月11日「データ解析のための数理統計入門」第1章 例1.2, 問5",
    "section": "問題5 以下の不等式を示せ",
    "text": "問題5 以下の不等式を示せ\n\n\\(P(\\bigcup_{i=1}^n A_i) \\leq \\sum_{i=1}^n P(A_i)\\)\n\\(P(A \\cap B) \\geq P(A) + P(B) - 1\\)\n\n\n1. \\(P(\\bigcup_{i=1}^n A_i) \\leq \\sum_{i=1}^n P(A_i)\\)\n数学的帰納法で示す。\n\\(n=2\\) のときには\n\\[\\begin{equation*}\n    P(A_1 \\cup A_2) = P(A_1) + P(A_2) - P(A_1 \\cap A_2) \\leq P(A_1) + P(A_2)\n\\end{equation*}\\]\nとなり，成立つことがわかる。\n\\(n\\) のとき成立つと仮定すると \\(P(\\bigcup_{i=1}^n A_i) \\leq \\sum_{i=1}^n P(A_i)\\) が成立つ。\nそのとき \\(n+1\\) の時に成り立つ事を示す。\n\\[\\begin{align*}\n    P(\\bigcup_{i=1}^{n+1} A_i) &= P((\\bigcup_{i=1}^n A_i)   \\cup A_{n+1}) \\\\\n    &\\leq P(\\bigcup_{i=1}^n A_i) + P(A_{n+1}) \\\\\n    &\\leq \\sum_{i=1}^n P(A_i) + P(A_{n+1}) \\\\\n    &= \\sum_{i=1}^{n+1} P(A_i)\n\\end{align*}\\]\nとなり，\\(n+1\\) のときにも成立つことがわかる。\n\n\n2. \\(P(A \\cap B) \\geq P(A) + P(B) - 1\\)\n\\[\\begin{equation*}\n    P(A \\cap B) = P(A) + P(B) - P(A \\cup B) \\geq P(A) + P(B) - 1\n\\end{equation*}\\]"
  },
  {
    "objectID": "seminar/seminar2024_1105/index.html#項分布",
    "href": "seminar/seminar2024_1105/index.html#項分布",
    "title": "11月5日　7-4",
    "section": "",
    "text": "\\(X \\sim Bin(n,p)\\)とする。\nまず二項分布における\\(p\\) の推定量を\\(\\displaystyle \\hat{p}=\\frac{X}{n}\\) とおく。 \\(\\displaystyle E_p[\\hat{p}] = \\frac{E_p[X]}{n}=\\frac{np}{n}=p\\) より不偏推定量である。\nちなみに不偏推定量の定義は、以下である。\n\n定理 1 \n\\(\\hat{\\theta}\\) が不偏推定量であるとは\n\\[\nE_\\theta[\\hat{\\theta}(X)] = \\theta, \\quad \\delta\\theta\n\\]\nが成り立つことである。\n\n\n\n\n不偏推定量 \\(\\displaystyle \\hat{p}=\\frac{X}{n}\\) がUMVUであることを示すには、次の等式を満たす。\n\n定理 2 (クラメル・ラオの不等式を用いたUMVUの証明) \n不偏推定量\\(\\hat{\\theta^*}\\) が\n\\[\nVar_\\theta[\\hat{\\theta^*}] = \\frac{1}{I_n(\\theta)},\\quad \\delta\\theta\n\\]\nを満たせば、\\(\\hat{\\theta*}\\)はUMVUである。\n\nつまり、\\(\\displaystyle Var_\\theta \\left[\\hat{p}\\right] = \\frac{1}{I_n(\\theta)}\\) であることを示したい。\n\n\n\nまず、推定量の分散は\\(\\displaystyle Var[\\hat{p}]=\\frac{Var[X]}{n^2}=\\frac{p(1-p)}{n}\\) である。\n\n\n\n次にフィッシャー情報量\\(I_n(\\theta)\\)を求めたい。\n\n定理 3 (フィッシャー情報量の求め方) \n\\(\\ell'(\\theta,X)\\)は対数充度関数\\(\\ell(\\theta,X)\\) を\\(\\theta\\) で微分したものである。\n\\[\nI_n(\\theta) = E_\\theta \\left[(\\ell'(\\theta,X)^2)\\right]\n\\]\n\n２項分布の確率変数 \\(f(x,p)=p^x(1-p)^{n-x}\\begin{pmatrix}\nn  \\\\\nx  \\\\\n\\end{pmatrix}\\)の対数を\\(p\\) で微分すると\n\\[\n\\begin{aligned}\n    \\ell'(p, x) &= \\frac{\\partial}{\\partial p} \\left( x \\log p + (n - x) \\log (1 - p) + \\log \\binom{n}{x} \\right) \\\\\n    &= \\frac{x}{p}+\\frac{-(n-x)}{1-p} = \\frac{x-np}{p(1-p)}\n\\end{aligned}\n\\]\nとなる。従ってフィッシャー情報量は\n\\[\nI(p)=E[\\ell'(p,X)^2]=\\frac{E[(X-np)^2]}{(p(1-p))^2} =\\frac{np(1-p)}{(p(1-p))^2} = \\frac{n}{p(1-p)}\n\\]\nとなり、これは\\(\\displaystyle \\frac{1}{Var_p[\\hat{p}]}\\) に一致する。したがって\\(\\hat{p}\\)は\\(UMVU\\)であることが確かめられた。\n\\(E[(X-np)^2]\\)はテクニカル！"
  },
  {
    "objectID": "seminar/seminar2024_1105/index.html#正規分布",
    "href": "seminar/seminar2024_1105/index.html#正規分布",
    "title": "11月5日　7-4 推定量がUMVUを満たすかどうかの具体例（二項分布・正規分布）",
    "section": "正規分布",
    "text": "正規分布\n次に正規分布の母平均\\(\\mu\\)の推定において標本平均\\(\\bar{X}\\) がUMVUであることを示す。\nまず、\\(\\mu\\) に関するフィッシャー情報量を求める。\n\\[\n\\ell(\\mu,x)= - \\frac{(x-\\mu)^2}{2\\sigma^2} - \\frac{1}{2} \\log(2\\pi \\sigma^2)\n\\]\nを\\(\\mu\\) で偏微分すると\\(\\displaystyle \\ell'(\\mu,x)=\\frac{x-\\mu}{\\sigma^2}\\) を得る。したがって、\n\\[\nI(\\mu)=\\frac{E[(X-\\mu)^2]}{\\sigma^4} = \\frac{1}{\\sigma^2}\n\\]\nとなり、\\(\\bar{X}\\) がUMVUであることが示された。\n\\(E[(X-\\mu)^2]\\)もテクニカル！"
  },
  {
    "objectID": "post/spotify.html",
    "href": "post/spotify.html",
    "title": "SpotifyをPythonで分析",
    "section": "",
    "text": "それぞれの楽曲に対して、danceabilityやenergyなど独特の指標を持ったspotifyAPIを利用して、興味のある曲の分析を行ってみたい。\n例えば。。。\n\n名探偵コナンの主題歌\n\n主題歌歌手\n\n倉木麻衣・B’z・愛内里菜・BREAKERZ が多い印象。歌手の割合。４者で独占されているのでは？\n期間とかもわかるのかな？\n\n曲調の変遷　\n\n昔は切ないラブソング系が多かった印象・最近はパキパキ系が多い印象\n差はあるのか？\n\nアニメ歌手と映画歌手の違い\n\n映画歌手に関しては当時話題の歌手が多い印象。\nアニメ歌手は変遷なく、上で述べた歌手で占めている印象がある。\n\nOPとEDの曲調の違い\n\n\n\n\nK-POPのeasy-listening傾向(特にNew Jeans)\n\nNew Jeansからこの傾向が始まったように思われる。\neasy-listeningって本当にNew Jeansから始まったのかな？→曲調のところで分析できそう\nNew JeansとSpeedって本当に似てるのかな？\nNew Jeansとillitに関しても！\n\n\n\n\n自分のお気に入り曲を操作\n\nお気に入りを抽出して操作が可能なよう。\n曲の雰囲気でソートして、自分が飽きないような配置が作れるかも！（分析とは少し違うけど。）→レコメンドで使われる類似度の指標を自分で作るとか！\nhttps://speakerdeck.com/takemikami/spotify-api-woshi-tutaaimasule-qu-nole-simifang　これみたいな。"
  },
  {
    "objectID": "post/spotify.html#まずは必要なものをimport",
    "href": "post/spotify.html#まずは必要なものをimport",
    "title": "SpotifyをPythonで分析",
    "section": "まずは必要なものをimport!",
    "text": "まずは必要なものをimport!\n\nimport pandas as pd\nimport spotipy\nfrom spotipy.oauth2 import SpotifyClientCredentials\nimport json\nimport os\nfrom dotenv import load_dotenv"
  },
  {
    "objectID": "post/spotify.html#section",
    "href": "post/spotify.html#section",
    "title": "SpotifyをPythonで分析",
    "section": "",
    "text": "client_id = os.getenv('SPOTIFY_CLIENT_ID')\nclient_secret = os.getenv('SPOTIFY_CLIENT_SECRET')\nclient_credentials_manager = spotipy.oauth2.SpotifyClientCredentials(client_id, client_secret)\nspotify = spotipy.Spotify(client_credentials_manager=client_credentials_manager)\nplaylist_url = 'https://open.spotify.com/playlist/6KfKvkN7YEUFTwJHkczxdb?si=5d285aa4dade4002'\nplaylist_id = playlist_url.split('/')[-1].split('?')[0]  #プレイリストIDを取得\n\n# プレイリストの楽曲一覧を取得\nresults = spotify.playlist(playlist_id)\n\n\n# プレイリストから曲を取得\ndef get_to_playlist(playlist_id):\n    playlist = spotify.playlist(playlist_id)\n    track_ids = []\n    for item in playlist['tracks']['items']:\n        track = item['track']\n        if not track['id'] in track_ids:\n            track_ids.append(track['id'])\n        else:\n            for item in playlist['tracks']['items']:\n                track = item['track']\n                if not track['id'] in track_ids:\n                    track_ids.append(track['id'])\n    return track_ids\n\nget_to_playlist(playlist_url.split('/')[-1].split('?')[0])\n\n['2iXZA6Ecf9AZHw92tZBNLv',\n '6NbN52o3yrm9YATy26qALq',\n '2he2DlglI9qP4ouQc1bLoU',\n '5fnZAPIZZbyM0Az0VBYbB4',\n '158ZIi9QJ3jr6LQtPwOnve',\n '16DWmFk1XU0WkhwGlO3Epm',\n '75WKINePeVTeiINVjuGfQN',\n '0mf2l317Gqar2mS1ynEdbd',\n '745ARHLcXTciceuJnpULZz',\n '5VCsbxir29FtbKxQDF1yU9',\n '5OqRZWOCJIbN3owrBDsQXy',\n '7Fwj8A43T7aBKhad9OGBGF',\n '3u924ZVORBYBPETTj6P12m',\n '3d9OJ1YOYegvImn6KSs2zi',\n '3hjHUf3frPoh9jcYDkqXUV',\n '7ml70oBISAOjKyw7wrueI0',\n '2eBIaTAW8i8Q7GMotWojdH',\n '5QAZVZA3FN1s368XgijXHZ',\n '7ah8In0z478pctQnoFvW1L',\n '3doATATHVivzB3EJqZS1eG',\n '5wfKPYODAr3aCGpOAopNZK',\n '1U2eK2hq5rKBWVeyJ3ToV9',\n '23atyJacJVHvB9RHBNhr35',\n '2ZDMVAO7dARwQXnxyxnDsN',\n '6WyjbxHU8cxZnePxuFC79e',\n '2z5hzRdYdxsaiMv5giiDG7',\n '1SlnuvPLppYWh3WWZ0wYT0',\n '1WHEDvZr1RuDR0QdFF5Nx8',\n '6CVOXT79mSNWlahndeRtpq',\n '1C6mGgM8tx4tf7Lofcy92S',\n '5JKxpF4vAhvLNhXDoMfxhs',\n '4R3ew5gcnrrcBBxW5v3E2f',\n '33lzgeuVrql37WmGfVcVp5',\n '6aLnEfXkfdMCIJjxdG7RsC',\n '5zxOkA6L5DJpS0Ajb0Qx2t',\n '67vojPHKOri59M5ZT7I9ar',\n '0CATStPGs7sxXxM7CJLdPa',\n '5Fw07rxmvCU97W1ffx2LaI',\n '0c8zEXqNao1FRqSa022QgV',\n '0SI0Te2JQTMe05NEmNbje6',\n '3w3Fn4KHIQUsQQYFajdMkd',\n '5d2geD5Lin69gQ3xRV86Ty',\n '2nV2YtI6YrE49bmwXa8D51',\n '1jv8fStBVa5PTklNdKltXl',\n '2I8iJxZ6lPcc16EciRCgaO',\n '3g42JFCX8s4SXZ5El3DdFQ',\n '5IwRgi599tbwNi9wqPYyIX',\n '5Qw9zrdPMjZISaWhfpQ6Ro',\n '7zue8Ylpf2O1THzYTBInnj',\n '28NV7pexaSrgQqxize1rav',\n '76fc73uRAcp0psxMuFJHGF',\n '6OitPk0ZtxFg2ixRKV6Y1h',\n '5YgU6ARH4iWPfodTMkHTbR',\n '6MfNf7SLjnJc6lFZrGWg6X',\n '6cDicS4d4wxi6to2nddk9X',\n '2wWXJOOP19PMSShh5TqLFH',\n '4iQXwYTAU3gb60tM8DNjEr',\n '11iclnVVyFH4BarUyOATc1',\n '2ejEiTFhes7jypzKAAvlA6',\n '2j9HruvwFeatEWeHRnEzPI',\n '1j6Zt3I6vwy9L7koZCPqUu',\n '0p5BGKgpW6UPopcUQSo5yn',\n '6Qq8UOS6QzeSYFUVXC5wEB',\n '5mSDLmHru7tWn56FcJQ62M',\n '69lyoI73JEsQr93FXs9CE1',\n '0SKZjKXaUHFIAhHLtAETVM',\n '0ZNcLtK3qkKqzH27ytXyp4',\n '5Q6z8rqbH1CfYaUOqktJbE',\n '3L66hEyARGzUuK97ugVUyy',\n '7fMVp7XPgcIpWOKFlR5LNQ',\n '3JZOw8aQDMeByFTeTIe6Qu',\n '76HZg4s6yjRSfkVAtnI4NW',\n '4aXi3FgnHDF7GxoJEbJLfg',\n '0HO0vfo0CKu3WeCfLZA5iM',\n '0Ns63lt28epRgED3Tnhmth',\n '2EXBFaQXJhHyROLc1ROINt',\n '5ROSTSAuEHPc1fp5SzV4y5',\n '7CKNIPYunPhupoNZXdi4GS',\n '3Y8lx5gWASi8JvQRd1PnNF',\n '4kWPNCY1JZEqJq9Vcjrfpz',\n '10G6iBGzoMi9qXgDV9qyBy',\n '0IaeDUPwt7JGGSKBdVF49Q',\n '7cWujxmEVy0ru9y1uGCs4N',\n '3oTmlZTvrjg9Px3tQq9Rey',\n '2bzdhN6Y5AP1zRRf12QwJq',\n '770OfNzKAmIB086QKEZ0Lz',\n '3r6Am8NvUDbuS2Yqv76ivi',\n '1Rvh5RimhF3ndpclBmIdeJ',\n '1fbnFLdnspYiaQ02nXaiBt',\n '582HjAJ7coEKSYVirUZyqK',\n '2j1ATXoWlhISjUUBeLna87',\n '0vciFgccaS4HTPNGSttKbU',\n '2X0pcKFdtkbjKxtZlyZCkZ',\n '7DAO2wHaB7VFOPioHKxWyT',\n '4WiVQ0PLTYjHiNYUbWpJO9',\n '4KFQ43lyjYoCtaIaeY21VQ',\n '0SGYLDQO06AB2VkGDoAjxW',\n '55kt4XuHNQthnlpnwVRl2J',\n '5lXJfdSxPIvKAO5s903Crr',\n '4zdXDTExh06duqfnyhNx6S']\n\n\n\nmusic_id = \"4zdXDTExh06duqfnyhNx6S\"\nresult = spotify.audio_features(music_id)\nresult\n\n[{'danceability': 0.393,\n  'energy': 0.715,\n  'key': 8,\n  'loudness': -4.105,\n  'mode': 1,\n  'speechiness': 0.0344,\n  'acousticness': 0.343,\n  'instrumentalness': 0,\n  'liveness': 0.112,\n  'valence': 0.374,\n  'tempo': 159.548,\n  'type': 'audio_features',\n  'id': '4zdXDTExh06duqfnyhNx6S',\n  'uri': 'spotify:track:4zdXDTExh06duqfnyhNx6S',\n  'track_href': 'https://api.spotify.com/v1/tracks/4zdXDTExh06duqfnyhNx6S',\n  'analysis_url': 'https://api.spotify.com/v1/audio-analysis/4zdXDTExh06duqfnyhNx6S',\n  'duration_ms': 289867,\n  'time_signature': 4}]"
  },
  {
    "objectID": "post/spotify.html#やりたいこと",
    "href": "post/spotify.html#やりたいこと",
    "title": "SpotifyをPythonで分析",
    "section": "",
    "text": "それぞれの楽曲に対して、danceabilityやenergyなど独特の指標を持ったspotifyAPIを利用して、興味のある曲の分析を行ってみたい。\n例えば。。。\n\n名探偵コナンの主題歌\n\n主題歌歌手\n\n倉木麻衣・B’z・愛内里菜・BREAKERZ が多い印象。歌手の割合。４者で独占されているのでは？\n期間とかもわかるのかな？\n\n曲調の変遷　\n\n昔は切ないラブソング系が多かった印象・最近はパキパキ系が多い印象\n差はあるのか？\n\nアニメ歌手と映画歌手の違い\n\n映画歌手に関しては当時話題の歌手が多い印象。\nアニメ歌手は変遷なく、上で述べた歌手で占めている印象がある。\n\nOPとEDの曲調の違い\n\n\n\n\nK-POPのeasy-listening傾向(特にNew Jeans)\n\nNew Jeansからこの傾向が始まったように思われる。\neasy-listeningって本当にNew Jeansから始まったのかな？→曲調のところで分析できそう\nNew JeansとSpeedって本当に似てるのかな？\nNew Jeansとillitに関しても！\n\n\n\n\n自分のお気に入り曲を操作\n\nお気に入りを抽出して操作が可能なよう。\n曲の雰囲気でソートして、自分が飽きないような配置が作れるかも！（分析とは少し違うけど。）→レコメンドで使われる類似度の指標を自分で作るとか！\nhttps://speakerdeck.com/takemikami/spotify-api-woshi-tutaaimasule-qu-nole-simifang　これみたいな。"
  },
  {
    "objectID": "post/spotify.html#前準備",
    "href": "post/spotify.html#前準備",
    "title": "SpotifyをPythonで分析",
    "section": "前準備",
    "text": "前準備\n\nimport pandas as pd\nimport spotipy\nfrom spotipy.oauth2 import SpotifyClientCredentials\nimport json\nimport os\nfrom dotenv import load_dotenv"
  },
  {
    "objectID": "post/spotify.html#どうしよっかな",
    "href": "post/spotify.html#どうしよっかな",
    "title": "SpotifyをPythonで分析",
    "section": "どうしよっかな〜",
    "text": "どうしよっかな〜\n\nclient_id = os.getenv('SPOTIFY_CLIENT_ID')\nclient_secret = os.getenv('SPOTIFY_CLIENT_SECRET')\nclient_credentials_manager = spotipy.oauth2.SpotifyClientCredentials(client_id, client_secret)\nspotify = spotipy.Spotify(client_credentials_manager=client_credentials_manager)\nplaylist_url = 'https://open.spotify.com/playlist/6KfKvkN7YEUFTwJHkczxdb?si=5d285aa4dade4002'\nplaylist_id = playlist_url.split('/')[-1].split('?')[0]  #プレイリストIDを取得\n\n# プレイリストの楽曲一覧を取得\nresults = spotify.playlist(playlist_id)\n\n\n# プレイリストから曲を取得\ndef get_to_playlist(playlist_id):\n    playlist = spotify.playlist(playlist_id)\n    track_ids = []\n    for item in playlist['tracks']['items']:\n        track = item['track']\n        if not track['id'] in track_ids:\n            track_ids.append(track['id'])\n        else:\n            for item in playlist['tracks']['items']:\n                track = item['track']\n                if not track['id'] in track_ids:\n                    track_ids.append(track['id'])\n    return track_ids\n\nget_to_playlist(playlist_url.split('/')[-1].split('?')[0])\n\n['2iXZA6Ecf9AZHw92tZBNLv',\n '6NbN52o3yrm9YATy26qALq',\n '2he2DlglI9qP4ouQc1bLoU',\n '5fnZAPIZZbyM0Az0VBYbB4',\n '158ZIi9QJ3jr6LQtPwOnve',\n '16DWmFk1XU0WkhwGlO3Epm',\n '75WKINePeVTeiINVjuGfQN',\n '0mf2l317Gqar2mS1ynEdbd',\n '745ARHLcXTciceuJnpULZz',\n '5VCsbxir29FtbKxQDF1yU9',\n '5OqRZWOCJIbN3owrBDsQXy',\n '7Fwj8A43T7aBKhad9OGBGF',\n '3u924ZVORBYBPETTj6P12m',\n '3d9OJ1YOYegvImn6KSs2zi',\n '3hjHUf3frPoh9jcYDkqXUV',\n '7ml70oBISAOjKyw7wrueI0',\n '2eBIaTAW8i8Q7GMotWojdH',\n '5QAZVZA3FN1s368XgijXHZ',\n '7ah8In0z478pctQnoFvW1L',\n '3doATATHVivzB3EJqZS1eG',\n '5wfKPYODAr3aCGpOAopNZK',\n '1U2eK2hq5rKBWVeyJ3ToV9',\n '23atyJacJVHvB9RHBNhr35',\n '2ZDMVAO7dARwQXnxyxnDsN',\n '6WyjbxHU8cxZnePxuFC79e',\n '2z5hzRdYdxsaiMv5giiDG7',\n '1SlnuvPLppYWh3WWZ0wYT0',\n '1WHEDvZr1RuDR0QdFF5Nx8',\n '6CVOXT79mSNWlahndeRtpq',\n '1C6mGgM8tx4tf7Lofcy92S',\n '5JKxpF4vAhvLNhXDoMfxhs',\n '4R3ew5gcnrrcBBxW5v3E2f',\n '33lzgeuVrql37WmGfVcVp5',\n '6aLnEfXkfdMCIJjxdG7RsC',\n '5zxOkA6L5DJpS0Ajb0Qx2t',\n '67vojPHKOri59M5ZT7I9ar',\n '0CATStPGs7sxXxM7CJLdPa',\n '5Fw07rxmvCU97W1ffx2LaI',\n '0c8zEXqNao1FRqSa022QgV',\n '0SI0Te2JQTMe05NEmNbje6',\n '3w3Fn4KHIQUsQQYFajdMkd',\n '5d2geD5Lin69gQ3xRV86Ty',\n '2nV2YtI6YrE49bmwXa8D51',\n '1jv8fStBVa5PTklNdKltXl',\n '2I8iJxZ6lPcc16EciRCgaO',\n '3g42JFCX8s4SXZ5El3DdFQ',\n '5IwRgi599tbwNi9wqPYyIX',\n '5Qw9zrdPMjZISaWhfpQ6Ro',\n '7zue8Ylpf2O1THzYTBInnj',\n '28NV7pexaSrgQqxize1rav',\n '76fc73uRAcp0psxMuFJHGF',\n '6OitPk0ZtxFg2ixRKV6Y1h',\n '5YgU6ARH4iWPfodTMkHTbR',\n '6MfNf7SLjnJc6lFZrGWg6X',\n '6cDicS4d4wxi6to2nddk9X',\n '2wWXJOOP19PMSShh5TqLFH',\n '4iQXwYTAU3gb60tM8DNjEr',\n '11iclnVVyFH4BarUyOATc1',\n '2ejEiTFhes7jypzKAAvlA6',\n '2j9HruvwFeatEWeHRnEzPI',\n '1j6Zt3I6vwy9L7koZCPqUu',\n '0p5BGKgpW6UPopcUQSo5yn',\n '6Qq8UOS6QzeSYFUVXC5wEB',\n '5mSDLmHru7tWn56FcJQ62M',\n '69lyoI73JEsQr93FXs9CE1',\n '0SKZjKXaUHFIAhHLtAETVM',\n '0ZNcLtK3qkKqzH27ytXyp4',\n '5Q6z8rqbH1CfYaUOqktJbE',\n '3L66hEyARGzUuK97ugVUyy',\n '7fMVp7XPgcIpWOKFlR5LNQ',\n '3JZOw8aQDMeByFTeTIe6Qu',\n '76HZg4s6yjRSfkVAtnI4NW',\n '4aXi3FgnHDF7GxoJEbJLfg',\n '0HO0vfo0CKu3WeCfLZA5iM',\n '0Ns63lt28epRgED3Tnhmth',\n '2EXBFaQXJhHyROLc1ROINt',\n '5ROSTSAuEHPc1fp5SzV4y5',\n '7CKNIPYunPhupoNZXdi4GS',\n '3Y8lx5gWASi8JvQRd1PnNF',\n '4kWPNCY1JZEqJq9Vcjrfpz',\n '10G6iBGzoMi9qXgDV9qyBy',\n '0IaeDUPwt7JGGSKBdVF49Q',\n '7cWujxmEVy0ru9y1uGCs4N',\n '3oTmlZTvrjg9Px3tQq9Rey',\n '2bzdhN6Y5AP1zRRf12QwJq',\n '770OfNzKAmIB086QKEZ0Lz',\n '3r6Am8NvUDbuS2Yqv76ivi',\n '1Rvh5RimhF3ndpclBmIdeJ',\n '1fbnFLdnspYiaQ02nXaiBt',\n '582HjAJ7coEKSYVirUZyqK',\n '2j1ATXoWlhISjUUBeLna87',\n '0vciFgccaS4HTPNGSttKbU',\n '2X0pcKFdtkbjKxtZlyZCkZ',\n '7DAO2wHaB7VFOPioHKxWyT',\n '4WiVQ0PLTYjHiNYUbWpJO9',\n '4KFQ43lyjYoCtaIaeY21VQ',\n '0SGYLDQO06AB2VkGDoAjxW',\n '55kt4XuHNQthnlpnwVRl2J',\n '5lXJfdSxPIvKAO5s903Crr',\n '4zdXDTExh06duqfnyhNx6S']\n\n\n\nmusic_id = \"4zdXDTExh06duqfnyhNx6S\"\nresult = spotify.audio_features(music_id)\nresult\n\n[{'danceability': 0.393,\n  'energy': 0.715,\n  'key': 8,\n  'loudness': -4.105,\n  'mode': 1,\n  'speechiness': 0.0344,\n  'acousticness': 0.343,\n  'instrumentalness': 0,\n  'liveness': 0.112,\n  'valence': 0.374,\n  'tempo': 159.548,\n  'type': 'audio_features',\n  'id': '4zdXDTExh06duqfnyhNx6S',\n  'uri': 'spotify:track:4zdXDTExh06duqfnyhNx6S',\n  'track_href': 'https://api.spotify.com/v1/tracks/4zdXDTExh06duqfnyhNx6S',\n  'analysis_url': 'https://api.spotify.com/v1/audio-analysis/4zdXDTExh06duqfnyhNx6S',\n  'duration_ms': 289867,\n  'time_signature': 4}]\n\n\nうける"
  },
  {
    "objectID": "post/data_math_quest/index.html",
    "href": "post/data_math_quest/index.html",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "",
    "text": "タイピングが追いつかないので、途中からは気になった問題だけになってます！"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目",
    "href": "post/data_math_quest/index.html#問目",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "１問目",
    "text": "１問目\n\n問題\n大学生の就職活動に関して、ある企業にエントリーした学生は男性が60%を占めていたが、採用を内定された割合は、男性は男性応募者の40%、女性は女性応募者の30%であった。\n\n\n\n⑴この企業の男女合わせた全体の応募者に対する男性の採用内定率、女性の採用内定率を求めよ。\n⑵この企業の男女合わせた全体の採用内定率を求めよ。\n⑶この企業の採用内定者の名簿から一人をランダムに選んだ場合、それが女性である確率を求めよ。\n\n\n\n\n\n解答\n\n⑴\nある企業にエントリーした学生全体を\\(\\Omega\\)とし、男性である事象を\\(A\\)とする。また男性である確率は\\(P(A)\\)と表します。\nこの場合女性である事象は\\(A^c\\)で表され、女性である確率は\\(P(A)\\)となります。\n男性の割合は60%なので、\\(P(A)=0.6\\)である。 女性の割合は、\\(P(A^c)=1-0.6=0.4\\)である。\n\n\n\nまた採用される事象は\\(B\\)と表し、採用されない事象は\\(B^c\\)となります。\n男性は男性応募者の40%、女性は女性応募者の30%が採用内定である。これは条件付き確率で表される。40%とは、男性である条件のもとで採用した確率なので、\\(P(B|A)=0.4\\)。同様に、\\(P(B|A^c)=0.3\\)\n\n\n\n⑴で聞かれているのは、男性の採用内定率つまり\\(P(A \\cap B)\\)と、女性の採用内定率つまり\\(P(A^c \\cap B)\\)である。\n\n\n\n\\(P(A \\cap B)=P(B|A) \\times P(A) = 0.4 \\times  0.6 = 0.24\\)\n\\(P(A^c \\cap B)=P(B|A^c) \\times P(A^c) = 0.3 \\times  0.4 = 0.12\\)\n\n\n\n\n\n⑵\n⑵で聞かれているのは、全体の採用内定率つまり\\(P(B)\\)である。\n\\(A+A^c=\\Omega\\)で、\\(A\\)と\\(A^c\\)は排反より、全確率の公式を用いると、以下の式が成り立つ。\n\\(P(B) = P(B|A) \\times P(A) + P(B|A^c) \\times P(A^c) = 0.24+0.12=0.36\\)\n\n\n\n\n\n⑶\n⑶は条件付き確率の問題で、採用内定者のもとで女性である確率つまり\\(P(A^c|B)\\)である。\n\\(P(A^c|B)=\\frac{P(A^c \\cap B)}{P(B)}= \\frac{0.12}{0.36} =\\frac{1}{3}\\)"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-1",
    "href": "post/data_math_quest/index.html#問目-1",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "2問目",
    "text": "2問目\n\n問題\n週の天気予報によると、土曜日に雨の降る確率は25%、日曜日に雨の降る確率も25%である。 週末の土日のどこかに雨が降る確率は25+25=50%になると考えた。これは正しいかどうか。\n\n\n解答\n正しくない。\n土曜日に雨が降る事象を\\(A\\)とし、確率は\\(P(A)\\)で表される。\n日曜日に雨が降る事象を\\(B\\)とし、確率は\\(P(B)\\)で表される。\n\n\n\nこの問題が言っていることは\\(P(A \\cup B) = P(A)+P(B)\\)になるということである。しかし、これが成り立つのは、\\(A\\)と\\(B\\)が排反の時である。\n事象\\(A\\)と\\(B\\)はどう考えても排反ではないので、成り立たない。\n\n\n\n\n\n\nノート\n\n\n\n事象\\(A\\)と\\(B\\)が排反とは、\\(A\\)と\\(B\\)が同時に起こり得ないということです。\n\n\n\\(P(A \\cup B) = P(A)+P(B)-P(A \\cap B)\\)なので、確率は50%より低くなることが考えられる。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-2",
    "href": "post/data_math_quest/index.html#問目-2",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "3問目",
    "text": "3問目\n\n問題\nある大学のある学部はA学科とB学科の２つからなり、それぞれの志願者数と合格率が男女別に次の表で与えられたとする。学部全体の男女の合格率に関して、シンプソンのパラドクスが生ずるような\\(a\\)の条件を考えよ。\n\n\n\n\n\n\n\n\n\nA 学科\n志願者\n合格率\n\n\n\n\n男性\n500\n60%\n\n\n女性\n30\n70%\n\n\n\n\n\n\n\n\nB 学科\n志願者\n合格率\n\n\n\n\n男性\n400\n10%\n\n\n女性\n300\na%\n\n\n\n\n\n\n\n\n解答\nA学科を見ると女性の方が合格率が高い。\n男女の合格率に関してシンプソンのパラドクスが生じるようにという問題です。つまり、B学科もA学科同様に学科単体では女性の合格率が高いが、A学科とB学科を合計すると男性の合格率のほうが高くなるような\\(a\\)を求める問題です。\n\n\n\nまず、学科単体では女性の合格率が高くなるので、\\(a&gt;10\\)です。\n\n\n\n次に、男女別の学科合計の合格率を考えます。\n男性の合格率\n\\(\\frac{500 \\times 0.6 + 400 \\times 0.1}{500+400}=\\frac{340}{900}\\)\n女性の合格率\n\\(\\frac{30 \\times 0.7 + 300 \\times a/100}{500+400} = \\frac{21+3a}{330}\\)\n男性の合格率&gt;女性の合格率となればいいので、以下の式が成り立ちます。\n\\(\\frac{340}{900}&gt;\\frac{21+3a}{330}\\)\n\\(a &lt; \\frac{340}{900} \\times 110 -7\\fallingdotseq 34.6\\)\nよって\\(a\\)の条件とは \\(10&lt;a&lt;34.6\\) である。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-3",
    "href": "post/data_math_quest/index.html#問目-3",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "4問目",
    "text": "4問目\n\n問題\n両親と二人の子供がいる4人家族において、同じ誕生日の人がいる確率を求めよ。\n\n\n解答\n誕生日問題は補集合で考えるとわかりやすい。\n同じ誕生日の人がいない事象を\\(A\\)とすると、求めたい事象は\\(A^c\\)であり、求めたい確率は\\(P(A^c)\\)である。\n\\(P(A)=\\frac{365}{365} \\cdot \\frac{364}{365} \\cdot \\frac{363}{365} \\cdot \\frac{362}{365} = \\frac{364\\cdot 363\\cdot 362}{365^3}\\)\n\\(P(A^c)=1-P(A)=1-\\frac{364\\cdot 363\\cdot 362}{365^3} = 0.016\\)\nよって約1.6%である。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-4",
    "href": "post/data_math_quest/index.html#問目-4",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "5問目",
    "text": "5問目\nここに書いてあるので、省略します。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-5",
    "href": "post/data_math_quest/index.html#問目-5",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "6問目",
    "text": "6問目\n\n問題\n条件付き確率について不等式\\(P(A|D) \\geq P(B|D)\\),\\(P(A|D^c) \\geq P(B|D^c)\\)が成り立つならば、\\(P(A) \\geq P(B)\\)であることを示せ。\n\n\n解答\n\\(P(A|D^c)\\)のような補集合の条件付き確率が出てきていることから、全確率の公式を用いることが推察できます。\n\\(P(A|D)P(D) + P(A|D^c)P(D^c) =P(A)\\)\n\\(P(B|D)P(D) + P(B|D^c)P(D^c) =P(B)\\)\nこの２つを用いれば解くことができそうですね。\n\n\n\n\\(P(A|D) \\geq P(B|D)\\)の両辺に\\(P(D)\\)をかけても不等式は成り立ちます。\n\\(P(A|D)P(D) \\geq P(B|D)P(D)\\)\n\\(P(A|D^c) \\geq P(B|D^c)\\)の両辺に\\(P(D^c)\\)をかけても不等式は成り立ちます。\n\\(P(A|D^c)P(D^c) \\geq P(B|D^c)P(D^c)\\)\n不等式同士を辺々足しても大小関係は変わらないため、以下の式が成り立つ。\n\\(P(A|D)P(D)+P(A|D^c)P(D^c) \\geq P(B|D)P(D)+ P(B|D^c)P(D^c)\\)\n全確率の公式より\n\\(P(A) \\geq P(B)\\)である。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-6",
    "href": "post/data_math_quest/index.html#問目-6",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "7問目",
    "text": "7問目\n\n問題\n次の多項式の係数を求めよ。\n⑴\\((x+y)^6\\)における\\(x^3y^3\\)の係数\n⑵\\((x+y+z)^6\\)における\\(x^2y^2z^2\\)の係数\n\n\n解答\n⑴\n\\(\\begin{pmatrix}\n6 \\\\\n3\n\\end{pmatrix} =\\frac{6!}{3!3!}=20\\)\n⑵\n\\(\\begin{pmatrix}\n& 6 & \\\\\n2 & 2 & 2\n\\end{pmatrix} =\\frac{6!}{2!2!2!}=90\\)"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-7",
    "href": "post/data_math_quest/index.html#問目-7",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "8問目",
    "text": "8問目\n\n問題\n正しいコインを３回投げる時次の確率を求めよ\n⑴少なくとも１回は表が出るという条件のもとで２回以上表の出る確率\n⑵少なくとも１回は裏が出るという条件のもとで２回以上表の出る確率\n\n\n解答\n正しいコインの意味はおそらく裏表が1/2の確率になるという意味だと思います。\n⑴\n条件付き確率ですね。\n少なくとも１回は表が出るという事象を\\(A\\)として、2回以上表が出る事象を\\(B\\)とする。\n求めるのは\\(P(B|A)\\)である。\n\n\n\n\\(P(B|A)=\\frac{P(A \\cap B)}{P(A)}\\)となるので、それぞれの確率を求めれば良い。\n\n\n\n\\(P(A)\\)は余事象ですぐ求めることができる。\n\\(P(A)=1-P(A^c)=1-(\\frac{1}{2})^3=\\frac{7}{8}\\)\n\n\n\n\\(P(A \\cap B)\\) は\\(B \\subset A\\)より\\(P(A \\cap B)=P(B)\\)である。 また、表が２回出る確率は\\({}_3 C_1(\\frac{1}{2})^3\\)です。\n\\(P(A \\cap B)=P(B)=\\frac{1}{8}+\\frac{3}{8}=\\frac{1}{2}\\)\n\n\n\nよって、\n\\(P(B|A)=\\frac{P(A \\cap B)}{P(A)}= \\frac{P(1/2)}{7/8}=\\frac{4}{7}\\)\n⑵\n⑴と同様に求めます。\n少なくとも１回は裏が出るという事象を\\(A\\)として、2回以上表が出る事象を\\(B\\)とする。\n\\(P(A)=1-P(A^c)=1-(\\frac{1}{2})^3=\\frac{7}{8}\\)\n少なくとも１回は裏が出るかつ２回以上表が出る事象は、表が２回（裏が１回）の事象のみである。\n\\(P(A \\cap B)={}_3 C_1(\\frac{1}{2})^3=\\frac{3}{8}\\)\nよって、\n\\(P(B|A)=\\frac{P(A \\cap B)}{P(A)}= \\frac{P(3/8)}{7/8}=\\frac{3}{7}\\)"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-8",
    "href": "post/data_math_quest/index.html#問目-8",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "9問目",
    "text": "9問目\n\n問題\n2人の子供がいる夫婦について、第一子が女の子であるという条件のもとで二人とも女の子であるという確率を求めよ。また子供の一人が女子であるという条件のもとで二人とも女子である確率を求めよ。\n\n\n解答\nこれも条件付き確率の問題と考えることができます。\n1つ目について。\nA：第一子が女の子である\nB：二人とも女の子である\n一つ目で求められているのは\\(P(B|A)\\)である。\n\\(P(A)=1/2\\)\n\\(P(A \\cap B)=1/2 \\times 1/2 =1/4\\)\n\\(P(B|A)= \\frac{1/4}{1/2} = 1/2\\)\n2つ目について。\nC：子供の一人が女子である\nD：二人とも女子である\n\\(P(C)=1- (\\frac{1}{2})^2 = 3/4\\)\n\\(P(D \\cap C)=1/4\\)\n\\(P(D|C)= \\frac{1/4}{3/4} = 1/3\\)"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-9",
    "href": "post/data_math_quest/index.html#問目-9",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "10問目",
    "text": "10問目\n\n問題\n独立性に関して次の問いに答えよ\n⑴\\(A\\)と\\(B\\)が独立ならば、\\(A\\)と\\(B^c\\)も独立になり、\\(A^c\\)と\\(B^c\\)も独立になるか。\n⑵\\(A\\)と\\(B\\)が独立で、\\(B\\)と\\(C\\)が独立であるとき、\\(A\\)と\\(C\\)は独立になるか。\n⑶\\(A\\)と\\(B\\)が排反であれば常に\\(A\\)と\\(B\\)は独立であるか。\n⑷\\(A \\subset B\\)であるとき、\\(A\\)と\\(B\\)は独立になるか。\n\n\n解答\n\n\n\n\n\n\nノート\n\n\n\n\\(A\\)と\\(B\\)が独立であるとは、\\(P(A \\cap B)=P(A) \\cdot P(B)\\)であること。\n\n\n\nこの式は条件付き確率からわかる。\n\\[\nP(A | B)=\\frac{P(A \\cap B)}{P(B)}\n\\]\n式を移行すると、\n\\[\nP(A \\cap B)=P(A | B) \\cdot P(B)\n\\]\nこの\\(B\\)という事象の元で\\(A\\)という事象が起こる確率が\\(B\\)に依存しない時、\\(P(A | B)=P(A)\\)となる。\n\n\n⑴\n\\(A\\)と\\(B\\)が独立であるとは、\\(P(A \\cap B)=P(A) \\cdot P(B)\\)であることである。\n\n\n\n\\(A\\)と\\(B^c\\)が独立であることを示したいときは\\(P(A \\cap B^c)=P(A) \\cdot P(B^c)\\)を示せば良い。\nまた\\(P(A \\cap B)=P(A) \\cdot P(B)\\)という条件があるので、\\(A \\cap B\\)の形を出せると使えそうなことがわかる。\n\\[\\begin{align}\nP(A \\cap B^c)&=P(A)-P(A\\cap B) \\\\\n&=P(A)-P(A)\\cdot P(B)\\\\\n&=P(A)\\cdot(1-P(B))\\\\\n&=P(A)\\cdot P(B^c)\n\\end{align}\\]\nこれで\\(P(A \\cap B^c)=P(A) \\cdot P(B^c)\\)が示せたので、\\(A\\)と\\(B\\)が独立なとき、\\(A\\)と\\(B^c\\)が独立であることを示せた。\n⑵\n\\(P(A \\cap B)=P(A) \\cdot P(B)\\)\n\\(P(B \\cap C)=P(B) \\cdot P(C)\\)\nこの２つから\\(P(A \\cap C)=P(A) \\cdot P(C)\\)を求めることができれば、独立が成り立つと言えそうだが、明らかに言えなそうなので反例を探していく。\n例えば、\\(P(B)=0\\)の時を考える。上２式は\\(B\\)の事象が \\(\\emptyset\\)より0の等式が成り立つ。\n\\(P(A \\cap C)=P(A) \\cdot P(C)\\)の式は上2式で定まらないので、単独で考えると、独立でない時もあるので成り立たない。\n⑶\n\n\n\n\n\n\nノート\n\n\n\n\\(A\\)と\\(B\\)が排反であるとは、\\(A\\cap B = \\emptyset\\)であるということ。\n\n\n\\[\nP(A \\cap B)=P(\\emptyset) =0\n\\]\nである。\\(P(A)\\)と\\(P(B)\\)は1/3と1/3とかもあり得るので、\\(P(A)\\cdot P(B)\\)は常に0ではない。\nよって、常に独立にはならない。\n⑷\n\\[\nP(A \\cap B)=P(A) \\ne P(A) \\cdot P(B)\n\\]\nよって常に独立にはならない。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-10",
    "href": "post/data_math_quest/index.html#問目-10",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "11問目",
    "text": "11問目\n\n問題\nベイズの定理により事前確率は事後確率の取り方に依存する。 例1.6のウイルス検査において、発熱という症状が出ている患者群を母集団として考えた場合、ウイルスに感染している確率が高くなるので事前確率は高くなる。 例えば、発熱している患者の半数が感染していて、半数が感染していないという設定では事前確率が\\(P(A_1)=0.5\\)、\\(P(A_2)=0.5\\)となる。 このとき陽性反応が出たという条件のもとで、感染している確率はどうなるか。\n\n\n解答\n感染している割合が0.1から0.5に上がった時（母集団を変えた時）にどうなるかということです。\n\\[\nP(A_1)=0.5\n\\]\n\\[\nP(A_2)=0.5\n\\]\n以下の条件は変わらない。\n\\[\\begin{align}\nP(B_1|A_1)=0.9\nP(B_2|A_1)=0.1\nP(B_1|A_2)=0.01\nP(B_1|A_2)=0.99\n\\end{align}\\]\n陽性反応が出たという条件のもとで、感染している確率\\(P(A_1|B_1)\\)を求める。\n\\[\\begin{align}\nP(A_1|B_1)&=\\frac{P(A_1 \\cap B_1)}{P(B_1)} \\\\\n&=\\frac{P(B_1|A_1)\\cdot P(A_1)}{P(B_1|A_1)\\cdot P(A_1)+P(B_1|A_2)\\cdot P(A_2)}\\\\\n&=\\frac{0.9 \\cdot 0.5}{0.9 \\cdot 0.5 + 0.01 \\cdot 0.5}\\\\\n&=\\frac{0.45}{0.455}\\\\\n&=0.989\n\\end{align}\\]\n確率結構上がりましたね。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-11",
    "href": "post/data_math_quest/index.html#問目-11",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "12問目",
    "text": "12問目\n\n問題\n正しいコインを２回投げる時、１回目に表が出る事象を\\(A\\)、２回目に表の出る事象を\\(B\\)、２回のうちに１回だけ表の出る事象を\\(C\\)とする。\n⑴\\(A,B,C\\)はペアワイズ独立であることを示せ。\n⑵\\(A,B,C\\)は互いに独立でないことを示せ。\n\n\n解答\n\n\n\n\n\n\nノート\n\n\n\n\\(A,B,C\\)はペアワイズ独立であるとは、\\(P(A\\cap B)=P(A) \\cdot P(B)\\)かつ\\(P(B\\cap C)=P(B) \\cdot P(C)\\)かつ\\(P(A\\cap C)=P(A) \\cdot P(C)\\)が成り立つこと。\n\n\n⑴\n正しいコインを投げる時表が出る事象を\\(H\\),裏が出る事象を\\(T\\)とする。\nすると２回投げる時,\\(\\{HH,HT,TH,TT\\}\\)の４パターンになる。\n\\[\\begin{align}\nA=\\{HH,HT\\} ,P(A)=1/2\\\\\nB=\\{HH,TH\\},P(B)=1/2 \\\\\nC=\\{HT,TH\\} ,P(C)=1/2\\\\\n\\end{align}\\]\n\\[\\begin{align}\nA \\cap B=\\{HH\\} ,P(A \\cap B)=1/4\\\\\nB \\cap C=\\{TH\\},P(A \\cap B)=1/4 \\\\\nA \\cap C=\\{HT\\} ,P(A \\cap B)=1/4\\\\\n\\end{align}\\]\n\\(P(A\\cap B)=P(A) \\cdot P(B)\\)かつ\\(P(B\\cap C)=P(B) \\cdot P(C)\\)かつ\\(P(A\\cap C)=P(A) \\cdot P(C)\\)が成り立つので、ペアワイズ独立である。\n⑵\n\n\n\n\n\n\nノート\n\n\n\n三つの事象が互いに独立であるとは、\n\\[\\begin{align}\nP(A\\cap B)=P(A) \\cdot P(B) \\\\\nP(B\\cap C)=P(B) \\cdot P(C)\\\\\nP(A\\cap C)=P(A) \\cdot P(C)\\\\\nP(A\\cap B \\cap C)=P(A)\\cdot P(B) \\cdot P(C)\\\\\n\\end{align}\\]\nすべてが成り立つことである。\n\n\n\\[\nA \\cap B \\cap C= \\emptyset,P(A \\cap B\\cap C)=0\n\\]\n\\(P(A)\\cdot P(B) \\cdot P(C)=1/8\\)より\\(P(A\\cap B \\cap C)=P(A)\\cdot P(B) \\cdot P(C)\\)が成り立たないため、\\(A,B,C\\)は互いに独立ではない。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-12",
    "href": "post/data_math_quest/index.html#問目-12",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "13問目",
    "text": "13問目\n\n問題\nモンティ・ホール問題を説明せよ。\n\n\n解答\n後でシミュレーションとか作って丁寧にやります。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問目-13",
    "href": "post/data_math_quest/index.html#問目-13",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "14問目",
    "text": "14問目\n\n問題\n２項係数の関係式を示し、これを用いて２項定理を証明せよ。 また、パスカルの３角形が成り立つことを証明せよ。\n\n\n解答\n一つ目は\n\\[\n\\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right)\n=\n\\left(\n\\begin{matrix}\nn-1 \\\\\nk-1\n\\end{matrix}\n\\right) +\n\\left(\n\\begin{matrix}\nn-1 \\\\\nk\n\\end{matrix}\n\\right)\n\\]\n\\[\\begin{align}\n\\left(\n\\begin{matrix}\nn-1 \\\\\nk-1\n\\end{matrix}\n\\right)\n+\\left(\n\\begin{matrix}\nn-1 \\\\\nk\n\\end{matrix}\n\\right) &=\\frac{(n-1)!}{(k-1)!(n-1-(k-1))!}+\\frac{(n-1)!}{k!(n-1-k)!} \\\\\n&= \\frac{(n-1)! \\cdot k}{(k)!(n-k)!}+\\frac{(n-1)! \\cdot (n-k)}{k!(n-k)!} \\\\\n&=\\frac{(n-1)! \\cdot (k+n-k)}{(k)!(n-k)!} \\\\\n&=\\frac{(n)!}{(k)!(n-k)!} \\\\\n&=\\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right)\n\n\n\\end{align}\\]\n二つ目は\n\\[\n(a+b)^n = \\sum_{k=0}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^k b^{n-k}\n\\tag{1}\\]\nこの二項定理が成り立つことを示せということです。\n感覚的に(a+b)がたくさんある中で\\(a^kb^{n-k}\\)の組み合わせは何個だからみたいな方法もわかりやすくていいと思うんですが、帰納法で示します。\n\\(n=1\\)のとき、\n\\[\na+b=\\sum_{k=0}^1 \\left(\n\\begin{matrix}\n1 \\\\\nk\n\\end{matrix}\n\\right) a^k b^{1-k}\n=\\left(\n\\begin{matrix}\n1 \\\\\n0\n\\end{matrix}\n\\right) a^0 b^{1}+\\left(\n\\begin{matrix}\n1 \\\\\n1\n\\end{matrix}\n\\right) a^1 b^{0}\n=a+b\n\\]\nよって\\(n=1\\)の時成り立つ。\n\\(n=k\\)のとき 式 2 が成り立つと仮定する。\n\\(n=k+1\\)のとき\n\\[\\begin{align}\n(a+b)^{k+1} &= (a+b)\\sum_{k=0}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^k b^{n-k}\\\\\n&=  \\sum_{k=0}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k+1} b^{n-k}\n+\\sum_{k=0}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k} b^{n-k+1}\n\\\\\n\n\n\n&=a^{n+1} +\\sum_{k=0}^{n-1} \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k+1} b^{n-k}\n+\\sum_{k=1}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n\n\n&=a^{n+1} +\\sum_{k=1}^{n} \\left(\n\\begin{matrix}\nn \\\\\nk-1\n\\end{matrix}\n\\right) a^{k} b^{n-k+1}\n+\\sum_{k=1}^n \\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right) a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n\n\n&=a^{n+1} +\\sum_{k=1}^{n} (\\left(\n\\begin{matrix}\nn \\\\\nk-1\n\\end{matrix}\n\\right)+\\left(\n\\begin{matrix}\nn \\\\\nk\n\\end{matrix}\n\\right)) a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n&=a^{n+1} +\\sum_{k=1}^{n} \\left(\n\\begin{matrix}\nn+1 \\\\\nk\n\\end{matrix}\n\\right)a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n&=\\sum_{k=1}^{n+1} \\left(\n\\begin{matrix}\nn+1 \\\\\nk\n\\end{matrix}\n\\right)a^{k} b^{n-k+1}\n+b^{n+1}\n\n\\\\\n\n&=\\sum_{k=0}^{n+1} \\left(\n\\begin{matrix}\nn+1 \\\\\nk\n\\end{matrix}\n\\right)a^{k} b^{n-k+1}\n\\end{align}\\]\n\\(n=k+1\\)の時 式 2 が成り立つので、二項定理が示された。\n三つ目\nパスカルの三角形が成り立つことを証明せよ。\n問題の意味がわからなかったのですが、おそらく「パスカルの三角形が二項定理の係数に相当することを示せ」ということだと解釈しました。\n\n\\(n\\)列目の\\(k\\)行目の数を\\({}_n C_k\\)とすると、\\({}_n C_k={}_{n-1}+ C_{k-1}{}_{n-1} C_{k}\\)が成り立つことを示せという問題なんですかね。\nこれは一つ目で示したものと同じになります。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題-13",
    "href": "post/data_math_quest/index.html#問題-13",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題",
    "text": "問題\n二項分布\\(Bin(n,p)\\)の確率関数を\\(p_k=P(X=k)\\),\\(k=0, \\ldots, n\\)とする。\n⑴\\(p_k\\)を\\(p_{k-1}\\)を用いて表せ。\\(\\{p_0,\\ldots,p_n\\}\\)の中で最大を与える\\(k\\)を求めよ\n⑵\\(p=1/2\\)のとき、\\(n=10,k=9\\)の時の確率と\\(n=20,k=18\\)の時の確率ではどちらが大きいか。"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-13",
    "href": "post/data_math_quest/index.html#解答-13",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n\n\n\n\n\n\nNote 1\n\n\n\n確率変数\\(X\\)が二項分布\\(Bin(n,p)\\)に従う時、\\(X=k\\)となる確率は\\(q=1-p\\)に対して次のようになる。\n\\[\np(k)=\\binom{n}{k}p^k q^{n-k}\n\\]\n\n\n\n⑴\n\\(p_k=\\binom{n}{k}p^k q^{n-k}\\)と\\(p_{k-1}=\\binom{n}{k-1}p^{k-1} q^{n-(k-1)}\\)の関係を示したいです。\nカッコのままだとわかりにくかったので、階乗に直します。\n\\(p_k=\\frac{n!}{k!(n-k)!} p^k q^{n-k}\\) を　\\(p_{k-1}=\\frac{n!}{(k-1)!(n-(k-1))!} p^{k-1} q^{n-(k-1)}\\)の関係を示す問題です。\n式変形していきます。\n\\[\\begin{align}\np_{k}\n&=\n\\binom{n}{k}p^k q^{n-k}\n\\\\\n\n&=\n\\frac{n!}{k!(n-k)!} p^k q^{n-k}\n\\\\\n\n&=\n\\frac{n!(n-(k-1))}{k(k-1)! \\cdot (n-(k-1))!} p^k q^{n-k}\n\\\\\n\n&=\n\\frac{n!(n-(k-1))}{k(k-1)! \\cdot (n-(k-1))!} p^{k-1} q^{n-(k-1)} \\frac{p}{q}\n\\\\\n\n&=\n\\frac{n!}{(k-1)!(n-(k-1))!} p^{k-1} q^{n-(k-1)}\\frac{p(n-(k-1))}{kq}\n\\\\\n&=\n\\frac{p(n-(k-1))}{kq} p_{k-1}\n\\\\\n&=\n\\frac{p(n-(k-1))}{k(1-p)} p_{k-1}\n\n\\end{align}\\]\nきれいに治すと、 \\[\np_k=\\frac{p}{1-p} \\frac{n-(k-1)}{k} p_{k-1}\n\\tag{2}\\]\nとなります。\n\\(\\{p_0,\\ldots,p_n\\}\\)の中で最大を与える\\(k\\)を求める問題です。\\(p_k \\ge p_{k-1}\\)かつ\\(p_k \\ge p_{k+1}\\)となるような\\(k\\)の確率が最大となります。式 2 が誘導になってることがわかりますね。\n\\[\np_k = \\frac{p}{1-p} \\frac{n-(k-1)}{k} p_{k-1} \\ge p_{k-1}\n\\]\nかつ\n\\[\np_{k+1} = \\frac{p}{1-p} \\frac{n-k}{k+1} p_{k} \\le p_{k}\n\\]\nが成り立つことである。\n1つ目の式は確率は0以上であるため、下のように変形できる。\n\\[\\begin{align}\np_k = \\frac{p}{1-p} \\frac{n-(k-1)}{k} p_{k-1} &\\ge p_{k-1}　 \\\\\n\\Longleftrightarrow p(n-k+1) &\\ge (1-p)k \\\\\n\\Longleftrightarrow p(n+1) \\ge k\n\\end{align}\\]\n2つ目の式も同様に変形できる。\n\n\\[\\begin{align}\np_{k+1} = \\frac{p}{1-p} \\frac{n-k}{k+1} p_{k} &\\le p_{k} \\\\\n\\Longleftrightarrow p(n-k) &\\le (1-p)(k+1) \\\\\n\\Longleftrightarrow pn \\le k-p+1 \\\\\n\\Longleftrightarrow p(n+1) \\le k+1\n\\end{align}\\]\nよって\\(k\\)について以下の不等式を解くと確率が最大になる時の\\(k\\)がもとまる。\n\\[\np(n+1)-1 \\le k \\le p(n+1)\n\\]\nこれを満たす整数\\(k\\)は\\(p(n+1)\\)が整数かどうかで変わる。\n\\(p(n+1)\\)が整数のとき、\\(k=p(n+1),p(n+1)-1\\)である。\n\\(p(n+1)\\)が整数ではないとき、\\(k=[p(n+1)]\\)となる。\n\n\n\n\\(p(n+1)\\)が整数の時のグラフ！\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import binom\nimport japanize_matplotlib\n\n# 複数のn, p値を定義\nparams = [(9, 0.2), (9, 0.5), (19, 0.7), (19, 0.5), (19, 0.7)]\n\n# x の範囲を定義\nx = np.arange(0, 21)\n\n# グラフのプロット\nplt.figure(figsize=(10, 6))\n\nfor n, p in params:\n    pmf = binom.pmf(x, n, p)\n    plt.plot(x, pmf, marker='o', linestyle='-', label=f'n = {n}, p = {p}')\n\n# x軸の目盛りを整数に設定\nplt.xticks(np.arange(0, 21, 1))\n\nplt.xlabel('x')\nplt.ylabel('確率')\nplt.title('nとpを変動させた二項分布')\nplt.legend()\nplt.grid(True)\nplt.savefig('binom_distribution.png')\nplt.show()\n\n\n\n\n\n\n\n\n\n\\(p(n+1)\\)が整数の時のグラフ！\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import binom\nimport japanize_matplotlib\n\n# 複数のn, p値を定義\nparams = [(10, 0.2), (10, 0.5), (10, 0.7), (20, 0.5), (20, 0.7)]\n\n# x の範囲を定義\nx = np.arange(0, 21)\n\n# グラフのプロット\nplt.figure(figsize=(10, 6))\n\nfor n, p in params:\n    pmf = binom.pmf(x, n, p)\n    plt.plot(x, pmf, marker='o', linestyle='-', label=f'n = {n}, p = {p}')\n\n# x軸の目盛りを整数に設定\nplt.xticks(np.arange(0, 21, 1))\n\nplt.xlabel('x')\nplt.ylabel('確率')\nplt.title('nとpを変動させた二項分布')\nplt.legend()\nplt.grid(True)\nplt.savefig('binom_distribution.png')\nplt.show()\n\n\n\n\n\n\n\n\n\nグラフで見てみるとわかりやすいですね！\n\n\n⑵\n\\(n=10,k=9\\)のとき Note 2　より\n\\[\np_9=\\binom{10}{9} (\\frac{1}{2})^{10}\n\\]\n\\[\np_{18}=\\binom{20}{18} (\\frac{1}{2})^{20}\n\\]\n\\[\n\\binom{10}{9}={}_{10} C_9={}_{10} C_1=10,  \n\\binom{20}{18}={}_{20} C_{18}={}_{20} C_2=190\n\\]\nよって　\\(p_9=\\binom{10}{9} (\\frac{1}{2})^{10} &gt; p_{18}=\\binom{20}{18} (\\frac{1}{2})^{20}\\)\n\\(p_{9}\\)の方が確率は大きい。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題-14",
    "href": "post/data_math_quest/index.html#問題-14",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題",
    "text": "問題\nポアソン分布\\(Po(\\lambda)\\)の確率関数を\\(p_k=P(X=k)\\),\\(k=0, \\ldots,\\)とする。\n⑴\\(p_k\\)を\\(p_{k-1}\\)を用いて表せ。\\(\\{p_0,\\ldots,\\}\\)の中で最大を与える\\(k\\)を求めよ\n⑵少なくとも１回以上起こる確率が90%以上になる\\(\\lambda\\)の条件を求めよ"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-14",
    "href": "post/data_math_quest/index.html#解答-14",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n\n⑴\n問１と同じですね。\n\n\n\n\n\n\nNote 2\n\n\n\n確率変数\\(X\\)ポアソン分布\\(Po(\\lambda)\\)に従う時、\\(X=k\\)となる確率は下のようになる。\nここに詳しく書いてある。\n\\[\np(k) = P(X=k) = \\frac{\\lambda^k}{k!}e^{-\\lambda}, k = 0,1,2,3, \\ldots\n\\]\n\n\n\\(p_k= \\frac{\\lambda^k}{k!}e^{-\\lambda}\\) を、\\(p_{k-1}= \\frac{\\lambda^{k-1}}{(k-1)!}e^{-\\lambda}\\) を用いて表す。\n\\[\np(k) = \\frac{\\lambda^k}{k!}e^{-\\lambda} = \\frac{\\lambda \\lambda^{k-1} }{k(k-1)!}e^{-\\lambda} =\\frac{\\lambda}{k}p_{k-1}\n\\]\n\\(p_k \\ge p_{k-1}\\)かつ\\(p_k \\ge p_{k+1}\\)となるような\\(k\\)の確率が最大となります。\n\\[\np_k = \\frac{\\lambda}{k}p_{k-1} \\ge p_{k-1} \\Longleftrightarrow \\lambda \\ge k\n\\]\n\\[\np_{k+1} = \\frac{\\lambda}{k+1}p_{k} \\le p_{k} \\Longleftrightarrow \\lambda \\le k+1\n\\]\nよって\\(\\lambda-1 \\le k \\le \\lambda\\) となります。\n\\(\\lambda\\)が整数の時、\\(k=\\lambda-1,\\lambda\\)。\n\\(\\lambda\\)が整数ではない時、\\(k=[\\lambda]\\)となります。\n\n\n⑵\n少なくとも１回以上起こる確率は\n\\[\nP(X \\le 1)=1-P(X=0)=1-\\frac{\\lambda^0}{0!}e^{-\\lambda}=1-e^{-\\lambda} \\ge 0.9\n\\]\n\\[\ne^{-\\lambda} \\le 0.1\n\\]\n両辺\\(e\\)を底数とする対数を取ると、 \\[\n-\\lambda \\le \\log 0.1 = - \\log 10\n\\]\n\\[\n\\lambda \\ge \\log 10\n\\]"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題-15",
    "href": "post/data_math_quest/index.html#問題-15",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題",
    "text": "問題\n３個の正しいコインを同時に投げ、３枚とも表か３枚とも裏が出るまで投げ続ける実験を行い、投げ続けた回数を\\(X+1\\)で表すことにする。このとき、\\(X\\)の確率分布を求めよ。また\\(P(X \\le k) \\ge 0.9\\)を満たす最小の\\(k\\)を求めよ。"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-15",
    "href": "post/data_math_quest/index.html#解答-15",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n求めているものが出るまでやり続ける回数は幾何分布に従う。\n注意する点として失敗する回数が幾何分布に従うことである。なのでこの問題で成功した時を\\(X+1\\)としているのは、\\(X\\)が幾何分布に従うことを意味する。\n\n\n\n\n\n\n\n\n\nNote 3: 幾何分布(\\(Geo(p)\\))\n\n\n\n確率変数\\(X\\)が幾何分布に従う時、\\(p\\)を成功確率、\\(k\\)を失敗確率として、\\(k\\)回失敗した時の$Xの確率関数は\n\\[\np(k)=q^k p, k=0,1,2 \\ldots\n\\]\n\n\n成功確率\\(p=(1/2)^3 \\times 2 = 1/4\\),\\(q=3/4\\)\nよって確率変数\\(X\\)は\\(Geo(3/4)\\)の幾何分布に従う。←確率分布を求めよの答えかなあ\n\\(X\\)の確率関数は\n\\[\np(k)=(3/4)^k (1/4)\n\\]\nとなる。\n累積分布関数が0.9を越す最小の\\(k\\)を求めます。\n\\[\nF(k)=P(X \\le k) = \\sum_{x=0}^k p(x) = \\sum_{x=0}^k (3/4)^x (1/4)=1/4+\\sum_{x=1}^k (3/4)^{x-1} (3/4)(1/4)=1/4+\\frac{3/16(1-(3/4)^{k})}{1-3/4}=1-(3/4)^{k+1} \\ge 0.9\n\\]\n\\[\n1-(3/4)^{k+1} \\ge 0.9\n\\]\n\\[\n(k+1) \\log (3/4) \\le - \\log 10\n\\]\n\\[\nk \\le -1 -  \\frac{\\log 10}{\\log (3/4)}\n\\]\nである。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題-16",
    "href": "post/data_math_quest/index.html#問題-16",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題",
    "text": "問題\n\\(U\\)を一様分布\\(U(0,1)\\)に従う確率変数とし、自然数\\(n\\)に対して\\(X=[nU]\\)とおく。\\(X\\)の確率分布を与えよ。"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-16",
    "href": "post/data_math_quest/index.html#解答-16",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n\\([nU]=k\\)とすると\\(k \\le nU &lt; k+1\\)となる。\n\\[\n\\frac{k}{n} \\le U &lt; \\frac{k+1}{n}\n\\]\n\\[\nP(X=k) = P(k \\le nU &lt; k+1) = P(\\frac{k}{n} \\le U &lt; \\frac{k+1}{n} ) = \\frac{1}{n}\n\\]"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要",
    "href": "post/data_math_quest/index.html#問題概要",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(Y \\sim Ex(\\lambda)\\) のとき、\\(X=[Y]\\) とおく。\\(X\\) はどういう確率分布に従うか。"
  },
  {
    "objectID": "post/data_math_quest/index.html#回答",
    "href": "post/data_math_quest/index.html#回答",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "回答",
    "text": "回答\nといてない"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-1",
    "href": "post/data_math_quest/index.html#問題概要-1",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(X \\sim N(\\mu, \\sigma^2)\\)\n⑴ \\(P(\\mu - c \\leq X \\leq \\mu + c)=0.95\\) となる\\(c\\)\n⑵ \\(P(\\mu - 2\\sigma \\leq X \\leq \\mu + \\sigma)\\) の確率。\\(P(X \\leq d)=0.05\\) となる\\(d\\)。\n⑶ \\(Y=aX+b\\), \\(Y\\) の確率分布は？"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-17",
    "href": "post/data_math_quest/index.html#解答-17",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n⑴\n\\(X\\) を標準化した確率変数 \\(Z=\\frac{X-\\mu}{\\sigma}\\) を使い、標準正規分布表を用いて考える。\n\\(Z \\sim N(0,1)\\) であり、\\(P(-1.96 \\leq Z \\leq 1.96) = 0.95\\) である。\n\\[\n\\begin{aligned}\nP(\\mu - c \\leq X \\leq \\mu + c)\n&= P(\\frac{\\mu - c-\\mu}{\\sigma} \\leq \\frac{X-\\mu}{\\sigma} \\leq \\frac{\\mu + c-\\mu}{\\sigma}) \\\\\n&=P(\\frac{ - c}{\\sigma} \\leq \\frac{X-\\mu}{\\sigma} \\leq \\frac{c}{\\sigma}) \\\\\n&= P(-1.96 \\leq Z \\leq 1.96) \\\\\n\\end{aligned}\n\\]\nよって \\(\\frac{c}{\\sigma}=1.96\\) であり、\\(c=1.96\\sigma\\)\n⑵\n同じく標準化して考える。\n\\[\n\\begin{aligned}\nP(\\mu - 2\\sigma \\leq X \\leq \\mu + \\sigma)\n&= P( \\frac{\\mu - 2\\sigma -\\mu}{ \\sigma} \\leq \\frac{X-\\mu}{\\sigma} \\leq \\frac{\\mu + \\sigma -\\mu}{ \\sigma}) \\\\\n&= P(-2 \\leq Z \\leq 1) \\\\\n&= \\Phi(1) - \\Phi(-2) \\\\\n&= 1 - 0.1587 - 0.0228 \\\\\n&= 0.82\n\\end{aligned}\n\\]\n二つ目の問題も同じ解き方である。\n\\[\n\\begin{aligned}\nP(X \\leq d)=P(\\frac{X - \\mu}{\\sigma} \\leq \\frac{d - \\mu}{\\sigma})\n=P(Z \\leq \\frac{d - \\mu}{\\sigma})\n\\end{aligned}\n\\]\n標準正規分布表で累積確率が0.05となる値は-1.64である。\n\\(\\frac{d - \\mu}{\\sigma} = -1.64\\) より \\(d = \\mu - 1.64 \\sigma\\)\n⑶\n(命題) \\(X \\sim N(\\mu,\\sigma)\\) を\\(Y=aX+b\\)という変換をすると、 \\(N(a \\mu + b, a^2 \\sigma^2)\\) 。\n一応１から書く！\n変数変換の公式から, \\(X\\) の確率関数を\\(f_X(x)\\)とすると、\\(Y=aX+b\\)の確率関数は\n\\[\nf_Y(y)=\\frac{1}{|a|} f_X(\\frac{y-b}{a})\n\\]\nである。\nよって、\n\\[\n\\begin{aligned}\nf_Y(y) &= \\frac{1}{|a|} f_X(\\frac{y-b}{a}) \\\\\n&=  \\frac{1}{\\sqrt{2 \\pi \\sigma^2}|a|} \\exp\\left\\{ - \\frac{(\\frac{y-b}{a} - \\mu)^2}{2 \\sigma^2}\\right\\} \\\\\n&= \\frac{1}{\\sqrt{2 \\pi \\sigma^2}|a|} \\exp\\left\\{ - \\frac{(y-b - a\\mu)^2}{2 a^2\\sigma^2}\\right\\} \\\\\n\\end{aligned}\n\\]\nとなる。この確率密度関数は\\(E[Y]= a \\mu + b\\),\\(Var(Y)= a^2 \\sigma^2\\) の正規分布に従う確率密度関数と一致するため、\\(Y \\sim N(a \\mu + b ,a^2 \\sigma^2)\\)"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-2",
    "href": "post/data_math_quest/index.html#問題概要-2",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(X \\sim Geo(\\frac{\\theta}{n})\\), \\(\\lim_{n \\to \\infty}P(X \\leq n)\\) を求める問題"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-18",
    "href": "post/data_math_quest/index.html#解答-18",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n幾何分布の確率関数は、\\(p(x)= \\frac{\\theta}{n} (1 - \\frac{\\theta}{n})^x\\)\n\\[\n\\begin{aligned}\nP(X \\leq n) &= \\sum_{x=0}^n \\frac{\\theta}{n} (1 - \\frac{\\theta}{n})^x \\\\\n&= \\frac{\\theta}{n} \\frac{1-(1 - \\frac{\\theta}{n})^{n+1}}{1-(1 - \\frac{\\theta}{n})} \\\\\n&= 1-(1 - \\frac{\\theta}{n})^{n+1}\n\\end{aligned}\n\\]\nである。これの極限を求める。\n\\[\n\\begin{aligned}\n\\lim_{n \\to \\infty}P(X \\leq n) = \\lim_{n \\to \\infty}1-(1 - \\frac{\\theta}{n})^{n+1}\n= 1 - e^{-\\theta}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-3",
    "href": "post/data_math_quest/index.html#問題概要-3",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(X,Y\\)が確率変数で、1~4を２回やるときの和と差に対応。\n\n小問1\n\\(f(4,0), f(5,3)\\) を求める。\n\n\n小問2\n\\(f_X(6),f_Y(2)\\) を求める。\n\n\n小問3\n\\(f_{Y|X}(2|4),f_{X|Y}(5|1)\\)"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-19",
    "href": "post/data_math_quest/index.html#解答-19",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n⑴\n期待値の定義から求める。\n\\[\n\\begin{aligned}\nE[\\frac{1}{X+1}] &= \\sum_{x=0}^\\infty \\frac{1}{x+1} \\frac{\\lambda^x}{x!} e^{-\\lambda} \\\\\n&= \\sum_{x=0}^\\infty  \\frac{\\lambda^{x+1}}{(x+1)!} e^{-\\lambda} \\times \\frac{1}{\\lambda} \\\\\n&= \\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!} e^{-\\lambda} \\times \\frac{1}{\\lambda} \\\\\n&= \\frac{1}{\\lambda}(e^{\\lambda}-1)e^{\\lambda} \\\\\n&= \\frac{1}{\\lambda} (1-e^{-\\lambda})\n\\end{aligned}\n\\]\n\\(1-e^{-\\lambda}\\) の補足。\n\\[\n\\begin{aligned}\ne^\\lambda = 1 + \\lambda + \\frac{\\lambda^2}{2!}+ \\frac{\\lambda^3}{3!} + \\dots = \\sum_{x=0}^{\\infty} \\frac{\\lambda^x}{x!}\n\\end{aligned}\n\\]\nを用いて、\\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!}\\) を求めたい。これは\\(\\sum_{x=0}^{\\infty} \\frac{\\lambda^x}{x!}\\) から\\(x=0\\) の時を引けば良い。\\(x=0\\) のときは1であり, \\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!} = e^{\\lambda}-1\\)　であり、\\(\\sum_{x'=1}^\\infty  \\frac{\\lambda^{x'}}{x'!}e^{-\\lambda} = (e^{\\lambda}-1)e^{\\lambda} = 1-e^{-\\lambda}\\)\nになるってことだと思ってる。\n⑵\n階乗を利用して同じようにときたいので、\\(E[\\frac{1}{(X+2)(X+1)}]\\) をまず求める。⑴で求めた\\(E[\\frac{1}{X+1}]\\) と合わせて計算すると求めれるはず。\n\\[\n\\begin{aligned}\nE[\\frac{1}{(X+2)(X+1)}] &= \\sum_{x=0}^\\infty \\frac{1}{(x+1)(x+1)} \\frac{\\lambda^x}{x!} e^{-\\lambda} \\\\\n&= \\sum_{x=0}^\\infty  \\frac{\\lambda^{x+2}}{(x+2)!} e^{-\\lambda} \\times \\frac{1}{\\lambda^2} \\\\\n&= \\sum_{x'=2}^\\infty  \\frac{\\lambda^{x'}}{x'!} e^{-\\lambda} \\times \\frac{1}{\\lambda^2} \\\\\n&= \\frac{1}{\\lambda^2} (e^\\lambda -1 - \\lambda) e^{-\\lambda} \\\\\n&= \\frac{1}{\\lambda^2} (1- e^{-\\lambda} - \\lambda e^{-\\lambda} )\n\\end{aligned}\n\\]\n\\(e^\\lambda -1 - \\lambda\\) の補足。\n⑴と同じで、x=0,1の時の1と\\(\\lambda\\) を引いてる。\n\\[\n\\begin{aligned}\nE[\\frac{1}{X+2}] &= E[\\frac{X+1}{(X+2)(X+1)}] \\\\\n&=E[\\frac{X+2-1}{(X+2)(X+1)}] \\\\\n&=E[\\frac{1}{X+1}]-E[\\frac{1}{(X+2)(X+1)}]\\\\\n&= \\frac{1}{\\lambda} (1-e^{-\\lambda}) -\\frac{1}{\\lambda^2} (1- e^{-\\lambda} - \\lambda e^{-\\lambda} ) \\\\\n&= \\frac{1}{\\lambda^2} (-1 + \\lambda + e^{-\\lambda})\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-4",
    "href": "post/data_math_quest/index.html#問題概要-4",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n多項分布について。\n\n小問1\n多項分布の周辺分布は二項分布か、周辺分布の和の分布はどうなるか。\n\n\n小問2\n\\(X_1\\) を与えた時の、\\(X_2\\)の条件付き確率。\n\n\n小問3\n\\(X_1+X_2\\) を与えた時の\\(X_2\\) の条件付き確率。"
  },
  {
    "objectID": "post/data_math_quest/index.html#回答-1",
    "href": "post/data_math_quest/index.html#回答-1",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "回答",
    "text": "回答\n\n小問1\n\\[\nf(4,0)=P(X=4,Y=0) = \\frac{1}{16}\n\\]\n\\[\nf(5,3)=P(X=5,Y=3) = \\frac{2}{16} = \\frac{1}{8}\n\\]\n\n\n小問2\n\\[\nf_X(6)= f(6,0)+f(6,1)+f(6,2)+f(6,3)= \\frac{1}{16} + 0 + \\frac{2}{16} + 0 =\\frac{3}{16}\n\\]\n\\[\nf_Y(2)= f(2,2)+f(3,2)+f(4,2)+f(5,2)+f(6,2)+f(7,2)+f(8,2)= 0+ 0+ \\frac{2}{16}+0+\\frac{2}{16}+0+0=\\frac{1}{4}\n\\]\n\n\n小問3\n\\[\nf_{Y|X}(2|4)=\\frac{f(4,2)}{f_X(4)}=\\frac{f(4,2)}{f(4,0)+f(4,1)+f(4,2)+f(4,3)} =\\frac{2/16}{1/16+2/16}=\\frac{2}{3}\n\\]\n\\[\nf_{X|Y}(5|1) = \\frac{f(5,1)}{f_Y(1)}= \\frac{f(5,1)}{f(2,1)+f(3,1)+f(4,1)+f(5,1)+f(6,1)+f(7,1)+f(8,1)} = \\frac{2/16}{2/16+2/16+2/16}= \\frac{1}{3}\n\\]"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-5",
    "href": "post/data_math_quest/index.html#問題概要-5",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(X,Y\\) がそれぞれポアソン分布に従う。\n\n小問1\n\\(Z=X+Y\\) の分布を求めよ。\n\n\n小問2\n\\(X+Y=n\\)に固定した時、\\(X\\) の条件付き分布を求める。"
  },
  {
    "objectID": "post/data_math_quest/index.html#回答-2",
    "href": "post/data_math_quest/index.html#回答-2",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "回答",
    "text": "回答\n\n小問1\n多項分布は多次元の確率変数で、\\(1\\)から\\(m\\) の番号が書かれた多面体を\\(n\\) 回投げる時に、それぞれの面が出る確率を\\(p_1,p_2,\\dots,p_m=1\\) とし、\\(X_1+X_2+ \\dots + X_m=n\\) である分布。\n\\(X_i\\) の周辺分布は\\(i\\)　番目が出るか出ないかであり、\\(Bin(n,p_i)\\)となるし、\\(X_i+X_j\\) の周辺分布は\\(i\\)番目もしくは\\(j\\)　番目が出るか出ないかなので\\(Bin(n,p_i+p_j)\\) である。\nサイコロで考えてみるとわかりやすいかも。\n\n\n小問2\n求めたいのは\\(\\frac{P(X_1=x_1,X_2=x_2)}{P(X_1=x_1)}\\) である。それぞれ、\n\\[\nP(X=x_1)= \\frac{n!}{x_1!(n-x_1)!} p_1^{x_1}(1-p_1)^{n-x_1}\n\\]\n\\[\nP(X_1=x_1,X_2=x_2)= \\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}\n\\]\nよって\n\\[\n\\begin{aligned}\n\\frac{P(X_1=x_1,X_2=x_2)}{P(X_1=x_1)}\n=\\frac{\\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}}{\\frac{n!}{x_1!(n-x_1)!} p_1^{x_1}(1-p_1)^{n-x_1}} \\\\\n= \\frac{(n-x_1)!}{x_2!(n-x_1-x_2)!} (\\frac{p_2}{1-p_1})^{x_2} (\\frac{1-p_1-p_2}{1-p_1})^{n-x_1-x_2}\n\\end{aligned}\n\\]\nこれによって条件付き確率は二項分布\\(Bin(n-x_1,\\frac{p_2}{1-p_1})\\) に従う。\n直感的にも、例えばサイコロを１０回投げるとして1の目が２回出たことを知っていたら、2の目が出る確率は試行回数が8回で2~6の1/5の確率で出る二項分布というのはしっくりきます。\n\n\n小問3\n求めたいのは\\(\\frac{P(X_2=x_2)}{P(X_1+X_2=z)}=\\frac{P(X_2=x_2)}{P(X_1+X_2=x_1+x_2)}\\) である。\n(変数\\(x_2\\)が与えられれば\\(x_1\\)は自ずと決まるので、\\(x_1\\)を使う。)\nそれぞれ\n\\[\nP(X_1+X_2=x_1+x_2)=\\frac{n!}{(x_1+x_2)!(n-x_1-x_2)!}(p_1+p_2)^{x_1+x_2}(1-p_1-p_2)^{n-x_1-x_2}\n\\]\n\\[\nP(X_2=x_2,X_1+X_2=x_1+x_2)=P(X_1=x_1,X_2=x_2)= \\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_2}\n\\]\n\\[\n\\begin{aligned}\n\\frac{P(X_2=x_2)}{P(X_1+X_2=x_1+x_2)}=\\frac{\\frac{n!}{x_1!x_2!(n-x_1-x_2)!}p_1^{x_1} p_2^{x_2}(1-p_1-p_2)^{n-x_1-x_2}}{\\frac{n!}{(x_1+x_2)!(n-x_1-x_2)!}(p_1+p_2)^{x_1+x_2}(1-p_1-p_2)^{n-x_1-x_2}} \\\\\n=\\frac{(x_1+x_2)!}{x_1!x_2!} (\\frac{p_2}{p_1+p_2})^{x_2}(\\frac{p_1}{p_1+p_2})^{x_1}\n\\end{aligned}\n\\]\nよって条件付き分布は二項分布\\(Bin(z,\\frac{p_2}{p_1+p_2})\\) に従う。\nこれもサイコロで例えると、１の目が出た回数と2の目が出た回数が合計4回だと知っているとき、2の目が出る確率は試行回数4回で1/2の二項分布の確率になりそうですよね。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-6",
    "href": "post/data_math_quest/index.html#問題概要-6",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(f(x,y)=xe^{-x(y+1)} I(x &gt; 0,y&gt;0)\\) の周辺確率、条件確率、\\(P(XY &gt; 1)\\) を計算。"
  },
  {
    "objectID": "post/data_math_quest/index.html#回答-3",
    "href": "post/data_math_quest/index.html#回答-3",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "回答",
    "text": "回答\n\n小問1\n再生性からと言いたいところですが、誘導に乗ってみます。（離散確率の変数変換の方法ってどこかに載ってたかな）\n\\(X=x\\) という実現値を取る時、\\(Y\\) は自ずと\\(n-x\\) という実現時をとる。\\(X\\) と\\(Y\\) は独立であり、同時確率は積であらわすことができるため、\n\\[\nP(X+Y=n) = \\sum_{x=0}^n P(X=x)P(Y=n-x)\n\\]\nと表せる。これを計算すると\n\\[\n\\begin{aligned}\n\\sum_{x=0}^n P(X=x)P(Y=n-x) &= \\sum_{x=0}^n\\frac{\\lambda_1^x}{x!}e^{-\\lambda_1}\\frac{\\lambda_2^{n-x}}{(n-x)!}e^{-\\lambda_2} \\\\\n&=\\frac{(\\lambda_1+\\lambda_2)^n}{n!} e^{-(\\lambda_1+\\lambda_2)} \\sum_{x=0}^n\\frac{n!}{x!(n-x)!} \\left(\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\right)^x \\left(\\frac{\\lambda_2}{\\lambda_1+\\lambda_2}\\right)^{n-x} \\\\\n&=\\frac{(\\lambda_1+\\lambda_2)^n}{n!} e^{-(\\lambda_1+\\lambda_2)}\n\\end{aligned}\n\\]\n\\(\\displaystyle \\sum_{x=0}^n\\frac{n!}{x!(n-x)!} \\left(\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\right)^x \\left(\\frac{\\lambda_2}{\\lambda_1+\\lambda_2}\\right)^{n-x}\\) は嬉しいことに、二項分布\\(\\displaystyle Bin(n,\\frac{\\lambda_1}{\\lambda_1+\\lambda_2})\\) に従う分布の全確率？（用語があっているかわからない）なので1になります。\n\\(X+Y=n\\) という確率変数が従う分布は\\(Po(\\lambda_1+\\lambda_2)\\) になります。\n例えば\\(X \\sim Po(2)\\),\\(Y \\sim Po(3)\\) なら\\(X+Y \\sim Po(5)\\) になるみたいなことですね。\n\n\n小問2\n求めたいのは\\(\\displaystyle \\frac{P(X+Y=n,X=x)}{P(X+Y=n)}\\) である。\nまた\\(P(X+Y=n,X=x)=P(X=x,Y=n-x)\\) とも表せれるので、\n\\[\n\\begin{aligned}\n  \\frac{P(X=x,Y=n-x)}{P(X+Y=n)} &=\\frac{\\frac{\\lambda_1^x}{x!}e^{-\\lambda_1}\\frac{\\lambda_2^{n-x}}{(n-x)!}e^{-\\lambda_2}}{\\frac{(\\lambda_1+\\lambda_2)^n}{n!} e^{-(\\lambda_1+\\lambda_2)}} \\\\\n  &=\\frac{n!}{x!(n-x)!} \\left(\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\right)^x \\left(\\frac{\\lambda_2}{\\lambda_1+\\lambda_2}\\right)^{n-x}\n\\end{aligned}\n\\]\n綺麗に二項分布\\(\\displaystyle Bin(n,\\frac{\\lambda_1}{\\lambda_1+\\lambda_2})\\)に従います！\nちなみに統計検定準１級の勉強でも出てきました。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-7",
    "href": "post/data_math_quest/index.html#問題概要-7",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n\\(X \\sim Po(\\lambda)\\)\n⑴ \\(E[\\frac{1}{X+1}]\\)\n⑵ \\(E[\\frac{1}{X+2}]\\)"
  },
  {
    "objectID": "post/data_math_quest/index.html#回答-4",
    "href": "post/data_math_quest/index.html#回答-4",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "回答",
    "text": "回答\n\\[\n\\begin{aligned}\n  f_X(x)\n  &= \\int^{\\infty}_{0} xe^{-x(y+1)} dy \\\\\n  &= xe^{-x} \\int^{\\infty}_{0} e^{-xy} dy \\\\\n  &= xe^{-x} \\left[-\\frac{1}{x}e^{-xy}\\right]^{\\infty}_{y=0} \\\\\n  &= e^{-x}\n\\end{aligned}\n\\]\n\\[\n\\begin{aligned}\n  f_Y(y)\n  &= \\int^{\\infty}_{0} xe^{-x(y+1)} dx \\\\\n  &= \\frac{1}{(y+1)^2} \\int^{\\infty}_{0} \\frac{1}{\\Gamma(2) (y+1)^{-2}} xe^{-x(y+1)} dx \\\\\n  &= \\frac{1}{(y+1)^2}\n\\end{aligned}\n\\]\n\\(xe^{-x}\\) みたいな形を見つけたら、ガンマ関数の式に持っていくのがよくある計算だと感じてきた。\n\\(xe^{-x(y+1)}\\)から\\(\\alpha=2,\\beta=(y+1)^{-1}\\) にしたら都合がよさそうなことから、この変形をしている。\n\\[\n\\begin{aligned}\nf_{X|Y}(x|y)\n&= \\frac{f(x,y)}{f_Y(y)} \\\\\n&= \\frac{xe^{-x(y+1)} }{(y+1)^{-2} } \\\\\n&= \\frac{1}{\\Gamma(2)(y+1)^2} x^{2-1} e^{-(y+1)x}\n\\end{aligned}\n\\]\n３つ目の等式はガンマ分布に落ち着きそうな気配を察して、\\(\\Gamma(2)=1\\)を入れている。\nよって\n\\[\nX|Y=y \\sim Ga(2,(y+1)^{-1})\n\\]\nとなる。\n\\[\n\\begin{aligned}\nf_{Y|X}(y|x)\n&= \\frac{f(x,y)}{f_X(x)} \\\\\n&= \\frac{xe^{-x(y+1)} }{e^{-x}} \\\\\n&= xe^{-xy}\n\\end{aligned}\n\\]\n一瞬見慣れないと思いきや、\\(y\\) の関数で\\(x\\)はすでに与えられているパラメーターです。すると指数分布\\(Ex(x)\\)に従うことがわかります。\n\\[\n\\begin{aligned}\n  P(XY&gt;1) &= \\int^{\\infty}_{0} \\int^{\\infty}_{\\frac{1}{x}} xe^{-x(y+1)} dy dx \\\\\n  &= \\int^{\\infty}_{0} x e^{-x} \\\\\n  &= \\frac{1}{e}\n\\end{aligned}\n\\]\n\\(\\int^{\\infty}_{0} \\int^{\\infty}_{\\frac{1}{x}}\\) がしっくりきてない。なんとなくそうな気はするけど、\\(\\int^{\\infty}_{\\frac{1}{y}} \\int^{\\infty}_{\\frac{1}{x}}\\) じゃだめなのかがわからない。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-8",
    "href": "post/data_math_quest/index.html#問題概要-8",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n連続確率変数\\(X\\) の分布関数が以下。\n\\[\nF(x) =\n\\begin{cases}\n0  & (- \\infty \\leq x \\leq 0)\\\\\n1-\\frac{(x-2)^2}{4} & (0 \\leq x \\leq 2)\\\\\n1 &(2 \\leq x)\n\\end{cases}\n\\]\n⑴ 確率密度関数を求める。\n⑵ \\(E[X], V(X)\\) を求める。\n⑶ メディアン、モードを求める。"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-20",
    "href": "post/data_math_quest/index.html#解答-20",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n⑴ \\(0 \\leq x \\leq 2\\) のとき、\n\\[\nf(x)= F'(x)= -2 \\frac{x-2}{4} = \\frac{2-x}{2}\n\\]\n\\[\nF(x) =\n\\begin{cases}\n0  & (- \\infty \\leq x \\leq 0)\\\\\n\\frac{2-x}{2} & (0 \\leq x \\leq 2)\\\\\n0 &(2 \\leq x)\n\\end{cases}\n\\]\n⑵\n\\[\n\\begin{aligned}\nE[X^k]&=  \\int^{2}_{0} x^k \\frac{2-x}{2}dx \\\\\n&=  \\int^{2}_{0} x^kdx - \\frac{1}{2} \\int^{2}_{0} x^{k+1}dx \\\\\n&= [\\frac{1}{k+1}x^{k+1}]^2_0-\\frac{1}{2}[\\frac{1}{k+2}x^{k+2}]^2_0 \\\\\n&= \\frac{2^{k+1}}{k+1} - \\frac{2^{k+1}}{k+2} \\\\\n&= \\frac{2^{k+1}}{(k+1)(k+2)}\n\\end{aligned}\n\\]\n\\(E[X]=\\frac{2^2}{(2)(3)}=\\frac{2}{3}\\),\\(E[X^2]=\\frac{2^3}{(3)(4)}=\\frac{2}{3}\\)である。\n\\(V[X]=\\frac{2}{3}-\\frac{4}{9}=\\frac{2}{9}\\)\n⑶\nメディアンを\\(x_{med}\\) とする。モードは\\(x_{mode}\\) とする。\nメディアンは累積確率が0.5になるところなので、\n\\[\n\\begin{aligned}\n1 - \\frac{(x_{med}-2)^2}{4} = \\frac{1}{2} \\\\\nx_{med} = 2 \\pm \\sqrt{2}\n\\end{aligned}\n\\]\n\\(0 \\leq x \\leq 2\\) より\\(x_{med}= 2-\\sqrt{2}\\)\nモードは\\(f(x)\\)が最大となる値なので、\\(f'(x)\\) からわかる。\\(0 \\leq x \\leq 2\\) のとき\\(f'(x)=-1\\) より\\(x=0\\) がモードとなる。"
  },
  {
    "objectID": "post/data_math_quest/index.html#問題概要-9",
    "href": "post/data_math_quest/index.html#問題概要-9",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "問題概要",
    "text": "問題概要\n連続確率変数\\(X\\) の分布関数が以下。\n\\[\nF(x) =\n\\begin{cases}\n0  & (- \\infty \\leq x \\leq 0)\\\\\n1-\\frac{(x-2)^2}{4} & (0 \\leq x \\leq 2)\\\\\n1 &(2 \\leq x)\n\\end{cases}\n\\]\n⑴ 確率密度関数を求める。\n⑵ \\(E[X], V(X)\\) を求める。\n⑶ メディアン、モードを求める。"
  },
  {
    "objectID": "post/data_math_quest/index.html#解答-21",
    "href": "post/data_math_quest/index.html#解答-21",
    "title": "「データ解析のための数理統計入門」第1章 演習問題 解答",
    "section": "解答",
    "text": "解答\n⑴ \\(0 \\leq x \\leq 2\\) のとき、\n\\[\nf(x)= F'(x)= -2 \\frac{x-2}{4} = \\frac{2-x}{2}\n\\]\n\\[\nF(x) =\n\\begin{cases}\n0  & (- \\infty \\leq x \\leq 0)\\\\\n\\frac{2-x}{2} & (0 \\leq x \\leq 2)\\\\\n0 &(2 \\leq x)\n\\end{cases}\n\\]\n⑵\n\\[\n\\begin{aligned}\nE[X^k]&=  \\int^{2}_{0} x^k \\frac{2-x}{2}dx \\\\\n&=  \\int^{2}_{0} x^kdx - \\frac{1}{2} \\int^{2}_{0} x^{k+1}dx \\\\\n&= [\\frac{1}{k+1}x^{k+1}]^2_0-\\frac{1}{2}[\\frac{1}{k+2}x^{k+2}]^2_0 \\\\\n&= \\frac{2^{k+1}}{k+1} - \\frac{2^{k+1}}{k+2} \\\\\n&= \\frac{2^{k+1}}{(k+1)(k+2)}\n\\end{aligned}\n\\]\n\\(E[X]=\\frac{2^2}{(2)(3)}=\\frac{2}{3}\\),\\(E[X^2]=\\frac{2^3}{(3)(4)}=\\frac{2}{3}\\)である。\n\\(V[X]=\\frac{2}{3}-\\frac{4}{9}=\\frac{2}{9}\\)\n⑶\nメディアンを\\(x_{med}\\) とする。モードは\\(x_{mode}\\) とする。\nメディアンは累積確率が0.5になるところなので、\n\\[\n\\begin{aligned}\n1 - \\frac{(x_{med}-2)^2}{4} = \\frac{1}{2} \\\\\nx_{med} = 2 \\pm \\sqrt{2}\n\\end{aligned}\n\\]\n\\(0 \\leq x \\leq 2\\) より\\(x_{med}= 2-\\sqrt{2}\\)\nモードは\\(f(x)\\)が最大となる値なので、\\(f'(x)\\) からわかる。\\(0 \\leq x \\leq 2\\) のとき\\(f'(x)=-1\\) より\\(x=0\\) がモードとなる。"
  },
  {
    "objectID": "seminar/seminar2024_1105/page-reveal.html#項分布",
    "href": "seminar/seminar2024_1105/page-reveal.html#項分布",
    "title": "11月5日　7-4",
    "section": "２項分布",
    "text": "２項分布\n\\(X \\sim Bin(n,p)\\)とする。\nまず二項分布における\\(p\\) の推定量を\\(\\displaystyle \\hat{p}=\\frac{X}{n}\\) とおく。 \\(\\displaystyle E_p[\\hat{p}] = \\frac{E_p[X]}{n}=\\frac{np}{n}=p\\) より不偏推定量である。\nちなみに不偏推定量の定義は、以下である。\n\n定理 1 \n\\(\\hat{\\theta}\\) が不偏推定量であるとは\n\\[\nE_\\theta[\\hat{\\theta}(X)] = \\theta, \\quad \\delta\\theta\n\\]\nが成り立つことである。\n\n\n\n\n不偏推定量 \\(\\displaystyle \\hat{p}=\\frac{X}{n}\\) がUMVUであることを示すには、次の等式を満たす。\n\n定理 2 (クラメル・ラオの不等式を用いたUMVUの証明) \n不偏推定量\\(\\hat{\\theta^*}\\) が\n\\[\nVar_\\theta[\\hat{\\theta^*}] = \\frac{1}{I_n(\\theta)},\\quad \\delta\\theta\n\\]\nを満たせば、\\(\\hat{\\theta*}\\)はUMVUである。\n\nつまり、\\(\\displaystyle Var_\\theta \\left[\\hat{p}\\right] = \\frac{1}{I_n(\\theta)}\\) であることを示したい。\n\n\n\nまず、推定量の分散は\\(\\displaystyle Var[\\hat{p}]=\\frac{Var[X]}{n^2}=\\frac{p(1-p)}{n}\\) である。\n\n\n\n次にフィッシャー情報量\\(I_n(\\theta)\\)を求めたい。\n\n定理 3 (フィッシャー情報量の求め方) \n\\(\\ell'(\\theta,X)\\)は対数充度関数\\(\\ell(\\theta,X)\\) を\\(\\theta\\) で微分したものである。\n\\[\nI_n(\\theta) = E_\\theta \\left[(\\ell'(\\theta,X)^2)\\right]\n\\]\n\n２項分布の確率変数 \\(f(x,p)=p^x(1-p)^{n-x}\\begin{pmatrix}\nn  \\\\\nx  \\\\\n\\end{pmatrix}\\)の対数を\\(p\\) で微分すると\n\\[\n\\begin{aligned}\n    \\ell'(p, x) &= \\frac{\\partial}{\\partial p} \\left( x \\log p + (n - x) \\log (1 - p) + \\log \\binom{n}{x} \\right) \\\\\n    &= \\frac{x}{p}+\\frac{-(n-x)}{1-p} = \\frac{x-np}{p(1-p)}\n\\end{aligned}\n\\]\nとなる。従ってフィッシャー情報量は\n\\[\nI(p)=E[\\ell'(p,X)^2]=\\frac{E[(X-np)^2]}{(p(1-p))^2} =\\frac{np(1-p)}{(p(1-p))^2} = \\frac{n}{p(1-p)}\n\\]\nとなり、これは\\(\\displaystyle \\frac{1}{Var_p[\\hat{p}]}\\) に一致する。したがって\\(\\hat{p}\\)は\\(UMVU\\)であることが確かめられた。\n\\(E[(X-np)^2]\\)はテクニカル！"
  },
  {
    "objectID": "seminar/seminar2024_1105/page-reveal.html#正規分布",
    "href": "seminar/seminar2024_1105/page-reveal.html#正規分布",
    "title": "11月5日　7-4",
    "section": "正規分布",
    "text": "正規分布\n次に正規分布の母平均\\(\\mu\\)の推定において標本平均\\(\\bar{X}\\) がUMVUであることを示す。\nまず、\\(\\mu\\) に関するフィッシャー情報量を求める。\n\\[\n\\ell(\\mu,x)= - \\frac{(x-\\mu)^2}{2\\sigma^2} - \\frac{1}{2} \\log(2\\pi \\sigma^2)\n\\]\nを\\(\\mu\\) で偏微分すると\\(\\displaystyle \\ell'(\\mu,x)=\\frac{x-\\mu}{\\sigma^2}\\) を得る。したがって、\n\\[\nI(\\mu)=\\frac{E[(X-\\mu)^2]}{\\sigma^4} = \\frac{1}{\\sigma^2}\n\\]\nとなり、\\(\\bar{X}\\) がUMVUであることが示された。\n\\(E[(X-\\mu)^2]\\)もテクニカル！"
  },
  {
    "objectID": "seminar/seminar2024_1105/index.html#クラメルラオの不等式",
    "href": "seminar/seminar2024_1105/index.html#クラメルラオの不等式",
    "title": "11月5日　7-4",
    "section": "",
    "text": "\\[\nE_\\theta[\\hat{\\theta}(X)] = \\theta, \\quad \\delta\\theta\n\\]\nが成り立つことである。"
  }
]