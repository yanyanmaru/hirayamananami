[
  {
    "objectID": "memo/latex_code_copy.html",
    "href": "memo/latex_code_copy.html",
    "title": "LaTeX　自分用",
    "section": "",
    "text": "頻繁に使いそうなものを準備しておく。\n\n\n\n\n\n\n\n\n\n\n\n説明\n表示\nLaTeXコード\nコピーボタン\n\n\n\n\nポアソン分布の確率関数\n\\(\\frac{\\lambda^x}{x!}e^{-\\lambda}\\)\n\\frac{\\lambda^x}{x!}e^{-\\lambda}\nCOPY\n\n\n二項分布の確率関数\n\\({}_n C_x p^x (1-p)^{n-x}\\)\n{}_n C_x p^x (1-p)^{n-x}\nCOPY\n\n\n正規分布の確率密度関数\n\\(\\frac{1}{\\sqrt{2 \\pi \\sigma^2}}\\exp\\{-\\frac{(x-u)^2}{2\\sigma^2}\\}\\)\n\\frac{1}{\\sqrt{2 \\pi \\sigma^2}}\\exp\\{- \\frac{(x-u)^2}{2\\sigma^2}\\}\nCOPY\n\n\n標準正規分布の確率密度関数\n\\(\\frac{1}{\\sqrt{2 \\pi}}\\exp\\{-\\frac{z^2}{2}\\}\\)\n\\frac{1}{\\sqrt{2 \\pi}}\\exp\\{-\\frac{z^2}{2}\\}\nCOPY"
  },
  {
    "objectID": "memo/latex_code_copy.html#統計学",
    "href": "memo/latex_code_copy.html#統計学",
    "title": "LaTeX　自分用",
    "section": "",
    "text": "説明\n表示\nLaTeXコード\nコピーボタン\n\n\n\n\nポアソン分布の確率関数\n\\(\\frac{\\lambda^x}{x!}e^{-\\lambda}\\)\n\\frac{\\lambda^x}{x!}e^{-\\lambda}\nCOPY\n\n\n二項分布の確率関数\n\\({}_n C_x p^x (1-p)^{n-x}\\)\n{}_n C_x p^x (1-p)^{n-x}\nCOPY\n\n\n正規分布の確率密度関数\n\\(\\frac{1}{\\sqrt{2 \\pi \\sigma^2}}\\exp\\{-\\frac{(x-u)^2}{2\\sigma^2}\\}\\)\n\\frac{1}{\\sqrt{2 \\pi \\sigma^2}}\\exp\\{- \\frac{(x-u)^2}{2\\sigma^2}\\}\nCOPY\n\n\n標準正規分布の確率密度関数\n\\(\\frac{1}{\\sqrt{2 \\pi}}\\exp\\{-\\frac{z^2}{2}\\}\\)\n\\frac{1}{\\sqrt{2 \\pi}}\\exp\\{-\\frac{z^2}{2}\\}\nCOPY"
  },
  {
    "objectID": "memo/latex_code_copy.html#数式",
    "href": "memo/latex_code_copy.html#数式",
    "title": "LaTeX　自分用",
    "section": "",
    "text": "表示\nLaTeXコード\nコピーボタン\n\n\n\n\n\\(\\sigma\\)\n\\sigma\nCOPY\n\n\n\\(&lt;\\)\n&lt;\nCOPY\n\n\n\\(\\le\\)\n\\le\nCOPY"
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Seminor",
    "section": "",
    "text": "並び替え\n       デフォルト\n         \n          日付 - 日付（昇順）\n        \n         \n          日付 - 日付（降順）\n        \n         \n          題名\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n日付\n\n\n題名\n\n\nstatus\n\n\n\n\n\n\n2024/10/22\n\n\n10月22日「データ解析のための数理統計入門」第6章 連続補正\n\n\n作成中\n\n\n\n\n2024/10/08\n\n\n10月8日「データ解析のための数理統計入門」第5章\n\n\n完了\n\n\n\n\n2024/10/01\n\n\n10月1日「データ解析のための数理統計入門」第4章 4-3条件付き期待値前半\n\n\n完了\n\n\n\n\n2024/07/23\n\n\n7月23日「データ解析のための数理統計入門」第4章 命題4.21\n\n\n完了\n\n\n\n\n2024/07/16\n\n\n7月16日「データ解析のための数理統計入門」第4章 4の例18から\n\n\n完了\n\n\n\n\n2024/07/09\n\n\n7月9日「データ解析のための数理統計入門」第3章 演習問題　７問目\n\n\n完了\n\n\n\n\n2024/07/06\n\n\n「データ解析のための数理統計入門」第2章 演習問題 解答\n\n\n作成中\n\n\n\n\n2024/07/05\n\n\n「データ解析のための数理統計入門」第1章 演習問題 解答\n\n\n完了\n\n\n\n\n2024/07/02\n\n\n7月2日「データ解析のための数理統計入門」第3章 3.1と3.2の途中まで\n\n\n完了\n\n\n\n\n2024/06/25\n\n\n6月25日「データ解析のための数理統計入門」第2章 2.3 確率変数の変数変換\n\n\n完了\n\n\n\n\n2024/06/18\n\n\n6月18日「データ解析のための数理統計入門」第2章 2.1.6ポアソン分布\n\n\n完了\n\n\n\n\n2024/06/11\n\n\n6月11日「データ解析のための数理統計入門」第1章 例1.2, 問5\n\n\n完了\n\n\n\n\n\n一致なし"
  },
  {
    "objectID": "posts/seminor2024_0716/index.html",
    "href": "posts/seminor2024_0716/index.html",
    "title": "7月16日「データ解析のための数理統計入門」第4章 4の例18から",
    "section": "",
    "text": "\\(Ga(\\alpha, \\beta)\\) について積率母関数を求める。\n\n\n\\(M_X(t)\\) 積率母関数を求める。\n\\[\\begin{align}\nM_X(t)=E[e^{tX}]&=\\int^{\\infty}_{-\\infty} e^{tx} f(x) dx \\\\\n&=\\int^{\\infty}_0 e^{tx} \\frac{x^{\\alpha-1} e^{-x/\\beta}}{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} (1-\\beta t)^{\\alpha}} dx \\\\\n&=(1-\\beta t)^{-\\alpha} \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} } dx\n\\end{align}\\]\n\\((1-\\beta t)&gt;0\\)のとき、積分は，ガンマ分布\\(shape=\\alpha, scale=\\beta/(1-\\beta t)\\)の確率密度関数の標本空間\\((0,\\infty)\\)での積分と見なせるので 1 になる。\nよって積率母関数は \\((1-\\beta t)^{-\\alpha}\\) である。\n\n\n\n\\[\nM^{\\prime}_X(t)= (-\\alpha)(-\\beta)  (1-\\beta t)^{-\\alpha-1}=\\alpha \\beta  (1-\\beta t)^{-\\alpha-1}\n\\]\n\\[\nM^{\\prime \\prime}_X(t)= (-\\alpha-1)(-\\beta) \\alpha \\beta  (1-\\beta t)^{-\\alpha-2}=\\alpha (\\alpha+1)\\beta^2 (1-\\beta t)^{-\\alpha-2}\n\\]\n\n\n\n\\[\nE[X]= M^{\\prime}_X(0)=\\alpha \\beta\n\\]\n\\[\nE[X^2]=M^{\\prime \\prime}_X(0)= \\alpha (\\alpha+1)\\beta^2\n\\]\n\\[\nVar[X]=E[X^2]-E[X]^2= \\alpha (\\alpha+1)\\beta^2 - \\alpha^2 \\beta^2= \\alpha\\beta^2\n\\]"
  },
  {
    "objectID": "posts/seminor2024_0716/index.html#ガンマ分布の積率母関数",
    "href": "posts/seminor2024_0716/index.html#ガンマ分布の積率母関数",
    "title": "7月16日「データ解析のための数理統計入門」第4章 4の例18から",
    "section": "",
    "text": "\\(M_X(t)\\) 積率母関数を求める。\n\\[\\begin{align}\nM_X(t)=E[e^{tX}]&=\\int^{\\infty}_{-\\infty} e^{tx} f(x) dx \\\\\n&=\\int^{\\infty}_0 e^{tx} \\frac{x^{\\alpha-1} e^{-x/\\beta}}{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} (1-\\beta t)^{\\alpha}} dx \\\\\n&=(1-\\beta t)^{-\\alpha} \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} } dx\n\\end{align}\\]\n\\((1-\\beta t)&gt;0\\)のとき、積分は，ガンマ分布\\(shape=\\alpha, scale=\\beta/(1-\\beta t)\\)の確率密度関数の標本空間\\((0,\\infty)\\)での積分と見なせるので 1 になる。\nよって積率母関数は \\((1-\\beta t)^{-\\alpha}\\) である。\n\n\n\n\\[\nM^{\\prime}_X(t)= (-\\alpha)(-\\beta)  (1-\\beta t)^{-\\alpha-1}=\\alpha \\beta  (1-\\beta t)^{-\\alpha-1}\n\\]\n\\[\nM^{\\prime \\prime}_X(t)= (-\\alpha-1)(-\\beta) \\alpha \\beta  (1-\\beta t)^{-\\alpha-2}=\\alpha (\\alpha+1)\\beta^2 (1-\\beta t)^{-\\alpha-2}\n\\]\n\n\n\n\\[\nE[X]= M^{\\prime}_X(0)=\\alpha \\beta\n\\]\n\\[\nE[X^2]=M^{\\prime \\prime}_X(0)= \\alpha (\\alpha+1)\\beta^2\n\\]\n\\[\nVar[X]=E[X^2]-E[X]^2= \\alpha (\\alpha+1)\\beta^2 - \\alpha^2 \\beta^2= \\alpha\\beta^2\n\\]"
  },
  {
    "objectID": "posts/seminor2024_0716/page-reveal.html#ガンマ分布の積率母関数",
    "href": "posts/seminor2024_0716/page-reveal.html#ガンマ分布の積率母関数",
    "title": "7月16日「データ解析のための数理統計入門」第4章 4の例18から",
    "section": "ガンマ分布の積率母関数",
    "text": "ガンマ分布の積率母関数\n\\(M_X(t)\\) 積率母関数を求める。\n\\[\\begin{align}\nM_X(t)=E[e^{tX}]&=\\int^{\\infty}_{-\\infty} e^{tx} f(x) dx \\\\\n&=\\int^{\\infty}_0 e^{tx} \\frac{x^{\\alpha-1} e^{-x/\\beta}}{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) \\beta^{\\alpha}} dx \\\\\n&= \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} (1-\\beta t)^{\\alpha}} dx \\\\\n&=(1-\\beta t)^{-\\alpha} \\int^{\\infty}_0  \\frac{x^{\\alpha-1} \\exp\\{-\\frac{1-\\beta t}{\\beta}x\\} }{\\Gamma(\\alpha) (\\frac{\\beta}{1-\\beta t})^{\\alpha} } dx\n\\end{align}\\]\n\\((1-\\beta t)&gt;0\\)のとき、積分は，ガンマ分布\\(shape=\\alpha, scale=\\beta/(1-\\beta t)\\)の確率密度関数の標本空間\\((0,\\infty)\\)での積分と見なせるので 1 になる。\nよって積率母関数は \\((1-\\beta t)^{-\\alpha}\\) である。\n\n\n\n\\[\nM^{\\prime}_X(t)= (-\\alpha)(-\\beta)  (1-\\beta t)^{-\\alpha-1}=\\alpha \\beta  (1-\\beta t)^{-\\alpha-1}\n\\]\n\\[\nM^{\\prime \\prime}_X(t)= (-\\alpha-1)(-\\beta) \\alpha \\beta  (1-\\beta t)^{-\\alpha-2}=\\alpha (\\alpha+1)\\beta^2 (1-\\beta t)^{-\\alpha-2}\n\\]\n\n\n\n\\[\nE[X]= M^{\\prime}_X(0)=\\alpha \\beta\n\\]\n\\[\nE[X^2]=M^{\\prime \\prime}_X(0)= \\alpha (\\alpha+1)\\beta^2\n\\]\n\\[\nVar[X]=E[X^2]-E[X]^2= \\alpha (\\alpha+1)\\beta^2 - \\alpha^2 \\beta^2= \\alpha\\beta^2\n\\]"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Hirayama Nanami",
    "section": "",
    "text": "Seminor\nゼミの発表資料用。\n\n\nMemo\nメモ用。"
  },
  {
    "objectID": "memo.html",
    "href": "memo.html",
    "title": "Memo",
    "section": "",
    "text": "LaTeX　自分用"
  },
  {
    "objectID": "posts/seminor2024_1022/index.html",
    "href": "posts/seminor2024_1022/index.html",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "確率変数\\(X \\sim Bin(n,p)\\) に従うとする。整数\\(m_1,m_2\\) が\\(0 \\leq m_1 \\leq m_2 \\leq n\\) を満たす時、確率\\(P(m_1 \\leq X \\leq m_2 )\\) の近似値を中心極限定理を用いて求めることを考える。\n\n\n\n\\(X\\) はベルヌーイ分布に従う\\(n\\) 個の独立な確率変数の和で表される1ので、\\(n\\) が大きい時は中心極限定理が適用できて、\\((X-np)/\\sqrt{np(1-p)}\\) は標準正規分布で近似できる。\n1 \\(X_i \\sim Ber(p)\\) にそれぞれ従う時、\\(X=X_1+X_2+ \\cdots + X_n\\) とすると、和の分布である\\(X\\) は二項分布に従う。p18の定義にも書いてある。\\(X=X_1+X_2+ \\cdots + X_n\\) とすると、それぞれ独立に \\(X_i \\sim Ber(p)\\) より、\\(E[X_i]=p\\)、\\(V[X_i]=p(1-p)\\) になる。これを用いて、中心極限定理を適用すると、\n\\[\n\\frac{\\sqrt{n}(\\overline{X} - \\mu) }{\\sigma} = \\frac{\\sqrt{n}(\\frac{1}{n}(X_1+X_2+ \\cdots + X_n) - p) }{\\sqrt{p(1-p)}}= \\frac{\\frac{1}{\\sqrt{n}}(X - np) }{\\sqrt{p(1-p)}}=\\frac{X - np }{\\sqrt{np(1-p)}}\n\\]\nと計算されるので、\\(\\frac{X - np }{\\sqrt{np(1-p)}} \\sim N(0,1)\\) である。この形は、確率変数\\(X\\) を\\(E[X]=np\\),\\(V[X]=np(1-p)\\) で標準化しているともとれる2ので、\\(X \\sim Bin(n,p)\\) は\\(X \\sim N(np,np(1-p))\\) に近似できると考えることができるはず。\n2 \\(X \\sim N(\\mu,\\sigma^2)\\) を\\(Y=aX+b\\) という変換で考えると、\\(Y \\sim N(a \\mu +b, a^2 \\sigma^2)\\) で考えることもできるはず。p35の命題2.15参照。\n\n\nしたがって、\n\\[\nP(m_1 \\leq X \\leq m_2 ) \\approx \\Phi(\\frac{m_2-np}{\\sqrt{np(1-p)}})-\\Phi(\\frac{m_1-np}{\\sqrt{np(1-p)}})\n\\]\nのように近似し、標準正規分布の分布関数 \\(\\Phi(\\cdot)\\) を用いて確率を計算することができる。\nしかし、\\(m_1,m_2\\) が整数であるから\\(X=m_1,X=m_2\\) で確率を持つことになる。3 図6.2が示唆するように、\\(m_1 \\leq X \\leq m_2\\) の確率を考えるより\\(m_1-0.5 \\leq X \\leq m_2+0.5\\) の確率を求めた方が近似が良くなることが知られている。おそらく\n3 正規分布は連続変数だから、m_1,m_2では0になるってことを言ってるのかな？\\[\nP(m_1 \\leq X \\leq m_2 ) \\approx \\Phi(\\frac{m_2+0.5-np}{\\sqrt{np(1-p)}})-\\Phi(\\frac{m_1-0.5-np}{\\sqrt{np(1-p)}})\n\\]\nで近似する。これを連続補正と呼ぶ。\nサイコロを120回投げて6の目が25回以上30回以下でる正確な確率は\\(P(25 \\leq Y_{120} \\leq 30)=0.129\\) であるが、通常の正規近似では\\(0.103\\), 連続補正した正規近似では\\(0.130\\) となり連続補正した方が近似が良いことがわかる。\n\n\nコード\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom scipy import stats\n\nn = 120  # 試行回数\np = 1/6  # 確率\nx = np.arange(n + 1)\n\nbars = plt.bar(x, stats.binom.pmf(x, n, p), color='blue')\n\nfor i in range(25, 31):\n    bars[i].set_color('red')  \n\nplt.xlim(0, 35)\n\nplt.xlabel('number of successes')\nplt.ylabel('probability')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nコード\nimport math\n\np_25_30 = 0\n\nfor i in range(25, 31):\n  p_25_30 = p_25_30 + math.factorial(120)/(math.factorial(i)*math.factorial(120-i)) * ((1/6)**i)*((5/6)**(120-i))\n\nprint(p_25_30)\n\n\n0.12893057190612908\n\n\n\n\nコード\nfrom scipy import stats\n\nstats.binom.cdf(30,120,1/6)-stats.binom.cdf(24,120,1/6)\n\n\n0.12893057190612855\n\n\n\n\n\n\n\nコード\nfrom scipy.stats import norm\n\np_25_30_norm = norm.cdf(x = 30, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = 25, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm)\n\n\n0.10318274174220854\n\n\n\n\n\n\n\nコード\nfrom scipy.stats import norm\n\np_25_30_norm_hosei = norm.cdf(x = (30+1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = (25-1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm_hosei)\n\n\n0.1301159033667233"
  },
  {
    "objectID": "posts/seminor2024_1022/index.html#正確な確率",
    "href": "posts/seminor2024_1022/index.html#正確な確率",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nimport math\n\np_25_30 = 0\n\nfor i in range(25, 31):\n  p_25_30 = p_25_30 + math.factorial(120)/(math.factorial(i)*math.factorial(120-i)) * ((1/6)**i)*((5/6)**(120-i))\n\nprint(p_25_30)\n\n\n0.12893057190612908"
  },
  {
    "objectID": "posts/seminor2024_1022/index.html#通常の正規近似",
    "href": "posts/seminor2024_1022/index.html#通常の正規近似",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nfrom scipy.stats import norm\n\np_25_30_norm = norm.cdf(x = 30, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = 25, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm)\n\n\n0.10318274174220854"
  },
  {
    "objectID": "posts/seminor2024_1022/index.html#連続補正した正規近似",
    "href": "posts/seminor2024_1022/index.html#連続補正した正規近似",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nfrom scipy.stats import norm\n\np_25_30_norm_hosei = norm.cdf(x = (30+1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = (25-1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm_hosei)\n\n\n0.1301159033667233"
  },
  {
    "objectID": "posts/seminor2024_1022/index.html#正確な確率python",
    "href": "posts/seminor2024_1022/index.html#正確な確率python",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nimport math\n\np_25_30 = 0\n\nfor i in range(25, 31):\n  p_25_30 = p_25_30 + math.factorial(120)/(math.factorial(i)*math.factorial(120-i)) * ((1/6)**i)*((5/6)**(120-i))\n\nprint(p_25_30)\n\n\n0.12893057190612908\n\n\n\n\nコード\nfrom scipy import stats\n\nstats.binom.cdf(30,120,1/6)-stats.binom.cdf(24,120,1/6)\n\n\n0.12893057190612855"
  },
  {
    "objectID": "posts/seminor2024_1022/index.html#通常の正規近似python",
    "href": "posts/seminor2024_1022/index.html#通常の正規近似python",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nfrom scipy.stats import norm\n\np_25_30_norm = norm.cdf(x = 30, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = 25, loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm)\n\n\n0.10318274174220854"
  },
  {
    "objectID": "posts/seminor2024_1022/index.html#連続補正した正規近似python",
    "href": "posts/seminor2024_1022/index.html#連続補正した正規近似python",
    "title": "10月22日「データ解析のための数理統計入門」第6章 連続補正",
    "section": "",
    "text": "コード\nfrom scipy.stats import norm\n\np_25_30_norm_hosei = norm.cdf(x = (30+1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6))) - norm.cdf(x = (25-1/2), loc = 120*(1/6), scale = math.sqrt(120*(1/6)*(5/6)))\nprint(p_25_30_norm_hosei)\n\n\n0.1301159033667233"
  }
]